
<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>Deprecations and Removals — pytest documentation</title>
<link href="_static/pygments.css" rel="stylesheet" type="text/css"/>
<link href="_static/basic.css" rel="stylesheet" type="text/css"/>
<link href="_static/pygments_pytest.css" rel="stylesheet" type="text/css"/>
<script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
<script src="_static/jquery.js"></script>
<script src="_static/underscore.js"></script>
<script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
<script src="_static/doctools.js"></script>
<script src="_static/sphinx_highlight.js"></script>
<link href="_static/favicon.png" rel="shortcut icon"/>
<link href="search.html" rel="search" title="Search"/>
<link href="contributing.html" rel="next" title="Contribution getting started"/>
<link href="backwards-compatibility.html" rel="prev" title="Backwards Compatibility Policy"/>
<script>DOCUMENTATION_OPTIONS.URL_ROOT = '';</script>
</head><body>
<div aria-label="related navigation" class="related" role="navigation">
<h3>Navigation</h3>
<ul>
<li class="right" style="margin-right: 10px">
<a href="py-modindex.html" title="Python Module Index">modules</a></li>
<li class="right">
<a accesskey="N" href="contributing.html" title="Contribution getting started">next</a> |</li>
<li class="right">
<a accesskey="P" href="backwards-compatibility.html" title="Backwards Compatibility Policy">previous</a> |</li>
<li class="nav-item nav-item-0"><a href="contents.html">pytest-7.3</a> »</li>
<li class="nav-item nav-item-this"><a href="">Deprecations and Removals</a></li>
</ul>
</div>
<div class="document">
<div class="documentwrapper">
<div class="body" role="main">
<section id="deprecations-and-removals">
<a class="dashAnchor" name="//apple_ref/cpp/Section/Deprecations and Removals"></a><span id="deprecations"></span><h1>Deprecations and Removals<a class="headerlink" href="#deprecations-and-removals" title="Permalink to this heading">¶</a></h1>
<p>This page lists all pytest features that are currently deprecated or have been removed in past major releases.
The objective is to give users a clear rationale why a certain feature has been removed, and what alternatives
should be used instead.</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#deprecated-features" id="id2">Deprecated Features</a></p>
<ul>
<li><p><a class="reference internal" href="#support-for-tests-written-for-nose" id="id3">Support for tests written for nose</a></p>
<ul>
<li><p><a class="reference internal" href="#setup-teardown" id="id4">setup/teardown</a></p></li>
<li><p><a class="reference internal" href="#with-setup" id="id5">@with_setup</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#the-pytest-instance-collector" id="id6">The <code class="docutils literal notranslate"><span class="pre">pytest.Instance</span></code> collector</a></p></li>
<li><p><a class="reference internal" href="#fspath-argument-for-node-constructors-replaced-with-pathlib-path" id="id7"><code class="docutils literal notranslate"><span class="pre">fspath</span></code> argument for Node constructors replaced with <code class="docutils literal notranslate"><span class="pre">pathlib.Path</span></code></a></p></li>
<li><p><a class="reference internal" href="#configuring-hook-specs-impls-using-markers" id="id8">Configuring hook specs/impls using markers</a></p></li>
<li><p><a class="reference internal" href="#py-path-local-arguments-for-hooks-replaced-with-pathlib-path" id="id9"><code class="docutils literal notranslate"><span class="pre">py.path.local</span></code> arguments for hooks replaced with <code class="docutils literal notranslate"><span class="pre">pathlib.Path</span></code></a></p></li>
<li><p><a class="reference internal" href="#directly-constructing-internal-classes" id="id10">Directly constructing internal classes</a></p></li>
<li><p><a class="reference internal" href="#passing-msg-to-pytest-skip-pytest-fail-or-pytest-exit" id="id11">Passing <code class="docutils literal notranslate"><span class="pre">msg=</span></code> to <code class="docutils literal notranslate"><span class="pre">pytest.skip</span></code>, <code class="docutils literal notranslate"><span class="pre">pytest.fail</span></code> or <code class="docutils literal notranslate"><span class="pre">pytest.exit</span></code></a></p></li>
<li><p><a class="reference internal" href="#implementing-the-pytest-cmdline-preparse-hook" id="id12">Implementing the <code class="docutils literal notranslate"><span class="pre">pytest_cmdline_preparse</span></code> hook</a></p></li>
<li><p><a class="reference internal" href="#diamond-inheritance-between-pytest-collector-and-pytest-item" id="id13">Diamond inheritance between <a class="reference internal" href="reference/reference.html#pytest.Collector" title="pytest.Collector"><code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.Collector</span></code></a> and <a class="reference internal" href="reference/reference.html#pytest.Item" title="pytest.Item"><code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.Item</span></code></a></a></p></li>
<li><p><a class="reference internal" href="#constructors-of-custom-pytest-node-subclasses-should-take-kwargs" id="id14">Constructors of custom <code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.Node</span></code> subclasses should take <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code></a></p></li>
<li><p><a class="reference internal" href="#backward-compatibilities-in-parser-addoption" id="id15">Backward compatibilities in <code class="docutils literal notranslate"><span class="pre">Parser.addoption</span></code></a></p></li>
<li><p><a class="reference internal" href="#using-pytest-warns-none" id="id16">Using <code class="docutils literal notranslate"><span class="pre">pytest.warns(None)</span></code></a></p></li>
<li><p><a class="reference internal" href="#returning-non-none-value-in-test-functions" id="id17">Returning non-None value in test functions</a></p></li>
<li><p><a class="reference internal" href="#the-strict-command-line-option" id="id18">The <code class="docutils literal notranslate"><span class="pre">--strict</span></code> command-line option</a></p></li>
<li><p><a class="reference internal" href="#the-yield-fixture-function-decorator" id="id19">The <code class="docutils literal notranslate"><span class="pre">yield_fixture</span></code> function/decorator</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#removed-features" id="id20">Removed Features</a></p>
<ul>
<li><p><a class="reference internal" href="#the-pytest-collect-module" id="id21">The <code class="docutils literal notranslate"><span class="pre">pytest.collect</span></code> module</a></p></li>
<li><p><a class="reference internal" href="#the-pytest-warning-captured-hook" id="id22">The <code class="docutils literal notranslate"><span class="pre">pytest_warning_captured</span></code> hook</a></p></li>
<li><p><a class="reference internal" href="#the-pytest-fillfuncargs-function" id="id23">The <code class="docutils literal notranslate"><span class="pre">pytest._fillfuncargs</span></code> function</a></p></li>
<li><p><a class="reference internal" href="#no-print-logs-command-line-option" id="id24"><code class="docutils literal notranslate"><span class="pre">--no-print-logs</span></code> command-line option</a></p></li>
<li><p><a class="reference internal" href="#result-log-result-log" id="id25">Result log (<code class="docutils literal notranslate"><span class="pre">--result-log</span></code>)</a></p></li>
<li><p><a class="reference internal" href="#pytest-collect-directory-hook" id="id26"><code class="docutils literal notranslate"><span class="pre">pytest_collect_directory</span></code> hook</a></p></li>
<li><p><a class="reference internal" href="#terminalreporter-writer" id="id27">TerminalReporter.writer</a></p></li>
<li><p><a class="reference internal" href="#junit-family-default-value-change-to-xunit2" id="id28"><code class="docutils literal notranslate"><span class="pre">junit_family</span></code> default value change to “xunit2”</a></p></li>
<li><p><a class="reference internal" href="#node-construction-changed-to-node-from-parent" id="id29">Node Construction changed to <code class="docutils literal notranslate"><span class="pre">Node.from_parent</span></code></a></p></li>
<li><p><a class="reference internal" href="#pytest-fixture-arguments-are-keyword-only" id="id30"><code class="docutils literal notranslate"><span class="pre">pytest.fixture</span></code> arguments are keyword only</a></p></li>
<li><p><a class="reference internal" href="#funcargnames-alias-for-fixturenames" id="id31"><code class="docutils literal notranslate"><span class="pre">funcargnames</span></code> alias for <code class="docutils literal notranslate"><span class="pre">fixturenames</span></code></a></p></li>
<li><p><a class="reference internal" href="#pytest-config-global" id="id32"><code class="docutils literal notranslate"><span class="pre">pytest.config</span></code> global</a></p></li>
<li><p><a class="reference internal" href="#message-parameter-of-pytest-raises" id="id33"><code class="docutils literal notranslate"><span class="pre">"message"</span></code> parameter of <code class="docutils literal notranslate"><span class="pre">pytest.raises</span></code></a></p></li>
<li><p><a class="reference internal" href="#raises-warns-with-a-string-as-the-second-argument" id="id34"><code class="docutils literal notranslate"><span class="pre">raises</span></code> / <code class="docutils literal notranslate"><span class="pre">warns</span></code> with a string as the second argument</a></p></li>
<li><p><a class="reference internal" href="#using-class-in-custom-collectors" id="id35">Using <code class="docutils literal notranslate"><span class="pre">Class</span></code> in custom Collectors</a></p></li>
<li><p><a class="reference internal" href="#marks-in-pytest-mark-parametrize" id="id36">marks in <code class="docutils literal notranslate"><span class="pre">pytest.mark.parametrize</span></code></a></p></li>
<li><p><a class="reference internal" href="#pytest-funcarg-prefix" id="id37"><code class="docutils literal notranslate"><span class="pre">pytest_funcarg__</span></code> prefix</a></p></li>
<li><p><a class="reference internal" href="#pytest-section-in-setup-cfg-files" id="id38">[pytest] section in setup.cfg files</a></p></li>
<li><p><a class="reference internal" href="#metafunc-addcall" id="id39">Metafunc.addcall</a></p></li>
<li><p><a class="reference internal" href="#cached-setup" id="id40"><code class="docutils literal notranslate"><span class="pre">cached_setup</span></code></a></p></li>
<li><p><a class="reference internal" href="#pytest-plugins-in-non-top-level-conftest-files" id="id41">pytest_plugins in non-top-level conftest files</a></p></li>
<li><p><a class="reference internal" href="#config-warn-and-node-warn" id="id42"><code class="docutils literal notranslate"><span class="pre">Config.warn</span></code> and <code class="docutils literal notranslate"><span class="pre">Node.warn</span></code></a></p></li>
<li><p><a class="reference internal" href="#record-xml-property" id="id43">record_xml_property</a></p></li>
<li><p><a class="reference internal" href="#passing-command-line-string-to-pytest-main" id="id44">Passing command-line string to <code class="docutils literal notranslate"><span class="pre">pytest.main()</span></code></a></p></li>
<li><p><a class="reference internal" href="#calling-fixtures-directly" id="id45">Calling fixtures directly</a></p></li>
<li><p><a class="reference internal" href="#yield-tests" id="id46"><code class="docutils literal notranslate"><span class="pre">yield</span></code> tests</a></p></li>
<li><p><a class="reference internal" href="#internal-classes-accessed-through-node" id="id47">Internal classes accessed through <code class="docutils literal notranslate"><span class="pre">Node</span></code></a></p></li>
<li><p><a class="reference internal" href="#node-get-marker" id="id48"><code class="docutils literal notranslate"><span class="pre">Node.get_marker</span></code></a></p></li>
<li><p><a class="reference internal" href="#somefunction-markname" id="id49"><code class="docutils literal notranslate"><span class="pre">somefunction.markname</span></code></a></p></li>
<li><p><a class="reference internal" href="#pytest-namespace" id="id50"><code class="docutils literal notranslate"><span class="pre">pytest_namespace</span></code></a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="deprecated-features">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Deprecated Features</a><a class="headerlink" href="#deprecated-features" title="Permalink to this heading">¶</a></h2>
<p>Below is a complete list of all pytest features which are considered deprecated. Using those features will issue
<a class="reference internal" href="reference/reference.html#pytest.PytestWarning" title="pytest.PytestWarning"><code class="xref py py-class docutils literal notranslate"><span class="pre">PytestWarning</span></code></a> or subclasses, which can be filtered using <a class="reference internal" href="how-to/capture-warnings.html#warnings"><span class="std std-ref">standard warning filters</span></a>.</p>
<section id="support-for-tests-written-for-nose">
<a class="dashAnchor" name="//apple_ref/cpp/Section/Support for tests written for nose"></a><span id="nose-deprecation"></span><h3><a class="toc-backref" href="#id3" role="doc-backlink">Support for tests written for nose</a><a class="headerlink" href="#support-for-tests-written-for-nose" title="Permalink to this heading">¶</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 7.2.</span></p>
</div>
<p>Support for running tests written for <a class="reference external" href="https://nose.readthedocs.io/en/latest/">nose</a> is now deprecated.</p>
<p><code class="docutils literal notranslate"><span class="pre">nose</span></code> has been in maintenance mode-only for years, and maintaining the plugin is not trivial as it spills
over the code base (see <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9886">issue #9886</a> for more details).</p>
<section id="setup-teardown">
<h4><a class="toc-backref" href="#id4" role="doc-backlink">setup/teardown</a><a class="headerlink" href="#setup-teardown" title="Permalink to this heading">¶</a></h4>
<p>One thing that might catch users by surprise is that plain <code class="docutils literal notranslate"><span class="pre">setup</span></code> and <code class="docutils literal notranslate"><span class="pre">teardown</span></code> methods are not pytest native,
they are in fact part of the <code class="docutils literal notranslate"><span class="pre">nose</span></code> support.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Test</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resource</span> <span class="o">=</span> <span class="n">make_resource</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">teardown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">test_foo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">test_bar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>Native pytest support uses <code class="docutils literal notranslate"><span class="pre">setup_method</span></code> and <code class="docutils literal notranslate"><span class="pre">teardown_method</span></code> (see <a class="reference internal" href="how-to/xunit_setup.html#xunit-method-setup"><span class="std std-ref">Method and function level setup/teardown</span></a>), so the above should be changed to:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Test</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">setup_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resource</span> <span class="o">=</span> <span class="n">make_resource</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">teardown_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">test_foo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">test_bar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>This is easy to do in an entire code base by doing a simple find/replace.</p>
</section>
<section id="with-setup">
<h4><a class="toc-backref" href="#id5" role="doc-backlink">@with_setup</a><a class="headerlink" href="#with-setup" title="Permalink to this heading">¶</a></h4>
<p>Code using <a class="reference external" href="with-setup-nose">@with_setup</a> such as this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nose.tools</span> <span class="kn">import</span> <span class="n">with_setup</span>


<span class="k">def</span> <span class="nf">setup_some_resource</span><span class="p">():</span>
    <span class="o">...</span>


<span class="k">def</span> <span class="nf">teardown_some_resource</span><span class="p">():</span>
    <span class="o">...</span>


<span class="nd">@with_setup</span><span class="p">(</span><span class="n">setup_some_resource</span><span class="p">,</span> <span class="n">teardown_some_resource</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_foo</span><span class="p">():</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>Will also need to be ported to a supported pytest style. One way to do it is using a fixture:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pytest</span>


<span class="k">def</span> <span class="nf">setup_some_resource</span><span class="p">():</span>
    <span class="o">...</span>


<span class="k">def</span> <span class="nf">teardown_some_resource</span><span class="p">():</span>
    <span class="o">...</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span> <span class="nf">some_resource</span><span class="p">():</span>
    <span class="n">setup_some_resource</span><span class="p">()</span>
    <span class="k">yield</span>
    <span class="n">teardown_some_resource</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">test_foo</span><span class="p">(</span><span class="n">some_resource</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
</section>
</section>
<section id="the-pytest-instance-collector">
<a class="dashAnchor" name="//apple_ref/cpp/Section/The pytest.Instance collector"></a><span id="instance-collector-deprecation"></span><h3><a class="toc-backref" href="#id6" role="doc-backlink">The <code class="docutils literal notranslate"><span class="pre">pytest.Instance</span></code> collector</a><a class="headerlink" href="#the-pytest-instance-collector" title="Permalink to this heading">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 7.0.</span></p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">pytest.Instance</span></code> collector type has been removed.</p>
<p>Previously, Python test methods were collected as <a class="reference internal" href="reference/reference.html#pytest.Class" title="pytest.Class"><code class="xref py py-class docutils literal notranslate"><span class="pre">Class</span></code></a> -&gt; <code class="docutils literal notranslate"><span class="pre">Instance</span></code> -&gt; <a class="reference internal" href="reference/reference.html#pytest.Function" title="pytest.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a>.
Now <a class="reference internal" href="reference/reference.html#pytest.Class" title="pytest.Class"><code class="xref py py-class docutils literal notranslate"><span class="pre">Class</span></code></a> collects the test methods directly.</p>
<p>Most plugins which reference <code class="docutils literal notranslate"><span class="pre">Instance</span></code> do so in order to ignore or skip it,
using a check such as <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">isinstance(node,</span> <span class="pre">Instance):</span> <span class="pre">return</span></code>.
Such plugins should simply remove consideration of <code class="docutils literal notranslate"><span class="pre">Instance</span></code> on pytest&gt;=7.
However, to keep such uses working, a dummy type has been instanted in <code class="docutils literal notranslate"><span class="pre">pytest.Instance</span></code> and <code class="docutils literal notranslate"><span class="pre">_pytest.python.Instance</span></code>,
and importing it emits a deprecation warning. This will be removed in pytest 8.</p>
</section>
<section id="fspath-argument-for-node-constructors-replaced-with-pathlib-path">
<a class="dashAnchor" name="//apple_ref/cpp/Section/fspath argument for Node constructors replaced with pathlib.Path"></a><span id="node-ctor-fspath-deprecation"></span><h3><a class="toc-backref" href="#id7" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">fspath</span></code> argument for Node constructors replaced with <code class="docutils literal notranslate"><span class="pre">pathlib.Path</span></code></a><a class="headerlink" href="#fspath-argument-for-node-constructors-replaced-with-pathlib-path" title="Permalink to this heading">¶</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 7.0.</span></p>
</div>
<p>In order to support the transition from <code class="docutils literal notranslate"><span class="pre">py.path.local</span></code> to <a class="reference external" href="https://docs.python.org/3/library/pathlib.html#module-pathlib" title="(in Python v3.11)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pathlib</span></code></a>,
the <code class="docutils literal notranslate"><span class="pre">fspath</span></code> argument to <a class="reference internal" href="reference/reference.html#pytest.nodes.Node" title="_pytest.nodes.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> constructors like
<a class="reference internal" href="reference/reference.html#pytest.Function.from_parent" title="pytest.Function.from_parent"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.Function.from_parent()</span></code></a> and <a class="reference internal" href="reference/reference.html#pytest.Class.from_parent" title="pytest.Class.from_parent"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.Class.from_parent()</span></code></a>
is now deprecated.</p>
<p>Plugins which construct nodes should pass the <code class="docutils literal notranslate"><span class="pre">path</span></code> argument, of type
<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pathlib.Path</span></code></a>, instead of the <code class="docutils literal notranslate"><span class="pre">fspath</span></code> argument.</p>
<p>Plugins which implement custom items and collectors are encouraged to replace
<code class="docutils literal notranslate"><span class="pre">fspath</span></code> parameters (<code class="docutils literal notranslate"><span class="pre">py.path.local</span></code>) with <code class="docutils literal notranslate"><span class="pre">path</span></code> parameters
(<code class="docutils literal notranslate"><span class="pre">pathlib.Path</span></code>), and drop any other usage of the <code class="docutils literal notranslate"><span class="pre">py</span></code> library if possible.</p>
<p>If possible, plugins with custom items should use <a class="reference internal" href="#uncooperative-constructors-deprecated"><span class="std std-ref">cooperative
constructors</span></a> to avoid hardcoding
arguments they only pass on to the superclass.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The name of the <a class="reference internal" href="reference/reference.html#pytest.nodes.Node" title="_pytest.nodes.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> arguments and attributes (the
new attribute being <code class="docutils literal notranslate"><span class="pre">path</span></code>) is <strong>the opposite</strong> of the situation for
hooks, <a class="reference internal" href="#legacy-path-hooks-deprecated"><span class="std std-ref">outlined below</span></a> (the old
argument being <code class="docutils literal notranslate"><span class="pre">path</span></code>).</p>
<p>This is an unfortunate artifact due to historical reasons, which should be
resolved in future versions as we slowly get rid of the <a class="reference external" href="https://pypi.org/project/py/">py</a>
dependency (see <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9283">issue #9283</a> for a longer discussion).</p>
</div>
<p>Due to the ongoing migration of methods like <code class="xref py py-meth docutils literal notranslate"><span class="pre">reportinfo()</span></code>
which still is expected to return a <code class="docutils literal notranslate"><span class="pre">py.path.local</span></code> object, nodes still have
both <code class="docutils literal notranslate"><span class="pre">fspath</span></code> (<code class="docutils literal notranslate"><span class="pre">py.path.local</span></code>) and <code class="docutils literal notranslate"><span class="pre">path</span></code> (<code class="docutils literal notranslate"><span class="pre">pathlib.Path</span></code>) attributes,
no matter what argument was used in the constructor. We expect to deprecate the
<code class="docutils literal notranslate"><span class="pre">fspath</span></code> attribute in a future release.</p>
</section>
<section id="configuring-hook-specs-impls-using-markers">
<a class="dashAnchor" name="//apple_ref/cpp/Section/Configuring hook specs/impls using markers"></a><span id="legacy-path-hooks-deprecated"></span><h3><a class="toc-backref" href="#id8" role="doc-backlink">Configuring hook specs/impls using markers</a><a class="headerlink" href="#configuring-hook-specs-impls-using-markers" title="Permalink to this heading">¶</a></h3>
<p>Before pluggy, pytest’s plugin library, was its own package and had a clear API,
pytest just used <code class="docutils literal notranslate"><span class="pre">pytest.mark</span></code> to configure hooks.</p>
<p>The <code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.hookimpl()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.hookspec()</span></code> decorators
have been available since years and should be used instead.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">tryfirst</span>
<span class="k">def</span> <span class="nf">pytest_runtest_call</span><span class="p">():</span>
    <span class="o">...</span>


<span class="c1"># or</span>
<span class="k">def</span> <span class="nf">pytest_runtest_call</span><span class="p">():</span>
    <span class="o">...</span>


<span class="n">pytest_runtest_call</span><span class="o">.</span><span class="n">tryfirst</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<p>should be changed to:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">hookimpl</span><span class="p">(</span><span class="n">tryfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">pytest_runtest_call</span><span class="p">():</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>Changed <code class="docutils literal notranslate"><span class="pre">hookimpl</span></code> attributes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tryfirst</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trylast</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">optionalhook</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hookwrapper</span></code></p></li>
</ul>
<p>Changed <code class="docutils literal notranslate"><span class="pre">hookwrapper</span></code> attributes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">firstresult</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">historic</span></code></p></li>
</ul>
</section>
<section id="py-path-local-arguments-for-hooks-replaced-with-pathlib-path">
<h3><a class="toc-backref" href="#id9" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">py.path.local</span></code> arguments for hooks replaced with <code class="docutils literal notranslate"><span class="pre">pathlib.Path</span></code></a><a class="headerlink" href="#py-path-local-arguments-for-hooks-replaced-with-pathlib-path" title="Permalink to this heading">¶</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 7.0.</span></p>
</div>
<p>In order to support the transition from <code class="docutils literal notranslate"><span class="pre">py.path.local</span></code> to <a class="reference external" href="https://docs.python.org/3/library/pathlib.html#module-pathlib" title="(in Python v3.11)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pathlib</span></code></a>, the following hooks now receive additional arguments:</p>
<ul class="simple">
<li><p><a class="reference internal" href="reference/reference.html#std-hook-pytest_ignore_collect"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_ignore_collect(collection_path:</span> <span class="pre">pathlib.Path)</span></code></a> as equivalent to <code class="docutils literal notranslate"><span class="pre">path</span></code></p></li>
<li><p><a class="reference internal" href="reference/reference.html#std-hook-pytest_collect_file"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_collect_file(file_path:</span> <span class="pre">pathlib.Path)</span></code></a> as equivalent to <code class="docutils literal notranslate"><span class="pre">path</span></code></p></li>
<li><p><a class="reference internal" href="reference/reference.html#std-hook-pytest_pycollect_makemodule"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_pycollect_makemodule(module_path:</span> <span class="pre">pathlib.Path)</span></code></a> as equivalent to <code class="docutils literal notranslate"><span class="pre">path</span></code></p></li>
<li><p><a class="reference internal" href="reference/reference.html#std-hook-pytest_report_header"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_report_header(start_path:</span> <span class="pre">pathlib.Path)</span></code></a> as equivalent to <code class="docutils literal notranslate"><span class="pre">startdir</span></code></p></li>
<li><p><a class="reference internal" href="reference/reference.html#std-hook-pytest_report_collectionfinish"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_report_collectionfinish(start_path:</span> <span class="pre">pathlib.Path)</span></code></a> as equivalent to <code class="docutils literal notranslate"><span class="pre">startdir</span></code></p></li>
</ul>
<p>The accompanying <code class="docutils literal notranslate"><span class="pre">py.path.local</span></code> based paths have been deprecated: plugins which manually invoke those hooks should only pass the new <code class="docutils literal notranslate"><span class="pre">pathlib.Path</span></code> arguments, and users should change their hook implementations to use the new <code class="docutils literal notranslate"><span class="pre">pathlib.Path</span></code> arguments.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The name of the <a class="reference internal" href="reference/reference.html#pytest.nodes.Node" title="_pytest.nodes.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> arguments and attributes,
<a class="reference internal" href="#node-ctor-fspath-deprecation"><span class="std std-ref">outlined above</span></a> (the new attribute
being <code class="docutils literal notranslate"><span class="pre">path</span></code>) is <strong>the opposite</strong> of the situation for hooks (the old
argument being <code class="docutils literal notranslate"><span class="pre">path</span></code>).</p>
<p>This is an unfortunate artifact due to historical reasons, which should be
resolved in future versions as we slowly get rid of the <a class="reference external" href="https://pypi.org/project/py/">py</a>
dependency (see <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/9283">issue #9283</a> for a longer discussion).</p>
</div>
</section>
<section id="directly-constructing-internal-classes">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">Directly constructing internal classes</a><a class="headerlink" href="#directly-constructing-internal-classes" title="Permalink to this heading">¶</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 7.0.</span></p>
</div>
<p>Directly constructing the following classes is now deprecated:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.mark.structures.Mark</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.mark.structures.MarkDecorator</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.mark.structures.MarkGenerator</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.python.Metafunc</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.runner.CallInfo</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest._code.ExceptionInfo</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.config.argparsing.Parser</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.config.argparsing.OptionGroup</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pytest.pytester.HookRecorder</span></code></p></li>
</ul>
<p>These constructors have always been considered private, but now issue a deprecation warning, which may become a hard error in pytest 8.</p>
</section>
<section id="passing-msg-to-pytest-skip-pytest-fail-or-pytest-exit">
<a class="dashAnchor" name="//apple_ref/cpp/Section/Passing msg= to pytest.skip, pytest.fail or pytest.exit"></a><span id="cmdline-preparse-deprecated"></span><h3><a class="toc-backref" href="#id11" role="doc-backlink">Passing <code class="docutils literal notranslate"><span class="pre">msg=</span></code> to <code class="docutils literal notranslate"><span class="pre">pytest.skip</span></code>, <code class="docutils literal notranslate"><span class="pre">pytest.fail</span></code> or <code class="docutils literal notranslate"><span class="pre">pytest.exit</span></code></a><a class="headerlink" href="#passing-msg-to-pytest-skip-pytest-fail-or-pytest-exit" title="Permalink to this heading">¶</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 7.0.</span></p>
</div>
<p>Passing the keyword argument <code class="docutils literal notranslate"><span class="pre">msg</span></code> to <a class="reference internal" href="reference/reference.html#pytest.skip" title="pytest.skip"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.skip()</span></code></a>, <a class="reference internal" href="reference/reference.html#pytest.fail" title="pytest.fail"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.fail()</span></code></a> or <a class="reference internal" href="reference/reference.html#pytest.exit" title="pytest.exit"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.exit()</span></code></a>
is now deprecated and <code class="docutils literal notranslate"><span class="pre">reason</span></code> should be used instead.  This change is to bring consistency between these
functions and the <code class="docutils literal notranslate"><span class="pre">@pytest.mark.skip</span></code> and <code class="docutils literal notranslate"><span class="pre">@pytest.mark.xfail</span></code> markers which already accept a <code class="docutils literal notranslate"><span class="pre">reason</span></code> argument.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_fail_example</span><span class="p">():</span>
    <span class="c1"># old</span>
    <span class="n">pytest</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s2">"foo"</span><span class="p">)</span>
    <span class="c1"># new</span>
    <span class="n">pytest</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="s2">"bar"</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">test_skip_example</span><span class="p">():</span>
    <span class="c1"># old</span>
    <span class="n">pytest</span><span class="o">.</span><span class="n">skip</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s2">"foo"</span><span class="p">)</span>
    <span class="c1"># new</span>
    <span class="n">pytest</span><span class="o">.</span><span class="n">skip</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="s2">"bar"</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">test_exit_example</span><span class="p">():</span>
    <span class="c1"># old</span>
    <span class="n">pytest</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s2">"foo"</span><span class="p">)</span>
    <span class="c1"># new</span>
    <span class="n">pytest</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="s2">"bar"</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="implementing-the-pytest-cmdline-preparse-hook">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">Implementing the <code class="docutils literal notranslate"><span class="pre">pytest_cmdline_preparse</span></code> hook</a><a class="headerlink" href="#implementing-the-pytest-cmdline-preparse-hook" title="Permalink to this heading">¶</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 7.0.</span></p>
</div>
<p>Implementing the <a class="reference internal" href="reference/reference.html#std-hook-pytest_cmdline_preparse"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_cmdline_preparse</span></code></a> hook has been officially deprecated.
Implement the <a class="reference internal" href="reference/reference.html#std-hook-pytest_load_initial_conftests"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_load_initial_conftests</span></code></a> hook instead.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pytest_cmdline_preparse</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">Config</span><span class="p">,</span> <span class="n">args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="o">...</span>


<span class="c1"># becomes:</span>


<span class="k">def</span> <span class="nf">pytest_load_initial_conftests</span><span class="p">(</span>
    <span class="n">early_config</span><span class="p">:</span> <span class="n">Config</span><span class="p">,</span> <span class="n">parser</span><span class="p">:</span> <span class="n">Parser</span><span class="p">,</span> <span class="n">args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="o">...</span>
</pre></div>
</div>
</section>
<section id="diamond-inheritance-between-pytest-collector-and-pytest-item">
<a class="dashAnchor" name="//apple_ref/cpp/Section/Diamond inheritance between pytest.Collector and pytest.Item"></a><span id="diamond-inheritance-deprecated"></span><h3><a class="toc-backref" href="#id13" role="doc-backlink">Diamond inheritance between <a class="reference internal" href="reference/reference.html#pytest.Collector" title="pytest.Collector"><code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.Collector</span></code></a> and <a class="reference internal" href="reference/reference.html#pytest.Item" title="pytest.Item"><code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.Item</span></code></a></a><a class="headerlink" href="#diamond-inheritance-between-pytest-collector-and-pytest-item" title="Permalink to this heading">¶</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 7.0.</span></p>
</div>
<p>Defining a custom pytest node type which is both an <code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.Item</span></code> and a <code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.Collector</span></code> (e.g. <code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.File</span></code>) now issues a warning.
It was never sanely supported and triggers hard to debug errors.</p>
<p>Some plugins providing linting/code analysis have been using this as a hack.
Instead, a separate collector node should be used, which collects the item. See
<a class="reference internal" href="example/nonpython.html#non-python-tests"><span class="std std-ref">Working with non-python tests</span></a> for an example, as well as an <a class="reference external" href="https://github.com/asmeurer/pytest-flakes/pull/40/files">example pr fixing inheritance</a>.</p>
</section>
<section id="constructors-of-custom-pytest-node-subclasses-should-take-kwargs">
<a class="dashAnchor" name="//apple_ref/cpp/Section/Constructors of custom pytest.Node subclasses should take **kwargs"></a><span id="uncooperative-constructors-deprecated"></span><h3><a class="toc-backref" href="#id14" role="doc-backlink">Constructors of custom <code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.Node</span></code> subclasses should take <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code></a><a class="headerlink" href="#constructors-of-custom-pytest-node-subclasses-should-take-kwargs" title="Permalink to this heading">¶</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 7.0.</span></p>
</div>
<p>If custom subclasses of nodes like <a class="reference internal" href="reference/reference.html#pytest.Item" title="pytest.Item"><code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.Item</span></code></a> override the
<code class="docutils literal notranslate"><span class="pre">__init__</span></code> method, they should take <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>. Thus,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CustomItem</span><span class="p">(</span><span class="n">pytest</span><span class="o">.</span><span class="n">Item</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">additional_arg</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">additional_arg</span> <span class="o">=</span> <span class="n">additional_arg</span>
</pre></div>
</div>
<p>should be turned into:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CustomItem</span><span class="p">(</span><span class="n">pytest</span><span class="o">.</span><span class="n">Item</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">additional_arg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">additional_arg</span> <span class="o">=</span> <span class="n">additional_arg</span>
</pre></div>
</div>
<p>to avoid hard-coding the arguments pytest can pass to the superclass.
See <a class="reference internal" href="example/nonpython.html#non-python-tests"><span class="std std-ref">Working with non-python tests</span></a> for a full example.</p>
<p>For cases without conflicts, no deprecation warning is emitted. For cases with
conflicts (such as <a class="reference internal" href="reference/reference.html#pytest.File" title="pytest.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.File</span></code></a> now taking <code class="docutils literal notranslate"><span class="pre">path</span></code> instead of
<code class="docutils literal notranslate"><span class="pre">fspath</span></code>, as <a class="reference internal" href="#node-ctor-fspath-deprecation"><span class="std std-ref">outlined above</span></a>), a
deprecation warning is now raised.</p>
</section>
<section id="backward-compatibilities-in-parser-addoption">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">Backward compatibilities in <code class="docutils literal notranslate"><span class="pre">Parser.addoption</span></code></a><a class="headerlink" href="#backward-compatibilities-in-parser-addoption" title="Permalink to this heading">¶</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 2.4.</span></p>
</div>
<p>Several behaviors of <a class="reference internal" href="reference/reference.html#pytest.Parser.addoption" title="pytest.Parser.addoption"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Parser.addoption</span></code></a> are now
scheduled for removal in pytest 8 (deprecated since pytest 2.4.0):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">parser.addoption(...,</span> <span class="pre">help="..</span> <span class="pre">%default</span> <span class="pre">..")</span></code> - use <code class="docutils literal notranslate"><span class="pre">%(default)s</span></code> instead.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parser.addoption(...,</span> <span class="pre">type="int/string/float/complex")</span></code> - use <code class="docutils literal notranslate"><span class="pre">type=int</span></code> etc. instead.</p></li>
</ul>
</section>
<section id="using-pytest-warns-none">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">Using <code class="docutils literal notranslate"><span class="pre">pytest.warns(None)</span></code></a><a class="headerlink" href="#using-pytest-warns-none" title="Permalink to this heading">¶</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 7.0.</span></p>
</div>
<p><a class="reference internal" href="reference/reference.html#pytest.warns" title="pytest.warns"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.warns(None)</span></code></a> is now deprecated because it was frequently misused.
Its correct usage was checking that the code emits at least one warning of any type - like <code class="docutils literal notranslate"><span class="pre">pytest.warns()</span></code>
or <code class="docutils literal notranslate"><span class="pre">pytest.warns(Warning)</span></code>.</p>
<p>See <a class="reference internal" href="how-to/capture-warnings.html#warns-use-cases"><span class="std std-ref">Additional use cases of warnings in tests</span></a> for examples.</p>
</section>
<section id="returning-non-none-value-in-test-functions">
<h3><a class="toc-backref" href="#id17" role="doc-backlink">Returning non-None value in test functions</a><a class="headerlink" href="#returning-non-none-value-in-test-functions" title="Permalink to this heading">¶</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 7.2.</span></p>
</div>
<p>A <a class="reference internal" href="reference/reference.html#pytest.PytestReturnNotNoneWarning" title="pytest.PytestReturnNotNoneWarning"><code class="xref py py-class docutils literal notranslate"><span class="pre">pytest.PytestReturnNotNoneWarning</span></code></a> is now emitted if a test function returns something other than <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>This prevents a common mistake among beginners that expect that returning a <code class="docutils literal notranslate"><span class="pre">bool</span></code> would cause a test to pass or fail, for example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span>
    <span class="p">[</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">,</span> <span class="s2">"result"</span><span class="p">],</span>
    <span class="p">[</span>
        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">18</span><span class="p">],</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">test_foo</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">foo</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">==</span> <span class="n">result</span>
</pre></div>
</div>
<p>Given that pytest ignores the return value, this might be surprising that it will never fail.</p>
<p>The proper fix is to change the <code class="docutils literal notranslate"><span class="pre">return</span></code> to an <code class="docutils literal notranslate"><span class="pre">assert</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span>
    <span class="p">[</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">,</span> <span class="s2">"result"</span><span class="p">],</span>
    <span class="p">[</span>
        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">18</span><span class="p">],</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">test_foo</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">foo</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">==</span> <span class="n">result</span>
</pre></div>
</div>
</section>
<section id="the-strict-command-line-option">
<h3><a class="toc-backref" href="#id18" role="doc-backlink">The <code class="docutils literal notranslate"><span class="pre">--strict</span></code> command-line option</a><a class="headerlink" href="#the-strict-command-line-option" title="Permalink to this heading">¶</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 6.2.</span></p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">--strict</span></code> command-line option has been deprecated in favor of <code class="docutils literal notranslate"><span class="pre">--strict-markers</span></code>, which
better conveys what the option does.</p>
<p>We have plans to maybe in the future to reintroduce <code class="docutils literal notranslate"><span class="pre">--strict</span></code> and make it an encompassing
flag for all strictness related options (<code class="docutils literal notranslate"><span class="pre">--strict-markers</span></code> and <code class="docutils literal notranslate"><span class="pre">--strict-config</span></code>
at the moment, more might be introduced in the future).</p>
</section>
<section id="the-yield-fixture-function-decorator">
<h3><a class="toc-backref" href="#id19" role="doc-backlink">The <code class="docutils literal notranslate"><span class="pre">yield_fixture</span></code> function/decorator</a><a class="headerlink" href="#the-yield-fixture-function-decorator" title="Permalink to this heading">¶</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 6.2.</span></p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pytest.yield_fixture</span></code> is a deprecated alias for <a class="reference internal" href="reference/reference.html#pytest.fixture" title="pytest.fixture"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.fixture()</span></code></a>.</p>
<p>It has been so for a very long time, so can be search/replaced safely.</p>
</section>
</section>
<section id="removed-features">
<h2><a class="toc-backref" href="#id20" role="doc-backlink">Removed Features</a><a class="headerlink" href="#removed-features" title="Permalink to this heading">¶</a></h2>
<p>As stated in our <a class="reference internal" href="backwards-compatibility.html#backwards-compatibility"><span class="std std-ref">Backwards Compatibility Policy</span></a> policy, deprecated features are removed only in major releases after
an appropriate period of deprecation has passed.</p>
<section id="the-pytest-collect-module">
<h3><a class="toc-backref" href="#id21" role="doc-backlink">The <code class="docutils literal notranslate"><span class="pre">pytest.collect</span></code> module</a><a class="headerlink" href="#the-pytest-collect-module" title="Permalink to this heading">¶</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 6.0.</span></p>
</div>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 7.0.</span></p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">pytest.collect</span></code> module is no longer part of the public API, all its names
should now be imported from <code class="docutils literal notranslate"><span class="pre">pytest</span></code> directly instead.</p>
</section>
<section id="the-pytest-warning-captured-hook">
<h3><a class="toc-backref" href="#id22" role="doc-backlink">The <code class="docutils literal notranslate"><span class="pre">pytest_warning_captured</span></code> hook</a><a class="headerlink" href="#the-pytest-warning-captured-hook" title="Permalink to this heading">¶</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 6.0.</span></p>
</div>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 7.0.</span></p>
</div>
<p>This hook has an <code class="docutils literal notranslate"><span class="pre">item</span></code> parameter which cannot be serialized by <code class="docutils literal notranslate"><span class="pre">pytest-xdist</span></code>.</p>
<p>Use the <code class="docutils literal notranslate"><span class="pre">pytest_warning_recorded</span></code> hook instead, which replaces the <code class="docutils literal notranslate"><span class="pre">item</span></code> parameter
by a <code class="docutils literal notranslate"><span class="pre">nodeid</span></code> parameter.</p>
</section>
<section id="the-pytest-fillfuncargs-function">
<h3><a class="toc-backref" href="#id23" role="doc-backlink">The <code class="docutils literal notranslate"><span class="pre">pytest._fillfuncargs</span></code> function</a><a class="headerlink" href="#the-pytest-fillfuncargs-function" title="Permalink to this heading">¶</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 6.0.</span></p>
</div>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 7.0.</span></p>
</div>
<p>This function was kept for backward compatibility with an older plugin.</p>
<p>It’s functionality is not meant to be used directly, but if you must replace
it, use <code class="docutils literal notranslate"><span class="pre">function._request._fillfixtures()</span></code> instead, though note this is not
a public API and may break in the future.</p>
</section>
<section id="no-print-logs-command-line-option">
<h3><a class="toc-backref" href="#id24" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">--no-print-logs</span></code> command-line option</a><a class="headerlink" href="#no-print-logs-command-line-option" title="Permalink to this heading">¶</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 5.4.</span></p>
</div>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 6.0.</span></p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">--no-print-logs</span></code> option and <code class="docutils literal notranslate"><span class="pre">log_print</span></code> ini setting are removed. If
you used them, please use <code class="docutils literal notranslate"><span class="pre">--show-capture</span></code> instead.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">--show-capture</span></code> command-line option was added in <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">3.5.0</span></code> which allows to specify how to
display captured output when tests fail: <code class="docutils literal notranslate"><span class="pre">no</span></code>, <code class="docutils literal notranslate"><span class="pre">stdout</span></code>, <code class="docutils literal notranslate"><span class="pre">stderr</span></code>, <code class="docutils literal notranslate"><span class="pre">log</span></code> or <code class="docutils literal notranslate"><span class="pre">all</span></code> (the default).</p>
</section>
<section id="result-log-result-log">
<a class="dashAnchor" name="//apple_ref/cpp/Section/Result log (--result-log)"></a><span id="resultlog-deprecated"></span><h3><a class="toc-backref" href="#id25" role="doc-backlink">Result log (<code class="docutils literal notranslate"><span class="pre">--result-log</span></code>)</a><a class="headerlink" href="#result-log-result-log" title="Permalink to this heading">¶</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 4.0.</span></p>
</div>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 6.0.</span></p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">--result-log</span></code> option produces a stream of test reports which can be
analysed at runtime, but it uses a custom format which requires users to implement their own
parser.</p>
<p>The  <a class="reference external" href="https://github.com/pytest-dev/pytest-reportlog">pytest-reportlog</a> plugin provides a <code class="docutils literal notranslate"><span class="pre">--report-log</span></code> option, a more standard and extensible alternative, producing
one JSON object per-line, and should cover the same use cases. Please try it out and provide feedback.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">pytest-reportlog</span></code> plugin might even be merged into the core
at some point, depending on the plans for the plugins and number of users using it.</p>
</section>
<section id="pytest-collect-directory-hook">
<h3><a class="toc-backref" href="#id26" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">pytest_collect_directory</span></code> hook</a><a class="headerlink" href="#pytest-collect-directory-hook" title="Permalink to this heading">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 6.0.</span></p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">pytest_collect_directory</span></code> hook has not worked properly for years (it was called
but the results were ignored). Users may consider using <a class="reference internal" href="reference/reference.html#std-hook-pytest_collection_modifyitems"><code class="xref std std-hook docutils literal notranslate"><span class="pre">pytest_collection_modifyitems</span></code></a> instead.</p>
</section>
<section id="terminalreporter-writer">
<h3><a class="toc-backref" href="#id27" role="doc-backlink">TerminalReporter.writer</a><a class="headerlink" href="#terminalreporter-writer" title="Permalink to this heading">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 6.0.</span></p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">TerminalReporter.writer</span></code> attribute has been deprecated and should no longer be used. This
was inadvertently exposed as part of the public API of that plugin and ties it too much
with <code class="docutils literal notranslate"><span class="pre">py.io.TerminalWriter</span></code>.</p>
<p>Plugins that used <code class="docutils literal notranslate"><span class="pre">TerminalReporter.writer</span></code> directly should instead use <code class="docutils literal notranslate"><span class="pre">TerminalReporter</span></code>
methods that provide the same functionality.</p>
</section>
<section id="junit-family-default-value-change-to-xunit2">
<a class="dashAnchor" name="//apple_ref/cpp/Section/junit_family default value change to “xunit2”"></a><span id="junit-family-changed-default-value"></span><h3><a class="toc-backref" href="#id28" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">junit_family</span></code> default value change to “xunit2”</a><a class="headerlink" href="#junit-family-default-value-change-to-xunit2" title="Permalink to this heading">¶</a></h3>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 6.0.</span></p>
</div>
<p>The default value of <code class="docutils literal notranslate"><span class="pre">junit_family</span></code> option will change to <code class="docutils literal notranslate"><span class="pre">xunit2</span></code> in pytest 6.0, which
is an update of the old <code class="docutils literal notranslate"><span class="pre">xunit1</span></code> format and is supported by default in modern tools
that manipulate this type of file (for example, Jenkins, Azure Pipelines, etc.).</p>
<p>Users are recommended to try the new <code class="docutils literal notranslate"><span class="pre">xunit2</span></code> format and see if their tooling that consumes the JUnit
XML file supports it.</p>
<p>To use the new format, update your <code class="docutils literal notranslate"><span class="pre">pytest.ini</span></code>:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[pytest]</span>
<span class="na">junit_family</span><span class="o">=</span><span class="s">xunit2</span>
</pre></div>
</div>
<p>If you discover that your tooling does not support the new format, and want to keep using the
legacy version, set the option to <code class="docutils literal notranslate"><span class="pre">legacy</span></code> instead:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[pytest]</span>
<span class="na">junit_family</span><span class="o">=</span><span class="s">legacy</span>
</pre></div>
</div>
<p>By using <code class="docutils literal notranslate"><span class="pre">legacy</span></code> you will keep using the legacy/xunit1 format when upgrading to
pytest 6.0, where the default format will be <code class="docutils literal notranslate"><span class="pre">xunit2</span></code>.</p>
<p>In order to let users know about the transition, pytest will issue a warning in case
the <code class="docutils literal notranslate"><span class="pre">--junitxml</span></code> option is given in the command line but <code class="docutils literal notranslate"><span class="pre">junit_family</span></code> is not explicitly
configured in <code class="docutils literal notranslate"><span class="pre">pytest.ini</span></code>.</p>
<p>Services known to support the <code class="docutils literal notranslate"><span class="pre">xunit2</span></code> format:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.jenkins.io/">Jenkins</a> with the <a class="reference external" href="https://plugins.jenkins.io/junit">JUnit</a> plugin.</p></li>
<li><p><a class="reference external" href="https://azure.microsoft.com/en-us/services/devops/pipelines">Azure Pipelines</a>.</p></li>
</ul>
</section>
<section id="node-construction-changed-to-node-from-parent">
<h3><a class="toc-backref" href="#id29" role="doc-backlink">Node Construction changed to <code class="docutils literal notranslate"><span class="pre">Node.from_parent</span></code></a><a class="headerlink" href="#node-construction-changed-to-node-from-parent" title="Permalink to this heading">¶</a></h3>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 6.0.</span></p>
</div>
<p>The construction of nodes now should use the named constructor <code class="docutils literal notranslate"><span class="pre">from_parent</span></code>.
This limitation in api surface intends to enable better/simpler refactoring of the collection tree.</p>
<p>This means that instead of <code class="code docutils literal notranslate"><span class="pre">MyItem(name="foo",</span> <span class="pre">parent=collector,</span> <span class="pre">obj=42)</span></code>
one now has to invoke <code class="code docutils literal notranslate"><span class="pre">MyItem.from_parent(collector,</span> <span class="pre">name="foo")</span></code>.</p>
<p>Plugins that wish to support older versions of pytest and suppress the warning can use
<code class="docutils literal notranslate"><span class="pre">hasattr</span></code> to check if <code class="docutils literal notranslate"><span class="pre">from_parent</span></code> exists in that version:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pytest_pycollect_makeitem</span><span class="p">(</span><span class="n">collector</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">MyItem</span><span class="p">,</span> <span class="s2">"from_parent"</span><span class="p">):</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">MyItem</span><span class="o">.</span><span class="n">from_parent</span><span class="p">(</span><span class="n">collector</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">"foo"</span><span class="p">)</span>
        <span class="n">item</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="mi">42</span>
        <span class="k">return</span> <span class="n">item</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">MyItem</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"foo"</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">collector</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">from_parent</span></code> should only be called with keyword arguments for the parameters.</p>
</section>
<section id="pytest-fixture-arguments-are-keyword-only">
<h3><a class="toc-backref" href="#id30" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">pytest.fixture</span></code> arguments are keyword only</a><a class="headerlink" href="#pytest-fixture-arguments-are-keyword-only" title="Permalink to this heading">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 6.0.</span></p>
</div>
<p>Passing arguments to pytest.fixture() as positional arguments has been removed - pass them by keyword instead.</p>
</section>
<section id="funcargnames-alias-for-fixturenames">
<h3><a class="toc-backref" href="#id31" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">funcargnames</span></code> alias for <code class="docutils literal notranslate"><span class="pre">fixturenames</span></code></a><a class="headerlink" href="#funcargnames-alias-for-fixturenames" title="Permalink to this heading">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 6.0.</span></p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">FixtureRequest</span></code>, <code class="docutils literal notranslate"><span class="pre">Metafunc</span></code>, and <code class="docutils literal notranslate"><span class="pre">Function</span></code> classes track the names of
their associated fixtures, with the aptly-named <code class="docutils literal notranslate"><span class="pre">fixturenames</span></code> attribute.</p>
<p>Prior to pytest 2.3, this attribute was named <code class="docutils literal notranslate"><span class="pre">funcargnames</span></code>, and we have kept
that as an alias since.  It is finally due for removal, as it is often confusing
in places where we or plugin authors must distinguish between fixture names and
names supplied by non-fixture things such as <code class="docutils literal notranslate"><span class="pre">pytest.mark.parametrize</span></code>.</p>
</section>
<section id="pytest-config-global">
<a class="dashAnchor" name="//apple_ref/cpp/Section/pytest.config global"></a><span id="pytest-config-global-deprecated"></span><h3><a class="toc-backref" href="#id32" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">pytest.config</span></code> global</a><a class="headerlink" href="#pytest-config-global" title="Permalink to this heading">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 5.0.</span></p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">pytest.config</span></code> global object is deprecated.  Instead use
<code class="docutils literal notranslate"><span class="pre">request.config</span></code> (via the <code class="docutils literal notranslate"><span class="pre">request</span></code> fixture) or if you are a plugin author
use the <code class="docutils literal notranslate"><span class="pre">pytest_configure(config)</span></code> hook. Note that many hooks can also access
the <code class="docutils literal notranslate"><span class="pre">config</span></code> object indirectly, through <code class="docutils literal notranslate"><span class="pre">session.config</span></code> or <code class="docutils literal notranslate"><span class="pre">item.config</span></code> for example.</p>
</section>
<section id="message-parameter-of-pytest-raises">
<a class="dashAnchor" name='//apple_ref/cpp/Section/"message" parameter of pytest.raises'></a><span id="raises-message-deprecated"></span><h3><a class="toc-backref" href="#id33" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">"message"</span></code> parameter of <code class="docutils literal notranslate"><span class="pre">pytest.raises</span></code></a><a class="headerlink" href="#message-parameter-of-pytest-raises" title="Permalink to this heading">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 5.0.</span></p>
</div>
<p>It is a common mistake to think this parameter will match the exception message, while in fact
it only serves to provide a custom message in case the <code class="docutils literal notranslate"><span class="pre">pytest.raises</span></code> check fails. To prevent
users from making this mistake, and because it is believed to be little used, pytest is
deprecating it without providing an alternative for the moment.</p>
<p>If you have a valid use case for this parameter, consider that to obtain the same results
you can just call <code class="docutils literal notranslate"><span class="pre">pytest.fail</span></code> manually at the end of the <code class="docutils literal notranslate"><span class="pre">with</span></code> statement.</p>
<p>For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">TimeoutError</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">"Client got unexpected message"</span><span class="p">):</span>
    <span class="n">wait_for</span><span class="p">(</span><span class="n">websocket</span><span class="o">.</span><span class="n">recv</span><span class="p">(),</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
<p>Becomes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">TimeoutError</span><span class="p">):</span>
    <span class="n">wait_for</span><span class="p">(</span><span class="n">websocket</span><span class="o">.</span><span class="n">recv</span><span class="p">(),</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">pytest</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s2">"Client got unexpected message"</span><span class="p">)</span>
</pre></div>
</div>
<p>If you still have concerns about this deprecation and future removal, please comment on
<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3974">issue #3974</a>.</p>
</section>
<section id="raises-warns-with-a-string-as-the-second-argument">
<a class="dashAnchor" name="//apple_ref/cpp/Section/raises / warns with a string as the second argument"></a><span id="raises-warns-exec"></span><h3><a class="toc-backref" href="#id34" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">raises</span></code> / <code class="docutils literal notranslate"><span class="pre">warns</span></code> with a string as the second argument</a><a class="headerlink" href="#raises-warns-with-a-string-as-the-second-argument" title="Permalink to this heading">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 5.0.</span></p>
</div>
<p>Use the context manager form of these instead.  When necessary, invoke <code class="docutils literal notranslate"><span class="pre">exec</span></code>
directly.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ZeroDivisionError</span><span class="p">,</span> <span class="s2">"1 / 0"</span><span class="p">)</span>
<span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">SyntaxError</span><span class="p">,</span> <span class="s2">"a $ b"</span><span class="p">)</span>

<span class="n">pytest</span><span class="o">.</span><span class="n">warns</span><span class="p">(</span><span class="ne">DeprecationWarning</span><span class="p">,</span> <span class="s2">"my_function()"</span><span class="p">)</span>
<span class="n">pytest</span><span class="o">.</span><span class="n">warns</span><span class="p">(</span><span class="ne">SyntaxWarning</span><span class="p">,</span> <span class="s2">"assert(1, 2)"</span><span class="p">)</span>
</pre></div>
</div>
<p>Becomes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ZeroDivisionError</span><span class="p">):</span>
    <span class="mi">1</span> <span class="o">/</span> <span class="mi">0</span>
<span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">SyntaxError</span><span class="p">):</span>
    <span class="n">exec</span><span class="p">(</span><span class="s2">"a $ b"</span><span class="p">)</span>  <span class="c1"># exec is required for invalid syntax</span>

<span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">warns</span><span class="p">(</span><span class="ne">DeprecationWarning</span><span class="p">):</span>
    <span class="n">my_function</span><span class="p">()</span>
<span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">warns</span><span class="p">(</span><span class="ne">SyntaxWarning</span><span class="p">):</span>
    <span class="n">exec</span><span class="p">(</span><span class="s2">"assert(1, 2)"</span><span class="p">)</span>  <span class="c1"># exec is used to avoid a top-level warning</span>
</pre></div>
</div>
</section>
<section id="using-class-in-custom-collectors">
<h3><a class="toc-backref" href="#id35" role="doc-backlink">Using <code class="docutils literal notranslate"><span class="pre">Class</span></code> in custom Collectors</a><a class="headerlink" href="#using-class-in-custom-collectors" title="Permalink to this heading">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p>Using objects named <code class="docutils literal notranslate"><span class="pre">"Class"</span></code> as a way to customize the type of nodes that are collected in <code class="docutils literal notranslate"><span class="pre">Collector</span></code>
subclasses has been deprecated. Users instead should use <code class="docutils literal notranslate"><span class="pre">pytest_pycollect_makeitem</span></code> to customize node types during
collection.</p>
<p>This issue should affect only advanced plugins who create new collection types, so if you see this warning
message please contact the authors so they can change the code.</p>
</section>
<section id="marks-in-pytest-mark-parametrize">
<a class="dashAnchor" name="//apple_ref/cpp/Section/marks in pytest.mark.parametrize"></a><span id="marks-in-pytest-parametrize-deprecated"></span><h3><a class="toc-backref" href="#id36" role="doc-backlink">marks in <code class="docutils literal notranslate"><span class="pre">pytest.mark.parametrize</span></code></a><a class="headerlink" href="#marks-in-pytest-mark-parametrize" title="Permalink to this heading">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p>Applying marks to values of a <code class="docutils literal notranslate"><span class="pre">pytest.mark.parametrize</span></code> call is now deprecated. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span>
    <span class="s2">"a, b"</span><span class="p">,</span>
    <span class="p">[</span>
        <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
        <span class="n">pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">xfail</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="s2">"flaky"</span><span class="p">)(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">36</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">400</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">500</span><span class="p">),</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">test_foo</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>This code applies the <code class="docutils literal notranslate"><span class="pre">pytest.mark.xfail(reason="flaky")</span></code> mark to the <code class="docutils literal notranslate"><span class="pre">(6,</span> <span class="pre">36)</span></code> value of the above parametrization
call.</p>
<p>This was considered hard to read and understand, and also its implementation presented problems to the code preventing
further internal improvements in the marks architecture.</p>
<p>To update the code, use <code class="docutils literal notranslate"><span class="pre">pytest.param</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span>
    <span class="s2">"a, b"</span><span class="p">,</span>
    <span class="p">[</span>
        <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
        <span class="n">pytest</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="n">marks</span><span class="o">=</span><span class="n">pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">xfail</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="s2">"flaky"</span><span class="p">)),</span>
        <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">400</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">500</span><span class="p">),</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">test_foo</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
</section>
<section id="pytest-funcarg-prefix">
<a class="dashAnchor" name="//apple_ref/cpp/Section/pytest_funcarg__ prefix"></a><span id="pytest-funcarg-prefix-deprecated"></span><h3><a class="toc-backref" href="#id37" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">pytest_funcarg__</span></code> prefix</a><a class="headerlink" href="#pytest-funcarg-prefix" title="Permalink to this heading">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p>In very early pytest versions fixtures could be defined using the <code class="docutils literal notranslate"><span class="pre">pytest_funcarg__</span></code> prefix:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pytest_funcarg__data</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">SomeData</span><span class="p">()</span>
</pre></div>
</div>
<p>Switch over to the <code class="docutils literal notranslate"><span class="pre">@pytest.fixture</span></code> decorator:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span> <span class="nf">data</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">SomeData</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="pytest-section-in-setup-cfg-files">
<h3><a class="toc-backref" href="#id38" role="doc-backlink">[pytest] section in setup.cfg files</a><a class="headerlink" href="#pytest-section-in-setup-cfg-files" title="Permalink to this heading">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">[pytest]</span></code> sections in <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code> files should now be named <code class="docutils literal notranslate"><span class="pre">[tool:pytest]</span></code>
to avoid conflicts with other distutils commands.</p>
</section>
<section id="metafunc-addcall">
<a class="dashAnchor" name="//apple_ref/cpp/Section/Metafunc.addcall"></a><span id="metafunc-addcall-deprecated"></span><h3><a class="toc-backref" href="#id39" role="doc-backlink">Metafunc.addcall</a><a class="headerlink" href="#metafunc-addcall" title="Permalink to this heading">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Metafunc.addcall</span></code> was a precursor to the current parametrized mechanism. Users should use
<a class="reference internal" href="reference/reference.html#pytest.Metafunc.parametrize" title="pytest.Metafunc.parametrize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pytest.Metafunc.parametrize()</span></code></a> instead.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pytest_generate_tests</span><span class="p">(</span><span class="n">metafunc</span><span class="p">):</span>
    <span class="n">metafunc</span><span class="o">.</span><span class="n">addcall</span><span class="p">({</span><span class="s2">"i"</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="nb">id</span><span class="o">=</span><span class="s2">"1"</span><span class="p">)</span>
    <span class="n">metafunc</span><span class="o">.</span><span class="n">addcall</span><span class="p">({</span><span class="s2">"i"</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="nb">id</span><span class="o">=</span><span class="s2">"2"</span><span class="p">)</span>
</pre></div>
</div>
<p>Becomes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pytest_generate_tests</span><span class="p">(</span><span class="n">metafunc</span><span class="p">):</span>
    <span class="n">metafunc</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span><span class="s2">"i"</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">ids</span><span class="o">=</span><span class="p">[</span><span class="s2">"1"</span><span class="p">,</span> <span class="s2">"2"</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="cached-setup">
<a class="dashAnchor" name="//apple_ref/cpp/Section/cached_setup"></a><span id="cached-setup-deprecated"></span><h3><a class="toc-backref" href="#id40" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">cached_setup</span></code></a><a class="headerlink" href="#cached-setup" title="Permalink to this heading">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">request.cached_setup</span></code> was the precursor of the setup/teardown mechanism available to fixtures.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span> <span class="nf">db_session</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">request</span><span class="o">.</span><span class="n">cached_setup</span><span class="p">(</span>
        <span class="n">setup</span><span class="o">=</span><span class="n">Session</span><span class="o">.</span><span class="n">create</span><span class="p">,</span> <span class="n">teardown</span><span class="o">=</span><span class="k">lambda</span> <span class="n">session</span><span class="p">:</span> <span class="n">session</span><span class="o">.</span><span class="n">close</span><span class="p">(),</span> <span class="n">scope</span><span class="o">=</span><span class="s2">"module"</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>This should be updated to make use of standard fixture mechanisms:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">"module"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">db_session</span><span class="p">():</span>
    <span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
    <span class="k">yield</span> <span class="n">session</span>
    <span class="n">session</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>You can consult <a class="reference internal" href="funcarg_compare.html"><span class="doc">funcarg comparison section in the docs</span></a> for
more information.</p>
</section>
<section id="pytest-plugins-in-non-top-level-conftest-files">
<a class="dashAnchor" name="//apple_ref/cpp/Section/pytest_plugins in non-top-level conftest files"></a><span id="pytest-plugins-in-non-top-level-conftest-files-deprecated"></span><h3><a class="toc-backref" href="#id41" role="doc-backlink">pytest_plugins in non-top-level conftest files</a><a class="headerlink" href="#pytest-plugins-in-non-top-level-conftest-files" title="Permalink to this heading">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p>Defining <a class="reference internal" href="reference/reference.html#globalvar-pytest_plugins"><code class="xref std std-globalvar docutils literal notranslate"><span class="pre">pytest_plugins</span></code></a> is now deprecated in non-top-level conftest.py
files because they will activate referenced plugins <em>globally</em>, which is surprising because for all other pytest
features <code class="docutils literal notranslate"><span class="pre">conftest.py</span></code> files are only <em>active</em> for tests at or below it.</p>
</section>
<section id="config-warn-and-node-warn">
<a class="dashAnchor" name="//apple_ref/cpp/Section/Config.warn and Node.warn"></a><span id="config-warn-and-node-warn-deprecated"></span><h3><a class="toc-backref" href="#id42" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">Config.warn</span></code> and <code class="docutils literal notranslate"><span class="pre">Node.warn</span></code></a><a class="headerlink" href="#config-warn-and-node-warn" title="Permalink to this heading">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p>Those methods were part of the internal pytest warnings system, but since <code class="docutils literal notranslate"><span class="pre">3.8</span></code> pytest is using the builtin warning
system for its own warnings, so those two functions are now deprecated.</p>
<p><code class="docutils literal notranslate"><span class="pre">Config.warn</span></code> should be replaced by calls to the standard <code class="docutils literal notranslate"><span class="pre">warnings.warn</span></code>, example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">config</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">"C1"</span><span class="p">,</span> <span class="s2">"some warning"</span><span class="p">)</span>
</pre></div>
</div>
<p>Becomes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">pytest</span><span class="o">.</span><span class="n">PytestWarning</span><span class="p">(</span><span class="s2">"some warning"</span><span class="p">))</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Node.warn</span></code> now supports two signatures:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">node.warn(PytestWarning("some</span> <span class="pre">message"))</span></code>: is now the <strong>recommended</strong> way to call this function.
The warning instance must be a PytestWarning or subclass.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">node.warn("CI",</span> <span class="pre">"some</span> <span class="pre">message")</span></code>: this code/message form has been <strong>removed</strong> and should be converted to the warning instance form above.</p></li>
</ul>
</section>
<section id="record-xml-property">
<a class="dashAnchor" name="//apple_ref/cpp/Section/record_xml_property"></a><span id="record-xml-property-deprecated"></span><h3><a class="toc-backref" href="#id43" role="doc-backlink">record_xml_property</a><a class="headerlink" href="#record-xml-property" title="Permalink to this heading">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">record_xml_property</span></code> fixture is now deprecated in favor of the more generic <code class="docutils literal notranslate"><span class="pre">record_property</span></code>, which
can be used by other consumers (for example <code class="docutils literal notranslate"><span class="pre">pytest-html</span></code>) to obtain custom information about the test run.</p>
<p>This is just a matter of renaming the fixture as the API is the same:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_foo</span><span class="p">(</span><span class="n">record_xml_property</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>Change to:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_foo</span><span class="p">(</span><span class="n">record_property</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
</section>
<section id="passing-command-line-string-to-pytest-main">
<a class="dashAnchor" name="//apple_ref/cpp/Section/Passing command-line string to pytest.main()"></a><span id="passing-command-line-string-to-pytest-main-deprecated"></span><h3><a class="toc-backref" href="#id44" role="doc-backlink">Passing command-line string to <code class="docutils literal notranslate"><span class="pre">pytest.main()</span></code></a><a class="headerlink" href="#passing-command-line-string-to-pytest-main" title="Permalink to this heading">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p>Passing a command-line string to <code class="docutils literal notranslate"><span class="pre">pytest.main()</span></code> is deprecated:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pytest</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="s2">"-v -s"</span><span class="p">)</span>
</pre></div>
</div>
<p>Pass a list instead:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pytest</span><span class="o">.</span><span class="n">main</span><span class="p">([</span><span class="s2">"-v"</span><span class="p">,</span> <span class="s2">"-s"</span><span class="p">])</span>
</pre></div>
</div>
<p>By passing a string, users expect that pytest will interpret that command-line using the shell rules they are working
on (for example <code class="docutils literal notranslate"><span class="pre">bash</span></code> or <code class="docutils literal notranslate"><span class="pre">Powershell</span></code>), but this is very hard/impossible to do in a portable way.</p>
</section>
<section id="calling-fixtures-directly">
<a class="dashAnchor" name="//apple_ref/cpp/Section/Calling fixtures directly"></a><span id="calling-fixtures-directly-deprecated"></span><h3><a class="toc-backref" href="#id45" role="doc-backlink">Calling fixtures directly</a><a class="headerlink" href="#calling-fixtures-directly" title="Permalink to this heading">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p>Calling a fixture function directly, as opposed to request them in a test function, is deprecated.</p>
<p>For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span> <span class="nf">cell</span><span class="p">():</span>
    <span class="k">return</span> <span class="o">...</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span> <span class="nf">full_cell</span><span class="p">():</span>
    <span class="n">cell</span> <span class="o">=</span> <span class="n">cell</span><span class="p">()</span>
    <span class="n">cell</span><span class="o">.</span><span class="n">make_full</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">cell</span>
</pre></div>
</div>
<p>This is a great source of confusion to new users, which will often call the fixture functions and request them from test functions interchangeably, which breaks the fixture resolution model.</p>
<p>In those cases just request the function directly in the dependent fixture:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span> <span class="nf">cell</span><span class="p">():</span>
    <span class="k">return</span> <span class="o">...</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span> <span class="nf">full_cell</span><span class="p">(</span><span class="n">cell</span><span class="p">):</span>
    <span class="n">cell</span><span class="o">.</span><span class="n">make_full</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">cell</span>
</pre></div>
</div>
<p>Alternatively if the fixture function is called multiple times inside a test (making it hard to apply the above pattern) or
if you would like to make minimal changes to the code, you can create a fixture which calls the original function together
with the <code class="docutils literal notranslate"><span class="pre">name</span></code> parameter:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cell</span><span class="p">():</span>
    <span class="k">return</span> <span class="o">...</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"cell"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">cell_fixture</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">cell</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="yield-tests">
<a class="dashAnchor" name="//apple_ref/cpp/Section/yield tests"></a><span id="yield-tests-deprecated"></span><h3><a class="toc-backref" href="#id46" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">yield</span></code> tests</a><a class="headerlink" href="#yield-tests" title="Permalink to this heading">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p>pytest supported <code class="docutils literal notranslate"><span class="pre">yield</span></code>-style tests, where a test function actually <code class="docutils literal notranslate"><span class="pre">yield</span></code> functions and values
that are then turned into proper test methods. Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">x</span><span class="o">**</span><span class="n">x</span> <span class="o">==</span> <span class="n">y</span>


<span class="k">def</span> <span class="nf">test_squared</span><span class="p">():</span>
    <span class="k">yield</span> <span class="n">check</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span>
    <span class="k">yield</span> <span class="n">check</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span>
</pre></div>
</div>
<p>This would result into two actual test functions being generated.</p>
<p>This form of test function doesn’t support fixtures properly, and users should switch to <code class="docutils literal notranslate"><span class="pre">pytest.mark.parametrize</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span><span class="s2">"x, y"</span><span class="p">,</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">)])</span>
<span class="k">def</span> <span class="nf">test_squared</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">x</span><span class="o">**</span><span class="n">x</span> <span class="o">==</span> <span class="n">y</span>
</pre></div>
</div>
</section>
<section id="internal-classes-accessed-through-node">
<a class="dashAnchor" name="//apple_ref/cpp/Section/Internal classes accessed through Node"></a><span id="internal-classes-accessed-through-node-deprecated"></span><h3><a class="toc-backref" href="#id47" role="doc-backlink">Internal classes accessed through <code class="docutils literal notranslate"><span class="pre">Node</span></code></a><a class="headerlink" href="#internal-classes-accessed-through-node" title="Permalink to this heading">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p>Access of <code class="docutils literal notranslate"><span class="pre">Module</span></code>, <code class="docutils literal notranslate"><span class="pre">Function</span></code>, <code class="docutils literal notranslate"><span class="pre">Class</span></code>, <code class="docutils literal notranslate"><span class="pre">Instance</span></code>, <code class="docutils literal notranslate"><span class="pre">File</span></code> and <code class="docutils literal notranslate"><span class="pre">Item</span></code> through <code class="docutils literal notranslate"><span class="pre">Node</span></code> instances now issue
this warning:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>usage of Function.Module is deprecated, please use pytest.Module instead
</pre></div>
</div>
<p>Users should just <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">pytest</span></code> and access those objects using the <code class="docutils literal notranslate"><span class="pre">pytest</span></code> module.</p>
<p>This has been documented as deprecated for years, but only now we are actually emitting deprecation warnings.</p>
</section>
<section id="node-get-marker">
<h3><a class="toc-backref" href="#id48" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">Node.get_marker</span></code></a><a class="headerlink" href="#node-get-marker" title="Permalink to this heading">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p>As part of a large <a class="reference internal" href="historical-notes.html#marker-revamp"><span class="std std-ref">Marker revamp and iteration</span></a>, <code class="docutils literal notranslate"><span class="pre">_pytest.nodes.Node.get_marker</span></code> is removed. See
<a class="reference internal" href="historical-notes.html#update-marker-code"><span class="std std-ref">the documentation</span></a> on tips on how to update your code.</p>
</section>
<section id="somefunction-markname">
<h3><a class="toc-backref" href="#id49" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">somefunction.markname</span></code></a><a class="headerlink" href="#somefunction-markname" title="Permalink to this heading">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p>As part of a large <a class="reference internal" href="historical-notes.html#marker-revamp"><span class="std std-ref">Marker revamp and iteration</span></a> we already deprecated using <code class="docutils literal notranslate"><span class="pre">MarkInfo</span></code>
the only correct way to get markers of an element is via <code class="docutils literal notranslate"><span class="pre">node.iter_markers(name)</span></code>.</p>
</section>
<section id="pytest-namespace">
<a class="dashAnchor" name="//apple_ref/cpp/Section/pytest_namespace"></a><span id="pytest-namespace-deprecated"></span><h3><a class="toc-backref" href="#id50" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">pytest_namespace</span></code></a><a class="headerlink" href="#pytest-namespace" title="Permalink to this heading">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p>This hook is deprecated because it greatly complicates the pytest internals regarding configuration and initialization, making some
bug fixes and refactorings impossible.</p>
<p>Example of usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MySymbol</span><span class="p">:</span>
    <span class="o">...</span>


<span class="k">def</span> <span class="nf">pytest_namespace</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">"my_symbol"</span><span class="p">:</span> <span class="n">MySymbol</span><span class="p">()}</span>
</pre></div>
</div>
<p>Plugin authors relying on this hook should instead require that users now import the plugin modules directly (with an appropriate public API).</p>
<p>As a stopgap measure, plugin authors may still inject their names into pytest’s namespace, usually during <code class="docutils literal notranslate"><span class="pre">pytest_configure</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pytest</span>


<span class="k">def</span> <span class="nf">pytest_configure</span><span class="p">():</span>
    <span class="n">pytest</span><span class="o">.</span><span class="n">my_symbol</span> <span class="o">=</span> <span class="n">MySymbol</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
</section>
<div class="clearer"></div>
</div>
</div>
<span id="sidebar-top"></span>
<div class="clearer"></div>
</div>
<div class="footer" role="contentinfo">
        © Copyright 2015, holger krekel and pytest-dev team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
<script src="_static/version_warning_offset.js"></script>
</body>
</html>
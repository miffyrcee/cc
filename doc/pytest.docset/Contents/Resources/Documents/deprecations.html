


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Deprecations and Removals &#8212; pytest documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/pygments_pytest.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Python 2.7 and 3.4 support" href="py27-py34-deprecation.html" />
    <link rel="prev" title="Backwards Compatibility Policy" href="backwards-compatibility.html" />
  <script>DOCUMENTATION_OPTIONS.URL_ROOT = './';</script>
   
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="py27-py34-deprecation.html" title="Python 2.7 and 3.4 support"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="backwards-compatibility.html" title="Backwards Compatibility Policy"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="contents.html">pytest-6.2</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Deprecations and Removals</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <div class="section" id="deprecations-and-removals">
<span id="deprecations"></span><h1>Deprecations and Removals<a class="headerlink" href="#deprecations-and-removals" title="Permalink to this headline">¶</a></h1>
<p>This page lists all pytest features that are currently deprecated or have been removed in past major releases.
The objective is to give users a clear rationale why a certain feature has been removed, and what alternatives
should be used instead.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#deprecated-features" id="id1">Deprecated Features</a></p>
<ul>
<li><p><a class="reference internal" href="#the-strict-command-line-option" id="id2">The <code class="docutils literal notranslate"><span class="pre">--strict</span></code> command-line option</a></p></li>
<li><p><a class="reference internal" href="#the-yield-fixture-function-decorator" id="id3">The <code class="docutils literal notranslate"><span class="pre">yield_fixture</span></code> function/decorator</a></p></li>
<li><p><a class="reference internal" href="#the-pytest-warning-captured-hook" id="id4">The <code class="docutils literal notranslate"><span class="pre">pytest_warning_captured</span></code> hook</a></p></li>
<li><p><a class="reference internal" href="#the-pytest-collect-module" id="id5">The <code class="docutils literal notranslate"><span class="pre">pytest.collect</span></code> module</a></p></li>
<li><p><a class="reference internal" href="#the-pytest-fillfuncargs-function" id="id6">The <code class="docutils literal notranslate"><span class="pre">pytest._fillfuncargs</span></code> function</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#removed-features" id="id7">Removed Features</a></p>
<ul>
<li><p><a class="reference internal" href="#no-print-logs-command-line-option" id="id8"><code class="docutils literal notranslate"><span class="pre">--no-print-logs</span></code> command-line option</a></p></li>
<li><p><a class="reference internal" href="#result-log-result-log" id="id9">Result log (<code class="docutils literal notranslate"><span class="pre">--result-log</span></code>)</a></p></li>
<li><p><a class="reference internal" href="#pytest-collect-directory-hook" id="id10"><code class="docutils literal notranslate"><span class="pre">pytest_collect_directory</span></code> hook</a></p></li>
<li><p><a class="reference internal" href="#terminalreporter-writer" id="id11">TerminalReporter.writer</a></p></li>
<li><p><a class="reference internal" href="#junit-family-default-value-change-to-xunit2" id="id12"><code class="docutils literal notranslate"><span class="pre">junit_family</span></code> default value change to “xunit2”</a></p></li>
<li><p><a class="reference internal" href="#node-construction-changed-to-node-from-parent" id="id13">Node Construction changed to <code class="docutils literal notranslate"><span class="pre">Node.from_parent</span></code></a></p></li>
<li><p><a class="reference internal" href="#pytest-fixture-arguments-are-keyword-only" id="id14"><code class="docutils literal notranslate"><span class="pre">pytest.fixture</span></code> arguments are keyword only</a></p></li>
<li><p><a class="reference internal" href="#funcargnames-alias-for-fixturenames" id="id15"><code class="docutils literal notranslate"><span class="pre">funcargnames</span></code> alias for <code class="docutils literal notranslate"><span class="pre">fixturenames</span></code></a></p></li>
<li><p><a class="reference internal" href="#pytest-config-global" id="id16"><code class="docutils literal notranslate"><span class="pre">pytest.config</span></code> global</a></p></li>
<li><p><a class="reference internal" href="#message-parameter-of-pytest-raises" id="id17"><code class="docutils literal notranslate"><span class="pre">&quot;message&quot;</span></code> parameter of <code class="docutils literal notranslate"><span class="pre">pytest.raises</span></code></a></p></li>
<li><p><a class="reference internal" href="#raises-warns-with-a-string-as-the-second-argument" id="id18"><code class="docutils literal notranslate"><span class="pre">raises</span></code> / <code class="docutils literal notranslate"><span class="pre">warns</span></code> with a string as the second argument</a></p></li>
<li><p><a class="reference internal" href="#using-class-in-custom-collectors" id="id19">Using <code class="docutils literal notranslate"><span class="pre">Class</span></code> in custom Collectors</a></p></li>
<li><p><a class="reference internal" href="#marks-in-pytest-mark-parametrize" id="id20">marks in <code class="docutils literal notranslate"><span class="pre">pytest.mark.parametrize</span></code></a></p></li>
<li><p><a class="reference internal" href="#pytest-funcarg-prefix" id="id21"><code class="docutils literal notranslate"><span class="pre">pytest_funcarg__</span></code> prefix</a></p></li>
<li><p><a class="reference internal" href="#pytest-section-in-setup-cfg-files" id="id22">[pytest] section in setup.cfg files</a></p></li>
<li><p><a class="reference internal" href="#metafunc-addcall" id="id23">Metafunc.addcall</a></p></li>
<li><p><a class="reference internal" href="#cached-setup" id="id24"><code class="docutils literal notranslate"><span class="pre">cached_setup</span></code></a></p></li>
<li><p><a class="reference internal" href="#pytest-plugins-in-non-top-level-conftest-files" id="id25">pytest_plugins in non-top-level conftest files</a></p></li>
<li><p><a class="reference internal" href="#config-warn-and-node-warn" id="id26"><code class="docutils literal notranslate"><span class="pre">Config.warn</span></code> and <code class="docutils literal notranslate"><span class="pre">Node.warn</span></code></a></p></li>
<li><p><a class="reference internal" href="#record-xml-property" id="id27">record_xml_property</a></p></li>
<li><p><a class="reference internal" href="#passing-command-line-string-to-pytest-main" id="id28">Passing command-line string to <code class="docutils literal notranslate"><span class="pre">pytest.main()</span></code></a></p></li>
<li><p><a class="reference internal" href="#calling-fixtures-directly" id="id29">Calling fixtures directly</a></p></li>
<li><p><a class="reference internal" href="#yield-tests" id="id30"><code class="docutils literal notranslate"><span class="pre">yield</span></code> tests</a></p></li>
<li><p><a class="reference internal" href="#internal-classes-accessed-through-node" id="id31">Internal classes accessed through <code class="docutils literal notranslate"><span class="pre">Node</span></code></a></p></li>
<li><p><a class="reference internal" href="#node-get-marker" id="id32"><code class="docutils literal notranslate"><span class="pre">Node.get_marker</span></code></a></p></li>
<li><p><a class="reference internal" href="#somefunction-markname" id="id33"><code class="docutils literal notranslate"><span class="pre">somefunction.markname</span></code></a></p></li>
<li><p><a class="reference internal" href="#pytest-namespace" id="id34"><code class="docutils literal notranslate"><span class="pre">pytest_namespace</span></code></a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="deprecated-features">
<h2><a class="toc-backref" href="#id1">Deprecated Features</a><a class="headerlink" href="#deprecated-features" title="Permalink to this headline">¶</a></h2>
<p>Below is a complete list of all pytest features which are considered deprecated. Using those features will issue
<code class="xref py py-class docutils literal notranslate"><span class="pre">PytestWarning</span></code> or subclasses, which can be filtered using <a class="reference internal" href="warnings.html#warnings"><span class="std std-ref">standard warning filters</span></a>.</p>
<div class="section" id="the-strict-command-line-option">
<h3><a class="toc-backref" href="#id2">The <code class="docutils literal notranslate"><span class="pre">--strict</span></code> command-line option</a><a class="headerlink" href="#the-strict-command-line-option" title="Permalink to this headline">¶</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 6.2.</span></p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">--strict</span></code> command-line option has been deprecated in favor of <code class="docutils literal notranslate"><span class="pre">--strict-markers</span></code>, which
better conveys what the option does.</p>
<p>We have plans to maybe in the future to reintroduce <code class="docutils literal notranslate"><span class="pre">--strict</span></code> and make it an encompassing
flag for all strictness related options (<code class="docutils literal notranslate"><span class="pre">--strict-markers</span></code> and <code class="docutils literal notranslate"><span class="pre">--strict-config</span></code>
at the moment, more might be introduced in the future).</p>
</div>
<div class="section" id="the-yield-fixture-function-decorator">
<h3><a class="toc-backref" href="#id3">The <code class="docutils literal notranslate"><span class="pre">yield_fixture</span></code> function/decorator</a><a class="headerlink" href="#the-yield-fixture-function-decorator" title="Permalink to this headline">¶</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 6.2.</span></p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pytest.yield_fixture</span></code> is a deprecated alias for <a class="reference internal" href="reference.html#pytest.fixture" title="pytest.fixture"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest.fixture()</span></code></a>.</p>
<p>It has been so for a very long time, so can be search/replaced safely.</p>
</div>
<div class="section" id="the-pytest-warning-captured-hook">
<h3><a class="toc-backref" href="#id4">The <code class="docutils literal notranslate"><span class="pre">pytest_warning_captured</span></code> hook</a><a class="headerlink" href="#the-pytest-warning-captured-hook" title="Permalink to this headline">¶</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 6.0.</span></p>
</div>
<p>This hook has an <code class="docutils literal notranslate"><span class="pre">item</span></code> parameter which cannot be serialized by <code class="docutils literal notranslate"><span class="pre">pytest-xdist</span></code>.</p>
<p>Use the <code class="docutils literal notranslate"><span class="pre">pytest_warning_recored</span></code> hook instead, which replaces the <code class="docutils literal notranslate"><span class="pre">item</span></code> parameter
by a <code class="docutils literal notranslate"><span class="pre">nodeid</span></code> parameter.</p>
</div>
<div class="section" id="the-pytest-collect-module">
<h3><a class="toc-backref" href="#id5">The <code class="docutils literal notranslate"><span class="pre">pytest.collect</span></code> module</a><a class="headerlink" href="#the-pytest-collect-module" title="Permalink to this headline">¶</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 6.0.</span></p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">pytest.collect</span></code> module is no longer part of the public API, all its names
should now be imported from <code class="docutils literal notranslate"><span class="pre">pytest</span></code> directly instead.</p>
</div>
<div class="section" id="the-pytest-fillfuncargs-function">
<h3><a class="toc-backref" href="#id6">The <code class="docutils literal notranslate"><span class="pre">pytest._fillfuncargs</span></code> function</a><a class="headerlink" href="#the-pytest-fillfuncargs-function" title="Permalink to this headline">¶</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 6.0.</span></p>
</div>
<p>This function was kept for backward compatibility with an older plugin.</p>
<p>It’s functionality is not meant to be used directly, but if you must replace
it, use <code class="docutils literal notranslate"><span class="pre">function._request._fillfixtures()</span></code> instead, though note this is not
a public API and may break in the future.</p>
</div>
</div>
<div class="section" id="removed-features">
<h2><a class="toc-backref" href="#id7">Removed Features</a><a class="headerlink" href="#removed-features" title="Permalink to this headline">¶</a></h2>
<p>As stated in our <a class="reference internal" href="backwards-compatibility.html#backwards-compatibility"><span class="std std-ref">Backwards Compatibility Policy</span></a> policy, deprecated features are removed only in major releases after
an appropriate period of deprecation has passed.</p>
<div class="section" id="no-print-logs-command-line-option">
<h3><a class="toc-backref" href="#id8"><code class="docutils literal notranslate"><span class="pre">--no-print-logs</span></code> command-line option</a><a class="headerlink" href="#no-print-logs-command-line-option" title="Permalink to this headline">¶</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 5.4.</span></p>
</div>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 6.0.</span></p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">--no-print-logs</span></code> option and <code class="docutils literal notranslate"><span class="pre">log_print</span></code> ini setting are removed. If
you used them, please use <code class="docutils literal notranslate"><span class="pre">--show-capture</span></code> instead.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">--show-capture</span></code> command-line option was added in <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">3.5.0</span></code> which allows to specify how to
display captured output when tests fail: <code class="docutils literal notranslate"><span class="pre">no</span></code>, <code class="docutils literal notranslate"><span class="pre">stdout</span></code>, <code class="docutils literal notranslate"><span class="pre">stderr</span></code>, <code class="docutils literal notranslate"><span class="pre">log</span></code> or <code class="docutils literal notranslate"><span class="pre">all</span></code> (the default).</p>
</div>
<div class="section" id="result-log-result-log">
<h3><a class="toc-backref" href="#id9">Result log (<code class="docutils literal notranslate"><span class="pre">--result-log</span></code>)</a><a class="headerlink" href="#result-log-result-log" title="Permalink to this headline">¶</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 4.0.</span></p>
</div>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 6.0.</span></p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">--result-log</span></code> option produces a stream of test reports which can be
analysed at runtime, but it uses a custom format which requires users to implement their own
parser.</p>
<p>The  <a class="reference external" href="https://github.com/pytest-dev/pytest-reportlog">pytest-reportlog</a> plugin provides a <code class="docutils literal notranslate"><span class="pre">--report-log</span></code> option, a more standard and extensible alternative, producing
one JSON object per-line, and should cover the same use cases. Please try it out and provide feedback.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">pytest-reportlog</span></code> plugin might even be merged into the core
at some point, depending on the plans for the plugins and number of users using it.</p>
</div>
<div class="section" id="pytest-collect-directory-hook">
<h3><a class="toc-backref" href="#id10"><code class="docutils literal notranslate"><span class="pre">pytest_collect_directory</span></code> hook</a><a class="headerlink" href="#pytest-collect-directory-hook" title="Permalink to this headline">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 6.0.</span></p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">pytest_collect_directory</span></code> has not worked properly for years (it was called
but the results were ignored). Users may consider using <a class="reference internal" href="reference.html#pytest.hookspec.pytest_collection_modifyitems" title="_pytest.hookspec.pytest_collection_modifyitems"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytest_collection_modifyitems</span></code></a> instead.</p>
</div>
<div class="section" id="terminalreporter-writer">
<h3><a class="toc-backref" href="#id11">TerminalReporter.writer</a><a class="headerlink" href="#terminalreporter-writer" title="Permalink to this headline">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 6.0.</span></p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">TerminalReporter.writer</span></code> attribute has been deprecated and should no longer be used. This
was inadvertently exposed as part of the public API of that plugin and ties it too much
with <code class="docutils literal notranslate"><span class="pre">py.io.TerminalWriter</span></code>.</p>
<p>Plugins that used <code class="docutils literal notranslate"><span class="pre">TerminalReporter.writer</span></code> directly should instead use <code class="docutils literal notranslate"><span class="pre">TerminalReporter</span></code>
methods that provide the same functionality.</p>
</div>
<div class="section" id="junit-family-default-value-change-to-xunit2">
<h3><a class="toc-backref" href="#id12"><code class="docutils literal notranslate"><span class="pre">junit_family</span></code> default value change to “xunit2”</a><a class="headerlink" href="#junit-family-default-value-change-to-xunit2" title="Permalink to this headline">¶</a></h3>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 6.0.</span></p>
</div>
<p>The default value of <code class="docutils literal notranslate"><span class="pre">junit_family</span></code> option will change to <code class="docutils literal notranslate"><span class="pre">xunit2</span></code> in pytest 6.0, which
is an update of the old <code class="docutils literal notranslate"><span class="pre">xunit1</span></code> format and is supported by default in modern tools
that manipulate this type of file (for example, Jenkins, Azure Pipelines, etc.).</p>
<p>Users are recommended to try the new <code class="docutils literal notranslate"><span class="pre">xunit2</span></code> format and see if their tooling that consumes the JUnit
XML file supports it.</p>
<p>To use the new format, update your <code class="docutils literal notranslate"><span class="pre">pytest.ini</span></code>:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[pytest]</span>
<span class="na">junit_family</span><span class="o">=</span><span class="s">xunit2</span>
</pre></div>
</div>
<p>If you discover that your tooling does not support the new format, and want to keep using the
legacy version, set the option to <code class="docutils literal notranslate"><span class="pre">legacy</span></code> instead:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[pytest]</span>
<span class="na">junit_family</span><span class="o">=</span><span class="s">legacy</span>
</pre></div>
</div>
<p>By using <code class="docutils literal notranslate"><span class="pre">legacy</span></code> you will keep using the legacy/xunit1 format when upgrading to
pytest 6.0, where the default format will be <code class="docutils literal notranslate"><span class="pre">xunit2</span></code>.</p>
<p>In order to let users know about the transition, pytest will issue a warning in case
the <code class="docutils literal notranslate"><span class="pre">--junitxml</span></code> option is given in the command line but <code class="docutils literal notranslate"><span class="pre">junit_family</span></code> is not explicitly
configured in <code class="docutils literal notranslate"><span class="pre">pytest.ini</span></code>.</p>
<p>Services known to support the <code class="docutils literal notranslate"><span class="pre">xunit2</span></code> format:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.jenkins.io/">Jenkins</a> with the <a class="reference external" href="https://plugins.jenkins.io/junit">JUnit</a> plugin.</p></li>
<li><p><a class="reference external" href="https://azure.microsoft.com/en-us/services/devops/pipelines">Azure Pipelines</a>.</p></li>
</ul>
</div>
<div class="section" id="node-construction-changed-to-node-from-parent">
<h3><a class="toc-backref" href="#id13">Node Construction changed to <code class="docutils literal notranslate"><span class="pre">Node.from_parent</span></code></a><a class="headerlink" href="#node-construction-changed-to-node-from-parent" title="Permalink to this headline">¶</a></h3>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 6.0.</span></p>
</div>
<p>The construction of nodes now should use the named constructor <code class="docutils literal notranslate"><span class="pre">from_parent</span></code>.
This limitation in api surface intends to enable better/simpler refactoring of the collection tree.</p>
<p>This means that instead of <code class="code docutils literal notranslate"><span class="pre">MyItem(name=&quot;foo&quot;,</span> <span class="pre">parent=collector,</span> <span class="pre">obj=42)</span></code>
one now has to invoke <code class="code docutils literal notranslate"><span class="pre">MyItem.from_parent(collector,</span> <span class="pre">name=&quot;foo&quot;)</span></code>.</p>
<p>Plugins that wish to support older versions of pytest and suppress the warning can use
<code class="docutils literal notranslate"><span class="pre">hasattr</span></code> to check if <code class="docutils literal notranslate"><span class="pre">from_parent</span></code> exists in that version:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pytest_pycollect_makeitem</span><span class="p">(</span><span class="n">collector</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">MyItem</span><span class="p">,</span> <span class="s2">&quot;from_parent&quot;</span><span class="p">):</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">MyItem</span><span class="o">.</span><span class="n">from_parent</span><span class="p">(</span><span class="n">collector</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span>
        <span class="n">item</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="mi">42</span>
        <span class="k">return</span> <span class="n">item</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">MyItem</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">collector</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">from_parent</span></code> should only be called with keyword arguments for the parameters.</p>
</div>
<div class="section" id="pytest-fixture-arguments-are-keyword-only">
<h3><a class="toc-backref" href="#id14"><code class="docutils literal notranslate"><span class="pre">pytest.fixture</span></code> arguments are keyword only</a><a class="headerlink" href="#pytest-fixture-arguments-are-keyword-only" title="Permalink to this headline">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 6.0.</span></p>
</div>
<p>Passing arguments to pytest.fixture() as positional arguments has been removed - pass them by keyword instead.</p>
</div>
<div class="section" id="funcargnames-alias-for-fixturenames">
<h3><a class="toc-backref" href="#id15"><code class="docutils literal notranslate"><span class="pre">funcargnames</span></code> alias for <code class="docutils literal notranslate"><span class="pre">fixturenames</span></code></a><a class="headerlink" href="#funcargnames-alias-for-fixturenames" title="Permalink to this headline">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 6.0.</span></p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">FixtureRequest</span></code>, <code class="docutils literal notranslate"><span class="pre">Metafunc</span></code>, and <code class="docutils literal notranslate"><span class="pre">Function</span></code> classes track the names of
their associated fixtures, with the aptly-named <code class="docutils literal notranslate"><span class="pre">fixturenames</span></code> attribute.</p>
<p>Prior to pytest 2.3, this attribute was named <code class="docutils literal notranslate"><span class="pre">funcargnames</span></code>, and we have kept
that as an alias since.  It is finally due for removal, as it is often confusing
in places where we or plugin authors must distinguish between fixture names and
names supplied by non-fixture things such as <code class="docutils literal notranslate"><span class="pre">pytest.mark.parametrize</span></code>.</p>
</div>
<div class="section" id="pytest-config-global">
<h3><a class="toc-backref" href="#id16"><code class="docutils literal notranslate"><span class="pre">pytest.config</span></code> global</a><a class="headerlink" href="#pytest-config-global" title="Permalink to this headline">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 5.0.</span></p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">pytest.config</span></code> global object is deprecated.  Instead use
<code class="docutils literal notranslate"><span class="pre">request.config</span></code> (via the <code class="docutils literal notranslate"><span class="pre">request</span></code> fixture) or if you are a plugin author
use the <code class="docutils literal notranslate"><span class="pre">pytest_configure(config)</span></code> hook. Note that many hooks can also access
the <code class="docutils literal notranslate"><span class="pre">config</span></code> object indirectly, through <code class="docutils literal notranslate"><span class="pre">session.config</span></code> or <code class="docutils literal notranslate"><span class="pre">item.config</span></code> for example.</p>
</div>
<div class="section" id="message-parameter-of-pytest-raises">
<span id="raises-message-deprecated"></span><h3><a class="toc-backref" href="#id17"><code class="docutils literal notranslate"><span class="pre">&quot;message&quot;</span></code> parameter of <code class="docutils literal notranslate"><span class="pre">pytest.raises</span></code></a><a class="headerlink" href="#message-parameter-of-pytest-raises" title="Permalink to this headline">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 5.0.</span></p>
</div>
<p>It is a common mistake to think this parameter will match the exception message, while in fact
it only serves to provide a custom message in case the <code class="docutils literal notranslate"><span class="pre">pytest.raises</span></code> check fails. To prevent
users from making this mistake, and because it is believed to be little used, pytest is
deprecating it without providing an alternative for the moment.</p>
<p>If you have a valid use case for this parameter, consider that to obtain the same results
you can just call <code class="docutils literal notranslate"><span class="pre">pytest.fail</span></code> manually at the end of the <code class="docutils literal notranslate"><span class="pre">with</span></code> statement.</p>
<p>For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">TimeoutError</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Client got unexpected message&quot;</span><span class="p">):</span>
    <span class="n">wait_for</span><span class="p">(</span><span class="n">websocket</span><span class="o">.</span><span class="n">recv</span><span class="p">(),</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
<p>Becomes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">TimeoutError</span><span class="p">):</span>
    <span class="n">wait_for</span><span class="p">(</span><span class="n">websocket</span><span class="o">.</span><span class="n">recv</span><span class="p">(),</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">pytest</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s2">&quot;Client got unexpected message&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If you still have concerns about this deprecation and future removal, please comment on
<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/3974">issue #3974</a>.</p>
</div>
<div class="section" id="raises-warns-with-a-string-as-the-second-argument">
<span id="raises-warns-exec"></span><h3><a class="toc-backref" href="#id18"><code class="docutils literal notranslate"><span class="pre">raises</span></code> / <code class="docutils literal notranslate"><span class="pre">warns</span></code> with a string as the second argument</a><a class="headerlink" href="#raises-warns-with-a-string-as-the-second-argument" title="Permalink to this headline">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 5.0.</span></p>
</div>
<p>Use the context manager form of these instead.  When necessary, invoke <code class="docutils literal notranslate"><span class="pre">exec</span></code>
directly.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ZeroDivisionError</span><span class="p">,</span> <span class="s2">&quot;1 / 0&quot;</span><span class="p">)</span>
<span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">SyntaxError</span><span class="p">,</span> <span class="s2">&quot;a $ b&quot;</span><span class="p">)</span>

<span class="n">pytest</span><span class="o">.</span><span class="n">warns</span><span class="p">(</span><span class="ne">DeprecationWarning</span><span class="p">,</span> <span class="s2">&quot;my_function()&quot;</span><span class="p">)</span>
<span class="n">pytest</span><span class="o">.</span><span class="n">warns</span><span class="p">(</span><span class="ne">SyntaxWarning</span><span class="p">,</span> <span class="s2">&quot;assert(1, 2)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Becomes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ZeroDivisionError</span><span class="p">):</span>
    <span class="mi">1</span> <span class="o">/</span> <span class="mi">0</span>
<span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">SyntaxError</span><span class="p">):</span>
    <span class="n">exec</span><span class="p">(</span><span class="s2">&quot;a $ b&quot;</span><span class="p">)</span>  <span class="c1"># exec is required for invalid syntax</span>

<span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">warns</span><span class="p">(</span><span class="ne">DeprecationWarning</span><span class="p">):</span>
    <span class="n">my_function</span><span class="p">()</span>
<span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">warns</span><span class="p">(</span><span class="ne">SyntaxWarning</span><span class="p">):</span>
    <span class="n">exec</span><span class="p">(</span><span class="s2">&quot;assert(1, 2)&quot;</span><span class="p">)</span>  <span class="c1"># exec is used to avoid a top-level warning</span>
</pre></div>
</div>
</div>
<div class="section" id="using-class-in-custom-collectors">
<h3><a class="toc-backref" href="#id19">Using <code class="docutils literal notranslate"><span class="pre">Class</span></code> in custom Collectors</a><a class="headerlink" href="#using-class-in-custom-collectors" title="Permalink to this headline">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p>Using objects named <code class="docutils literal notranslate"><span class="pre">&quot;Class&quot;</span></code> as a way to customize the type of nodes that are collected in <code class="docutils literal notranslate"><span class="pre">Collector</span></code>
subclasses has been deprecated. Users instead should use <code class="docutils literal notranslate"><span class="pre">pytest_pycollect_makeitem</span></code> to customize node types during
collection.</p>
<p>This issue should affect only advanced plugins who create new collection types, so if you see this warning
message please contact the authors so they can change the code.</p>
</div>
<div class="section" id="marks-in-pytest-mark-parametrize">
<h3><a class="toc-backref" href="#id20">marks in <code class="docutils literal notranslate"><span class="pre">pytest.mark.parametrize</span></code></a><a class="headerlink" href="#marks-in-pytest-mark-parametrize" title="Permalink to this headline">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p>Applying marks to values of a <code class="docutils literal notranslate"><span class="pre">pytest.mark.parametrize</span></code> call is now deprecated. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span>
    <span class="s2">&quot;a, b&quot;</span><span class="p">,</span>
    <span class="p">[</span>
        <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
        <span class="n">pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">xfail</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="s2">&quot;flaky&quot;</span><span class="p">)(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">36</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">400</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">500</span><span class="p">),</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">test_foo</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>This code applies the <code class="docutils literal notranslate"><span class="pre">pytest.mark.xfail(reason=&quot;flaky&quot;)</span></code> mark to the <code class="docutils literal notranslate"><span class="pre">(6,</span> <span class="pre">36)</span></code> value of the above parametrization
call.</p>
<p>This was considered hard to read and understand, and also its implementation presented problems to the code preventing
further internal improvements in the marks architecture.</p>
<p>To update the code, use <code class="docutils literal notranslate"><span class="pre">pytest.param</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span>
    <span class="s2">&quot;a, b&quot;</span><span class="p">,</span>
    <span class="p">[</span>
        <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
        <span class="n">pytest</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="n">marks</span><span class="o">=</span><span class="n">pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">xfail</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="s2">&quot;flaky&quot;</span><span class="p">)),</span>
        <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">400</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">500</span><span class="p">),</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">test_foo</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
</div>
<div class="section" id="pytest-funcarg-prefix">
<h3><a class="toc-backref" href="#id21"><code class="docutils literal notranslate"><span class="pre">pytest_funcarg__</span></code> prefix</a><a class="headerlink" href="#pytest-funcarg-prefix" title="Permalink to this headline">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p>In very early pytest versions fixtures could be defined using the <code class="docutils literal notranslate"><span class="pre">pytest_funcarg__</span></code> prefix:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pytest_funcarg__data</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">SomeData</span><span class="p">()</span>
</pre></div>
</div>
<p>Switch over to the <code class="docutils literal notranslate"><span class="pre">&#64;pytest.fixture</span></code> decorator:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span> <span class="nf">data</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">SomeData</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="pytest-section-in-setup-cfg-files">
<h3><a class="toc-backref" href="#id22">[pytest] section in setup.cfg files</a><a class="headerlink" href="#pytest-section-in-setup-cfg-files" title="Permalink to this headline">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">[pytest]</span></code> sections in <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code> files should now be named <code class="docutils literal notranslate"><span class="pre">[tool:pytest]</span></code>
to avoid conflicts with other distutils commands.</p>
</div>
<div class="section" id="metafunc-addcall">
<h3><a class="toc-backref" href="#id23">Metafunc.addcall</a><a class="headerlink" href="#metafunc-addcall" title="Permalink to this headline">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">_pytest.python.Metafunc.addcall</span></code> was a precursor to the current parametrized mechanism. Users should use
<a class="reference internal" href="reference.html#pytest.python.Metafunc.parametrize" title="_pytest.python.Metafunc.parametrize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_pytest.python.Metafunc.parametrize()</span></code></a> instead.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pytest_generate_tests</span><span class="p">(</span><span class="n">metafunc</span><span class="p">):</span>
    <span class="n">metafunc</span><span class="o">.</span><span class="n">addcall</span><span class="p">({</span><span class="s2">&quot;i&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
    <span class="n">metafunc</span><span class="o">.</span><span class="n">addcall</span><span class="p">({</span><span class="s2">&quot;i&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;2&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Becomes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pytest_generate_tests</span><span class="p">(</span><span class="n">metafunc</span><span class="p">):</span>
    <span class="n">metafunc</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span><span class="s2">&quot;i&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">ids</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="cached-setup">
<h3><a class="toc-backref" href="#id24"><code class="docutils literal notranslate"><span class="pre">cached_setup</span></code></a><a class="headerlink" href="#cached-setup" title="Permalink to this headline">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">request.cached_setup</span></code> was the precursor of the setup/teardown mechanism available to fixtures.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span> <span class="nf">db_session</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">request</span><span class="o">.</span><span class="n">cached_setup</span><span class="p">(</span>
        <span class="n">setup</span><span class="o">=</span><span class="n">Session</span><span class="o">.</span><span class="n">create</span><span class="p">,</span> <span class="n">teardown</span><span class="o">=</span><span class="k">lambda</span> <span class="n">session</span><span class="p">:</span> <span class="n">session</span><span class="o">.</span><span class="n">close</span><span class="p">(),</span> <span class="n">scope</span><span class="o">=</span><span class="s2">&quot;module&quot;</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>This should be updated to make use of standard fixture mechanisms:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">&quot;module&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">db_session</span><span class="p">():</span>
    <span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
    <span class="k">yield</span> <span class="n">session</span>
    <span class="n">session</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>You can consult <a class="reference external" href="https://docs.pytest.org/en/stable/funcarg_compare.html">funcarg comparison section in the docs</a> for
more information.</p>
</div>
<div class="section" id="pytest-plugins-in-non-top-level-conftest-files">
<h3><a class="toc-backref" href="#id25">pytest_plugins in non-top-level conftest files</a><a class="headerlink" href="#pytest-plugins-in-non-top-level-conftest-files" title="Permalink to this headline">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p>Defining <a class="reference internal" href="reference.html#globalvar-pytest_plugins"><code class="xref std std-globalvar docutils literal notranslate"><span class="pre">pytest_plugins</span></code></a> is now deprecated in non-top-level conftest.py
files because they will activate referenced plugins <em>globally</em>, which is surprising because for all other pytest
features <code class="docutils literal notranslate"><span class="pre">conftest.py</span></code> files are only <em>active</em> for tests at or below it.</p>
</div>
<div class="section" id="config-warn-and-node-warn">
<h3><a class="toc-backref" href="#id26"><code class="docutils literal notranslate"><span class="pre">Config.warn</span></code> and <code class="docutils literal notranslate"><span class="pre">Node.warn</span></code></a><a class="headerlink" href="#config-warn-and-node-warn" title="Permalink to this headline">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p>Those methods were part of the internal pytest warnings system, but since <code class="docutils literal notranslate"><span class="pre">3.8</span></code> pytest is using the builtin warning
system for its own warnings, so those two functions are now deprecated.</p>
<p><code class="docutils literal notranslate"><span class="pre">Config.warn</span></code> should be replaced by calls to the standard <code class="docutils literal notranslate"><span class="pre">warnings.warn</span></code>, example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">config</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="s2">&quot;some warning&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Becomes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">pytest</span><span class="o">.</span><span class="n">PytestWarning</span><span class="p">(</span><span class="s2">&quot;some warning&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Node.warn</span></code> now supports two signatures:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">node.warn(PytestWarning(&quot;some</span> <span class="pre">message&quot;))</span></code>: is now the <strong>recommended</strong> way to call this function.
The warning instance must be a PytestWarning or subclass.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">node.warn(&quot;CI&quot;,</span> <span class="pre">&quot;some</span> <span class="pre">message&quot;)</span></code>: this code/message form has been <strong>removed</strong> and should be converted to the warning instance form above.</p></li>
</ul>
</div>
<div class="section" id="record-xml-property">
<h3><a class="toc-backref" href="#id27">record_xml_property</a><a class="headerlink" href="#record-xml-property" title="Permalink to this headline">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">record_xml_property</span></code> fixture is now deprecated in favor of the more generic <code class="docutils literal notranslate"><span class="pre">record_property</span></code>, which
can be used by other consumers (for example <code class="docutils literal notranslate"><span class="pre">pytest-html</span></code>) to obtain custom information about the test run.</p>
<p>This is just a matter of renaming the fixture as the API is the same:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_foo</span><span class="p">(</span><span class="n">record_xml_property</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>Change to:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_foo</span><span class="p">(</span><span class="n">record_property</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
</div>
<div class="section" id="passing-command-line-string-to-pytest-main">
<h3><a class="toc-backref" href="#id28">Passing command-line string to <code class="docutils literal notranslate"><span class="pre">pytest.main()</span></code></a><a class="headerlink" href="#passing-command-line-string-to-pytest-main" title="Permalink to this headline">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p>Passing a command-line string to <code class="docutils literal notranslate"><span class="pre">pytest.main()</span></code> is deprecated:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pytest</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="s2">&quot;-v -s&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Pass a list instead:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pytest</span><span class="o">.</span><span class="n">main</span><span class="p">([</span><span class="s2">&quot;-v&quot;</span><span class="p">,</span> <span class="s2">&quot;-s&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>By passing a string, users expect that pytest will interpret that command-line using the shell rules they are working
on (for example <code class="docutils literal notranslate"><span class="pre">bash</span></code> or <code class="docutils literal notranslate"><span class="pre">Powershell</span></code>), but this is very hard/impossible to do in a portable way.</p>
</div>
<div class="section" id="calling-fixtures-directly">
<h3><a class="toc-backref" href="#id29">Calling fixtures directly</a><a class="headerlink" href="#calling-fixtures-directly" title="Permalink to this headline">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p>Calling a fixture function directly, as opposed to request them in a test function, is deprecated.</p>
<p>For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span> <span class="nf">cell</span><span class="p">():</span>
    <span class="k">return</span> <span class="o">...</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span> <span class="nf">full_cell</span><span class="p">():</span>
    <span class="n">cell</span> <span class="o">=</span> <span class="n">cell</span><span class="p">()</span>
    <span class="n">cell</span><span class="o">.</span><span class="n">make_full</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">cell</span>
</pre></div>
</div>
<p>This is a great source of confusion to new users, which will often call the fixture functions and request them from test functions interchangeably, which breaks the fixture resolution model.</p>
<p>In those cases just request the function directly in the dependent fixture:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span> <span class="nf">cell</span><span class="p">():</span>
    <span class="k">return</span> <span class="o">...</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span> <span class="nf">full_cell</span><span class="p">(</span><span class="n">cell</span><span class="p">):</span>
    <span class="n">cell</span><span class="o">.</span><span class="n">make_full</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">cell</span>
</pre></div>
</div>
<p>Alternatively if the fixture function is called multiple times inside a test (making it hard to apply the above pattern) or
if you would like to make minimal changes to the code, you can create a fixture which calls the original function together
with the <code class="docutils literal notranslate"><span class="pre">name</span></code> parameter:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cell</span><span class="p">():</span>
    <span class="k">return</span> <span class="o">...</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;cell&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">cell_fixture</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">cell</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="yield-tests">
<h3><a class="toc-backref" href="#id30"><code class="docutils literal notranslate"><span class="pre">yield</span></code> tests</a><a class="headerlink" href="#yield-tests" title="Permalink to this headline">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p>pytest supported <code class="docutils literal notranslate"><span class="pre">yield</span></code>-style tests, where a test function actually <code class="docutils literal notranslate"><span class="pre">yield</span></code> functions and values
that are then turned into proper test methods. Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">x</span> <span class="o">**</span> <span class="n">x</span> <span class="o">==</span> <span class="n">y</span>


<span class="k">def</span> <span class="nf">test_squared</span><span class="p">():</span>
    <span class="k">yield</span> <span class="n">check</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span>
    <span class="k">yield</span> <span class="n">check</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span>
</pre></div>
</div>
<p>This would result into two actual test functions being generated.</p>
<p>This form of test function doesn’t support fixtures properly, and users should switch to <code class="docutils literal notranslate"><span class="pre">pytest.mark.parametrize</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span><span class="s2">&quot;x, y&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">)])</span>
<span class="k">def</span> <span class="nf">test_squared</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">x</span> <span class="o">**</span> <span class="n">x</span> <span class="o">==</span> <span class="n">y</span>
</pre></div>
</div>
</div>
<div class="section" id="internal-classes-accessed-through-node">
<h3><a class="toc-backref" href="#id31">Internal classes accessed through <code class="docutils literal notranslate"><span class="pre">Node</span></code></a><a class="headerlink" href="#internal-classes-accessed-through-node" title="Permalink to this headline">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p>Access of <code class="docutils literal notranslate"><span class="pre">Module</span></code>, <code class="docutils literal notranslate"><span class="pre">Function</span></code>, <code class="docutils literal notranslate"><span class="pre">Class</span></code>, <code class="docutils literal notranslate"><span class="pre">Instance</span></code>, <code class="docutils literal notranslate"><span class="pre">File</span></code> and <code class="docutils literal notranslate"><span class="pre">Item</span></code> through <code class="docutils literal notranslate"><span class="pre">Node</span></code> instances now issue
this warning:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>usage of Function.Module is deprecated, please use pytest.Module instead
</pre></div>
</div>
<p>Users should just <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">pytest</span></code> and access those objects using the <code class="docutils literal notranslate"><span class="pre">pytest</span></code> module.</p>
<p>This has been documented as deprecated for years, but only now we are actually emitting deprecation warnings.</p>
</div>
<div class="section" id="node-get-marker">
<h3><a class="toc-backref" href="#id32"><code class="docutils literal notranslate"><span class="pre">Node.get_marker</span></code></a><a class="headerlink" href="#node-get-marker" title="Permalink to this headline">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p>As part of a large <a class="reference internal" href="historical-notes.html#marker-revamp"><span class="std std-ref">Marker revamp and iteration</span></a>, <code class="docutils literal notranslate"><span class="pre">_pytest.nodes.Node.get_marker</span></code> is removed. See
<a class="reference internal" href="historical-notes.html#update-marker-code"><span class="std std-ref">the documentation</span></a> on tips on how to update your code.</p>
</div>
<div class="section" id="somefunction-markname">
<h3><a class="toc-backref" href="#id33"><code class="docutils literal notranslate"><span class="pre">somefunction.markname</span></code></a><a class="headerlink" href="#somefunction-markname" title="Permalink to this headline">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p>As part of a large <a class="reference internal" href="historical-notes.html#marker-revamp"><span class="std std-ref">Marker revamp and iteration</span></a> we already deprecated using <code class="docutils literal notranslate"><span class="pre">MarkInfo</span></code>
the only correct way to get markers of an element is via <code class="docutils literal notranslate"><span class="pre">node.iter_markers(name)</span></code>.</p>
</div>
<div class="section" id="pytest-namespace">
<h3><a class="toc-backref" href="#id34"><code class="docutils literal notranslate"><span class="pre">pytest_namespace</span></code></a><a class="headerlink" href="#pytest-namespace" title="Permalink to this headline">¶</a></h3>
<div class="versionremoved">
<p><span class="versionmodified removed">Removed in version 4.0.</span></p>
</div>
<p>This hook is deprecated because it greatly complicates the pytest internals regarding configuration and initialization, making some
bug fixes and refactorings impossible.</p>
<p>Example of usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MySymbol</span><span class="p">:</span>
    <span class="o">...</span>


<span class="k">def</span> <span class="nf">pytest_namespace</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;my_symbol&quot;</span><span class="p">:</span> <span class="n">MySymbol</span><span class="p">()}</span>
</pre></div>
</div>
<p>Plugin authors relying on this hook should instead require that users now import the plugin modules directly (with an appropriate public API).</p>
<p>As a stopgap measure, plugin authors may still inject their names into pytest’s namespace, usually during <code class="docutils literal notranslate"><span class="pre">pytest_configure</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pytest</span>


<span class="k">def</span> <span class="nf">pytest_configure</span><span class="p">():</span>
    <span class="n">pytest</span><span class="o">.</span><span class="n">my_symbol</span> <span class="o">=</span> <span class="n">MySymbol</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
      </div>
  <span id="sidebar-top"></span>
      <div class="clearer"></div>
    </div>
  
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015–2020, holger krekel and pytest-dev team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.5.4.
    </div>
  <script src="_static/version_warning_offset.js"></script>

  </body>
</html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="IE=Edge" http-equiv="X-UA-Compatible"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Server Reference — aiohttp 3.4.4 documentation</title>
<link href="_static/aiohttp.css" rel="stylesheet" type="text/css"/>
<link href="_static/pygments.css" rel="stylesheet" type="text/css"/>
<script data-url_root="./" id="documentation_options" src="_static/documentation_options.js" type="text/javascript"></script>
<script src="_static/jquery.js" type="text/javascript"></script>
<script src="_static/underscore.js" type="text/javascript"></script>
<script src="_static/doctools.js" type="text/javascript"></script>
<link href="_static/favicon.ico" rel="shortcut icon"/>
<link href="genindex.html" rel="index" title="Index"/>
<link href="search.html" rel="search" title="Search"/>
<link href="logging.html" rel="next" title="Logging"/>
<link href="web_lowlevel.html" rel="prev" title="Low Level Server"/>
<link href="_static/custom.css" rel="stylesheet" type="text/css"/>
<link href="http://docs.aiohttp.org/en/stable/web_reference.html" rel="canonical"/>
<meta content="width=device-width, initial-scale=0.9, maximum-scale=0.9" name="viewport"/>
<link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet"/>
</head><body>
<div class="document">
<div class="documentwrapper">
<div class="body" role="main">
<div class="section" id="module-aiohttp.web">
<span id="server-reference"></span><span id="aiohttp-web-reference"></span><h1><a name="//apple_ref/cpp/Module/aiohttp.web"></a>Server Reference<a class="headerlink" href="#module-aiohttp.web" title="Permalink to this headline">¶</a></h1>
<div class="section" id="request-and-base-request">
<span id="aiohttp-web-request"></span><h2>Request and Base Request<a class="headerlink" href="#request-and-base-request" title="Permalink to this headline">¶</a></h2>
<p>The Request object contains all the information about an incoming HTTP request.</p>
<p><a class="reference internal" href="#aiohttp.web.BaseRequest" title="aiohttp.web.BaseRequest"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseRequest</span></code></a> is used for <a class="reference internal" href="web_lowlevel.html#aiohttp-web-lowlevel"><span class="std std-ref">Low-Level
Servers</span></a> (which have no applications, routers,
signals and middlewares). <a class="reference internal" href="#aiohttp.web.Request" title="aiohttp.web.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">Request</span></code></a> has an <a class="reference internal" href="#aiohttp.web.Request.app" title="aiohttp.web.Request.app"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Request.app</span></code></a>
and <a class="reference internal" href="#aiohttp.web.Request.match_info" title="aiohttp.web.Request.match_info"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Request.match_info</span></code></a> attributes.</p>
<p>A <a class="reference internal" href="#aiohttp.web.BaseRequest" title="aiohttp.web.BaseRequest"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseRequest</span></code></a> / <a class="reference internal" href="#aiohttp.web.Request" title="aiohttp.web.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">Request</span></code></a> are <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a> like objects,
allowing them to be used for <a class="reference internal" href="web_advanced.html#aiohttp-web-data-sharing"><span class="std std-ref">sharing
data</span></a> among <a class="reference internal" href="web_advanced.html#aiohttp-web-middlewares"><span class="std std-ref">Middlewares</span></a>
and <a class="reference internal" href="web_advanced.html#aiohttp-web-signals"><span class="std std-ref">Signals</span></a> handlers.</p>
<dl class="class">
<dt id="aiohttp.web.BaseRequest"><a name="//apple_ref/cpp/Class/aiohttp.web.BaseRequest"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">BaseRequest</code><a class="headerlink" href="#aiohttp.web.BaseRequest" title="Permalink to this definition">¶</a></dt>
<dd><dl class="attribute">
<dt id="aiohttp.web.BaseRequest.version"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.version"></a>
<code class="descname">version</code><a class="headerlink" href="#aiohttp.web.BaseRequest.version" title="Permalink to this definition">¶</a></dt>
<dd><p><em>HTTP version</em> of request, Read-only property.</p>
<p>Returns <code class="xref py py-class docutils literal notranslate"><span class="pre">aiohttp.protocol.HttpVersion</span></code> instance.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.method"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.method"></a>
<code class="descname">method</code><a class="headerlink" href="#aiohttp.web.BaseRequest.method" title="Permalink to this definition">¶</a></dt>
<dd><p><em>HTTP method</em>, read-only property.</p>
<p>The value is upper-cased <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> like <code class="docutils literal notranslate"><span class="pre">"GET"</span></code>,
<code class="docutils literal notranslate"><span class="pre">"POST"</span></code>, <code class="docutils literal notranslate"><span class="pre">"PUT"</span></code> etc.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.url"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.url"></a>
<code class="descname">url</code><a class="headerlink" href="#aiohttp.web.BaseRequest.url" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://yarl.readthedocs.io/en/stable/api.html#yarl.URL" title="(in yarl v1.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">URL</span></code></a> instance with absolute URL to resource
(<em>scheme</em>, <em>host</em> and <em>port</em> are included).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In case of malformed request (e.g. without <code class="docutils literal notranslate"><span class="pre">"HOST"</span></code> HTTP
header) the absolute url may be unavailable.</p>
</div>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.rel_url"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.rel_url"></a>
<code class="descname">rel_url</code><a class="headerlink" href="#aiohttp.web.BaseRequest.rel_url" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://yarl.readthedocs.io/en/stable/api.html#yarl.URL" title="(in yarl v1.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">URL</span></code></a> instance with relative URL to resource
(contains <em>path</em>, <em>query</em> and <em>fragment</em> parts only, <em>scheme</em>,
<em>host</em> and <em>port</em> are excluded).</p>
<p>The property is equal to <code class="docutils literal notranslate"><span class="pre">.url.relative()</span></code> but is always present.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">A note from <a class="reference internal" href="#aiohttp.web.BaseRequest.url" title="aiohttp.web.BaseRequest.url"><code class="xref py py-attr docutils literal notranslate"><span class="pre">url</span></code></a>.</p>
</div>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.scheme"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.scheme"></a>
<code class="descname">scheme</code><a class="headerlink" href="#aiohttp.web.BaseRequest.scheme" title="Permalink to this definition">¶</a></dt>
<dd><p>A string representing the scheme of the request.</p>
<p>The scheme is <code class="docutils literal notranslate"><span class="pre">'https'</span></code> if transport for request handling is
<em>SSL</em>, <code class="docutils literal notranslate"><span class="pre">'http'</span></code> otherwise.</p>
<p>The value could be overridden by <a class="reference internal" href="#aiohttp.web.BaseRequest.clone" title="aiohttp.web.BaseRequest.clone"><code class="xref py py-meth docutils literal notranslate"><span class="pre">clone()</span></code></a>.</p>
<p>Read-only <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> property.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 2.3: </span><em>Forwarded</em> and <em>X-Forwarded-Proto</em> are not used anymore.</p>
<p>Call <code class="docutils literal notranslate"><span class="pre">.clone(scheme=new_scheme)</span></code> for setting up the value
explicitly.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="web_advanced.html#aiohttp-web-forwarded-support"><span class="std std-ref">Deploying behind a Proxy</span></a></p>
</div>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.secure"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.secure"></a>
<code class="descname">secure</code><a class="headerlink" href="#aiohttp.web.BaseRequest.secure" title="Permalink to this definition">¶</a></dt>
<dd><p>Shorthand for <code class="docutils literal notranslate"><span class="pre">request.url.scheme</span> <span class="pre">==</span> <span class="pre">'https'</span></code></p>
<p>Read-only <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a> property.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#aiohttp.web.BaseRequest.scheme" title="aiohttp.web.BaseRequest.scheme"><code class="xref py py-attr docutils literal notranslate"><span class="pre">scheme</span></code></a></p>
</div>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.forwarded"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.forwarded"></a>
<code class="descname">forwarded</code><a class="headerlink" href="#aiohttp.web.BaseRequest.forwarded" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple containing all parsed Forwarded header(s).</p>
<p>Makes an effort to parse Forwarded headers as specified by <span class="target" id="index-0"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc7239.html"><strong>RFC 7239</strong></a>:</p>
<ul class="simple">
<li>It adds one (immutable) dictionary per Forwarded <code class="docutils literal notranslate"><span class="pre">field-value</span></code>, i.e.
per proxy. The element corresponds to the data in the Forwarded
<code class="docutils literal notranslate"><span class="pre">field-value</span></code> added by the first proxy encountered by the client.
Each subsequent item corresponds to those added by later proxies.</li>
<li>It checks that every value has valid syntax in general as specified
in <span class="target" id="index-1"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc7239.html#section-4"><strong>RFC 7239#section-4</strong></a>: either a <code class="docutils literal notranslate"><span class="pre">token</span></code> or a <code class="docutils literal notranslate"><span class="pre">quoted-string</span></code>.</li>
<li>It un-escapes <code class="docutils literal notranslate"><span class="pre">quoted-pairs</span></code>.</li>
<li>It does NOT validate ‘by’ and ‘for’ contents as specified in
<span class="target" id="index-2"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc7239.html#section-6"><strong>RFC 7239#section-6</strong></a>.</li>
<li>It does NOT validate <code class="docutils literal notranslate"><span class="pre">host</span></code> contents (Host ABNF).</li>
<li>It does NOT validate <code class="docutils literal notranslate"><span class="pre">proto</span></code> contents for valid URI scheme names.</li>
</ul>
<p>Returns a tuple containing one or more <code class="docutils literal notranslate"><span class="pre">MappingProxy</span></code> objects</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#aiohttp.web.BaseRequest.scheme" title="aiohttp.web.BaseRequest.scheme"><code class="xref py py-attr docutils literal notranslate"><span class="pre">scheme</span></code></a></p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#aiohttp.web.BaseRequest.host" title="aiohttp.web.BaseRequest.host"><code class="xref py py-attr docutils literal notranslate"><span class="pre">host</span></code></a></p>
</div>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.host"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.host"></a>
<code class="descname">host</code><a class="headerlink" href="#aiohttp.web.BaseRequest.host" title="Permalink to this definition">¶</a></dt>
<dd><p>Host name of the request, resolved in this order:</p>
<ul class="simple">
<li>Overridden value by <a class="reference internal" href="#aiohttp.web.BaseRequest.clone" title="aiohttp.web.BaseRequest.clone"><code class="xref py py-meth docutils literal notranslate"><span class="pre">clone()</span></code></a> call.</li>
<li><em>Host</em> HTTP header</li>
<li><code class="xref py py-func docutils literal notranslate"><span class="pre">socket.gtfqdn()</span></code></li>
</ul>
<p>Read-only <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> property.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 2.3: </span><em>Forwarded</em> and <em>X-Forwarded-Host</em> are not used anymore.</p>
<p>Call <code class="docutils literal notranslate"><span class="pre">.clone(host=new_host)</span></code> for setting up the value
explicitly.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="web_advanced.html#aiohttp-web-forwarded-support"><span class="std std-ref">Deploying behind a Proxy</span></a></p>
</div>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.remote"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.remote"></a>
<code class="descname">remote</code><a class="headerlink" href="#aiohttp.web.BaseRequest.remote" title="Permalink to this definition">¶</a></dt>
<dd><p>Originating IP address of a client initiated HTTP request.</p>
<p>The IP is resolved through the following headers, in this order:</p>
<ul class="simple">
<li>Overridden value by <a class="reference internal" href="#aiohttp.web.BaseRequest.clone" title="aiohttp.web.BaseRequest.clone"><code class="xref py py-meth docutils literal notranslate"><span class="pre">clone()</span></code></a> call.</li>
<li>Peer name of opened socket.</li>
</ul>
<p>Read-only <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> property.</p>
<p>Call <code class="docutils literal notranslate"><span class="pre">.clone(remote=new_remote)</span></code> for setting up the value
explicitly.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.3.</span></p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="web_advanced.html#aiohttp-web-forwarded-support"><span class="std std-ref">Deploying behind a Proxy</span></a></p>
</div>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.path_qs"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.path_qs"></a>
<code class="descname">path_qs</code><a class="headerlink" href="#aiohttp.web.BaseRequest.path_qs" title="Permalink to this definition">¶</a></dt>
<dd><p>The URL including PATH_INFO and the query string. e.g.,
<code class="docutils literal notranslate"><span class="pre">/app/blog?id=10</span></code></p>
<p>Read-only <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> property.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.path"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.path"></a>
<code class="descname">path</code><a class="headerlink" href="#aiohttp.web.BaseRequest.path" title="Permalink to this definition">¶</a></dt>
<dd><p>The URL including <em>PATH INFO</em> without the host or scheme. e.g.,
<code class="docutils literal notranslate"><span class="pre">/app/blog</span></code>. The path is URL-unquoted. For raw path info see
<a class="reference internal" href="#aiohttp.web.BaseRequest.raw_path" title="aiohttp.web.BaseRequest.raw_path"><code class="xref py py-attr docutils literal notranslate"><span class="pre">raw_path</span></code></a>.</p>
<p>Read-only <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> property.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.raw_path"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.raw_path"></a>
<code class="descname">raw_path</code><a class="headerlink" href="#aiohttp.web.BaseRequest.raw_path" title="Permalink to this definition">¶</a></dt>
<dd><p>The URL including raw <em>PATH INFO</em> without the host or scheme.
Warning, the path may be quoted and may contains non valid URL
characters, e.g.
<code class="docutils literal notranslate"><span class="pre">/my%2Fpath%7Cwith%21some%25strange%24characters</span></code>.</p>
<p>For unquoted version please take a look on <a class="reference internal" href="#aiohttp.web.BaseRequest.path" title="aiohttp.web.BaseRequest.path"><code class="xref py py-attr docutils literal notranslate"><span class="pre">path</span></code></a>.</p>
<p>Read-only <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> property.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.query"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.query"></a>
<code class="descname">query</code><a class="headerlink" href="#aiohttp.web.BaseRequest.query" title="Permalink to this definition">¶</a></dt>
<dd><p>A multidict with all the variables in the query string.</p>
<p>Read-only <a class="reference external" href="https://multidict.readthedocs.io/en/stable/multidict.html#multidict.MultiDictProxy" title="(in multidict v4.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiDictProxy</span></code></a> lazy property.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.query_string"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.query_string"></a>
<code class="descname">query_string</code><a class="headerlink" href="#aiohttp.web.BaseRequest.query_string" title="Permalink to this definition">¶</a></dt>
<dd><p>The query string in the URL, e.g., <code class="docutils literal notranslate"><span class="pre">id=10</span></code></p>
<p>Read-only <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> property.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.headers"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.headers"></a>
<code class="descname">headers</code><a class="headerlink" href="#aiohttp.web.BaseRequest.headers" title="Permalink to this definition">¶</a></dt>
<dd><p>A case-insensitive multidict proxy with all headers.</p>
<p>Read-only <a class="reference external" href="https://multidict.readthedocs.io/en/stable/multidict.html#multidict.CIMultiDictProxy" title="(in multidict v4.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">CIMultiDictProxy</span></code></a> property.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.raw_headers"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.raw_headers"></a>
<code class="descname">raw_headers</code><a class="headerlink" href="#aiohttp.web.BaseRequest.raw_headers" title="Permalink to this definition">¶</a></dt>
<dd><p>HTTP headers of response as unconverted bytes, a sequence of
<code class="docutils literal notranslate"><span class="pre">(key,</span> <span class="pre">value)</span></code> pairs.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.keep_alive"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.keep_alive"></a>
<code class="descname">keep_alive</code><a class="headerlink" href="#aiohttp.web.BaseRequest.keep_alive" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if keep-alive connection enabled by HTTP client and
protocol version supports it, otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p>Read-only <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a> property.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.transport"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.transport"></a>
<code class="descname">transport</code><a class="headerlink" href="#aiohttp.web.BaseRequest.transport" title="Permalink to this definition">¶</a></dt>
<dd><p>An <a class="reference external" href="https://docs.python.org/3/library/asyncio-protocol.html#asyncio-transport" title="(in Python v3.7)"><span class="xref std std-ref">transport</span></a> used to process request,
Read-only property.</p>
<p>The property can be used, for example, for getting IP address of
client’s peer:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">peername</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">get_extra_info</span><span class="p">(</span><span class="s1">'peername'</span><span class="p">)</span>
<span class="k">if</span> <span class="n">peername</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">host</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="n">peername</span>
</pre></div>
</div>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.loop"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.loop"></a>
<code class="descname">loop</code><a class="headerlink" href="#aiohttp.web.BaseRequest.loop" title="Permalink to this definition">¶</a></dt>
<dd><p>An event loop instance used by HTTP request handling.</p>
<p>Read-only <a class="reference external" href="https://docs.python.org/3/library/asyncio-eventloop.html#asyncio.AbstractEventLoop" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.AbstractEventLoop</span></code></a> property.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.3.</span></p>
</div>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.cookies"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.cookies"></a>
<code class="descname">cookies</code><a class="headerlink" href="#aiohttp.web.BaseRequest.cookies" title="Permalink to this definition">¶</a></dt>
<dd><p>A multidict of all request’s cookies.</p>
<p>Read-only <a class="reference external" href="https://multidict.readthedocs.io/en/stable/multidict.html#multidict.MultiDictProxy" title="(in multidict v4.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiDictProxy</span></code></a> lazy property.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.content"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.content"></a>
<code class="descname">content</code><a class="headerlink" href="#aiohttp.web.BaseRequest.content" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="streams.html#aiohttp.StreamReader" title="aiohttp.StreamReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamReader</span></code></a> instance,
input stream for reading request’s <em>BODY</em>.</p>
<p>Read-only property.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.body_exists"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.body_exists"></a>
<code class="descname">body_exists</code><a class="headerlink" href="#aiohttp.web.BaseRequest.body_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if request has <em>HTTP BODY</em>, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>Read-only <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a> property.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.3.</span></p>
</div>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.can_read_body"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.can_read_body"></a>
<code class="descname">can_read_body</code><a class="headerlink" href="#aiohttp.web.BaseRequest.can_read_body" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if request’s <em>HTTP BODY</em> can be read, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>Read-only <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a> property.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.3.</span></p>
</div>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.has_body"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.has_body"></a>
<code class="descname">has_body</code><a class="headerlink" href="#aiohttp.web.BaseRequest.has_body" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if request’s <em>HTTP BODY</em> can be read, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>Read-only <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a> property.</p>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 2.3: </span>Use <a class="reference internal" href="#aiohttp.web.BaseRequest.can_read_body" title="aiohttp.web.BaseRequest.can_read_body"><code class="xref py py-meth docutils literal notranslate"><span class="pre">can_read_body()</span></code></a> instead.</p>
</div>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.content_type"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.content_type"></a>
<code class="descname">content_type</code><a class="headerlink" href="#aiohttp.web.BaseRequest.content_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-only property with <em>content</em> part of <em>Content-Type</em> header.</p>
<p>Returns <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> like <code class="docutils literal notranslate"><span class="pre">'text/html'</span></code></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Returns value is <code class="docutils literal notranslate"><span class="pre">'application/octet-stream'</span></code> if no
Content-Type header present in HTTP headers according to
<span class="target" id="index-3"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc2616.html"><strong>RFC 2616</strong></a></p>
</div>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.charset"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.charset"></a>
<code class="descname">charset</code><a class="headerlink" href="#aiohttp.web.BaseRequest.charset" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-only property that specifies the <em>encoding</em> for the request’s BODY.</p>
<p>The value is parsed from the <em>Content-Type</em> HTTP header.</p>
<p>Returns <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> like <code class="docutils literal notranslate"><span class="pre">'utf-8'</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code> if
<em>Content-Type</em> has no charset information.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.content_length"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.content_length"></a>
<code class="descname">content_length</code><a class="headerlink" href="#aiohttp.web.BaseRequest.content_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-only property that returns length of the request’s BODY.</p>
<p>The value is parsed from the <em>Content-Length</em> HTTP header.</p>
<p>Returns <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> or <code class="docutils literal notranslate"><span class="pre">None</span></code> if <em>Content-Length</em> is absent.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.http_range"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.http_range"></a>
<code class="descname">http_range</code><a class="headerlink" href="#aiohttp.web.BaseRequest.http_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-only property that returns information about <em>Range</em> HTTP header.</p>
<p>Returns a <a class="reference external" href="https://docs.python.org/3/library/functions.html#slice" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">slice</span></code></a> where <code class="docutils literal notranslate"><span class="pre">.start</span></code> is <em>left inclusive
bound</em>, <code class="docutils literal notranslate"><span class="pre">.stop</span></code> is <em>right exclusive bound</em> and <code class="docutils literal notranslate"><span class="pre">.step</span></code> is
<code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
<p>The property might be used in two manners:</p>
<ol class="arabic">
<li><p class="first">Attribute-access style (example assumes that both left and
right borders are set, the real logic for case of open bounds
is more complex):</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">http_range</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">start</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">stop</span><span class="o">-</span><span class="n">rng</span><span class="o">.</span><span class="n">start</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">Slice-style:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">return</span> <span class="n">buffer</span><span class="p">[</span><span class="n">request</span><span class="o">.</span><span class="n">http_range</span><span class="p">]</span>
</pre></div>
</div>
</li>
</ol>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.if_modified_since"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.if_modified_since"></a>
<code class="descname">if_modified_since</code><a class="headerlink" href="#aiohttp.web.BaseRequest.if_modified_since" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-only property that returns the date specified in the
<em>If-Modified-Since</em> header.</p>
<p>Returns <a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.datetime</span></code></a> or <code class="docutils literal notranslate"><span class="pre">None</span></code> if
<em>If-Modified-Since</em> header is absent or is not a valid
HTTP date.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.if_unmodified_since"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.if_unmodified_since"></a>
<code class="descname">if_unmodified_since</code><a class="headerlink" href="#aiohttp.web.BaseRequest.if_unmodified_since" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-only property that returns the date specified in the
<em>If-Unmodified-Since</em> header.</p>
<p>Returns <a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.datetime</span></code></a> or <code class="docutils literal notranslate"><span class="pre">None</span></code> if
<em>If-Unmodified-Since</em> header is absent or is not a valid
HTTP date.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.BaseRequest.if_range"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseRequest.if_range"></a>
<code class="descname">if_range</code><a class="headerlink" href="#aiohttp.web.BaseRequest.if_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-only property that returns the date specified in the
<em>If-Range</em> header.</p>
<p>Returns <a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.datetime</span></code></a> or <code class="docutils literal notranslate"><span class="pre">None</span></code> if
<em>If-Range</em> header is absent or is not a valid
HTTP date.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.BaseRequest.clone"><a name="//apple_ref/cpp/Method/aiohttp.web.BaseRequest.clone"></a>
<code class="descname">clone</code><span class="sig-paren">(</span><em>*</em>, <em>method=...</em>, <em>rel_url=...</em>, <em>headers=...</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.BaseRequest.clone" title="Permalink to this definition">¶</a></dt>
<dd><p>Clone itself with replacement some attributes.</p>
<p>Creates and returns a new instance of Request object. If no parameters
are given, an exact copy is returned. If a parameter is not passed, it
will reuse the one from the current request object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – http method</li>
<li><strong>rel_url</strong> – url to use, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> or <a class="reference external" href="https://yarl.readthedocs.io/en/stable/api.html#yarl.URL" title="(in yarl v1.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">URL</span></code></a></li>
<li><strong>headers</strong> – <a class="reference external" href="https://multidict.readthedocs.io/en/stable/multidict.html#multidict.CIMultiDict" title="(in multidict v4.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">CIMultiDict</span></code></a> or compatible
headers container.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a cloned <a class="reference internal" href="#aiohttp.web.Request" title="aiohttp.web.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">Request</span></code></a> instance.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.BaseRequest.read"><a name="//apple_ref/cpp/Method/aiohttp.web.BaseRequest.read"></a>
<em class="property">coroutine </em><code class="descname">read</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.BaseRequest.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read request body, returns <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a> object with body content.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The method <strong>does</strong> store read data internally, subsequent
<code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code> call will return the same value.</p>
</div>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.BaseRequest.text"><a name="//apple_ref/cpp/Method/aiohttp.web.BaseRequest.text"></a>
<em class="property">coroutine </em><code class="descname">text</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.BaseRequest.text" title="Permalink to this definition">¶</a></dt>
<dd><p>Read request body, decode it using <a class="reference internal" href="#aiohttp.web.BaseRequest.charset" title="aiohttp.web.BaseRequest.charset"><code class="xref py py-attr docutils literal notranslate"><span class="pre">charset</span></code></a> encoding or
<code class="docutils literal notranslate"><span class="pre">UTF-8</span></code> if no encoding was specified in <em>MIME-type</em>.</p>
<p>Returns <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> with body content.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The method <strong>does</strong> store read data internally, subsequent
<code class="xref py py-meth docutils literal notranslate"><span class="pre">text()</span></code> call will return the same value.</p>
</div>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.BaseRequest.json"><a name="//apple_ref/cpp/Method/aiohttp.web.BaseRequest.json"></a>
<em class="property">coroutine </em><code class="descname">json</code><span class="sig-paren">(</span><em>*</em>, <em>loads=json.loads</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.BaseRequest.json" title="Permalink to this definition">¶</a></dt>
<dd><p>Read request body decoded as <em>json</em>.</p>
<p>The method is just a boilerplate <a class="reference external" href="https://docs.python.org/3/library/asyncio-task.html#coroutine" title="(in Python v3.7)"><span class="xref std std-ref">coroutine</span></a>
implemented as:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">loads</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">):</span>
    <span class="n">body</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">loads</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>loads</strong> (<em>callable</em>) – any <a class="reference internal" href="glossary.html#term-callable"><span class="xref std std-term">callable</span></a> that accepts
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> and returns <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>
with parsed JSON (<a class="reference external" href="https://docs.python.org/3/library/json.html#json.loads" title="(in Python v3.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">json.loads()</span></code></a> by
default).</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The method <strong>does</strong> store read data internally, subsequent
<code class="xref py py-meth docutils literal notranslate"><span class="pre">json()</span></code> call will return the same value.</p>
</div>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.BaseRequest.multipart"><a name="//apple_ref/cpp/Method/aiohttp.web.BaseRequest.multipart"></a>
<em class="property">coroutine </em><code class="descname">multipart</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.BaseRequest.multipart" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="xref py py-class docutils literal notranslate"><span class="pre">aiohttp.multipart.MultipartReader</span></code> which processes
incoming <em>multipart</em> request.</p>
<p>The method is just a boilerplate <a class="reference external" href="https://docs.python.org/3/library/asyncio-task.html#coroutine" title="(in Python v3.7)"><span class="xref std std-ref">coroutine</span></a>
implemented as:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">multipart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">reader</span><span class="o">=</span><span class="n">aiohttp</span><span class="o">.</span><span class="n">multipart</span><span class="o">.</span><span class="n">MultipartReader</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">reader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_payload</span><span class="p">)</span>
</pre></div>
</div>
<p>This method is a coroutine for consistency with the else reader methods.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The method <strong>does not</strong> store read data internally. That means once
you exhausts multipart reader, you cannot get the request payload one
more time.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="multipart.html#aiohttp-multipart"><span class="std std-ref">Working with Multipart</span></a></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.4: </span>Dropped <em>reader</em> parameter.</p>
</div>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.BaseRequest.post"><a name="//apple_ref/cpp/Method/aiohttp.web.BaseRequest.post"></a>
<em class="property">coroutine </em><code class="descname">post</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.BaseRequest.post" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://docs.python.org/3/library/asyncio-task.html#coroutine" title="(in Python v3.7)"><span class="xref std std-ref">coroutine</span></a> that reads POST parameters from
request body.</p>
<p>Returns <a class="reference external" href="https://multidict.readthedocs.io/en/stable/multidict.html#multidict.MultiDictProxy" title="(in multidict v4.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiDictProxy</span></code></a> instance filled
with parsed data.</p>
<p>If <a class="reference internal" href="#aiohttp.web.BaseRequest.method" title="aiohttp.web.BaseRequest.method"><code class="xref py py-attr docutils literal notranslate"><span class="pre">method</span></code></a> is not <em>POST</em>, <em>PUT</em>, <em>PATCH</em>, <em>TRACE</em> or <em>DELETE</em> or
<a class="reference internal" href="#aiohttp.web.BaseRequest.content_type" title="aiohttp.web.BaseRequest.content_type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">content_type</span></code></a> is not empty or
<em>application/x-www-form-urlencoded</em> or <em>multipart/form-data</em>
returns empty multidict.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The method <strong>does</strong> store read data internally, subsequent
<code class="xref py py-meth docutils literal notranslate"><span class="pre">post()</span></code> call will return the same value.</p>
</div>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.BaseRequest.release"><a name="//apple_ref/cpp/Method/aiohttp.web.BaseRequest.release"></a>
<em class="property">coroutine </em><code class="descname">release</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.BaseRequest.release" title="Permalink to this definition">¶</a></dt>
<dd><p>Release request.</p>
<p>Eat unread part of HTTP BODY if present.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">User code may never call <code class="xref py py-meth docutils literal notranslate"><span class="pre">release()</span></code>, all
required work will be processed by <a class="reference internal" href="#module-aiohttp.web" title="aiohttp.web"><code class="xref py py-mod docutils literal notranslate"><span class="pre">aiohttp.web</span></code></a>
internal machinery.</p>
</div>
</dd></dl>
</dd></dl>
<dl class="class">
<dt id="aiohttp.web.Request"><a name="//apple_ref/cpp/Class/aiohttp.web.Request"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">Request</code><a class="headerlink" href="#aiohttp.web.Request" title="Permalink to this definition">¶</a></dt>
<dd><p>An request used for receiving request’s information by <em>web handler</em>.</p>
<p>Every <a class="reference internal" href="web_quickstart.html#aiohttp-web-handler"><span class="std std-ref">handler</span></a> accepts a request
instance as the first positional parameter.</p>
<p>The class in derived from <a class="reference internal" href="#aiohttp.web.BaseRequest" title="aiohttp.web.BaseRequest"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseRequest</span></code></a>, shares all parent’s
attributes and methods but has a couple of additional properties:</p>
<dl class="attribute">
<dt id="aiohttp.web.Request.match_info"><a name="//apple_ref/cpp/Attribute/aiohttp.web.Request.match_info"></a>
<code class="descname">match_info</code><a class="headerlink" href="#aiohttp.web.Request.match_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-only property with <code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractMatchInfo</span></code>
instance for result of route resolving.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Exact type of property depends on used router.  If
<code class="docutils literal notranslate"><span class="pre">app.router</span></code> is <a class="reference internal" href="#aiohttp.web.UrlDispatcher" title="aiohttp.web.UrlDispatcher"><code class="xref py py-class docutils literal notranslate"><span class="pre">UrlDispatcher</span></code></a> the property contains
<a class="reference internal" href="#aiohttp.web.UrlMappingMatchInfo" title="aiohttp.web.UrlMappingMatchInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">UrlMappingMatchInfo</span></code></a> instance.</p>
</div>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.Request.app"><a name="//apple_ref/cpp/Attribute/aiohttp.web.Request.app"></a>
<code class="descname">app</code><a class="headerlink" href="#aiohttp.web.Request.app" title="Permalink to this definition">¶</a></dt>
<dd><p>An <a class="reference internal" href="#aiohttp.web.Application" title="aiohttp.web.Application"><code class="xref py py-class docutils literal notranslate"><span class="pre">Application</span></code></a> instance used to call <a class="reference internal" href="web_quickstart.html#aiohttp-web-handler"><span class="std std-ref">request handler</span></a>, Read-only property.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.Request.config_dict"><a name="//apple_ref/cpp/Attribute/aiohttp.web.Request.config_dict"></a>
<code class="descname">config_dict</code><a class="headerlink" href="#aiohttp.web.Request.config_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="structures.html#aiohttp.ChainMapProxy" title="aiohttp.ChainMapProxy"><code class="xref py py-class docutils literal notranslate"><span class="pre">aiohttp.ChainMapProxy</span></code></a> instance for mapping all properties
from the current application returned by <a class="reference internal" href="#aiohttp.web.Request.app" title="aiohttp.web.Request.app"><code class="xref py py-attr docutils literal notranslate"><span class="pre">app</span></code></a> property
and all its parents.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="web_advanced.html#aiohttp-web-data-sharing-app-config"><span class="std std-ref">Application’s config</span></a></p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.2.</span></p>
</div>
</dd></dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You should never create the <a class="reference internal" href="#aiohttp.web.Request" title="aiohttp.web.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">Request</span></code></a> instance manually
– <a class="reference internal" href="#module-aiohttp.web" title="aiohttp.web"><code class="xref py py-mod docutils literal notranslate"><span class="pre">aiohttp.web</span></code></a> does it for you. But
<a class="reference internal" href="#aiohttp.web.BaseRequest.clone" title="aiohttp.web.BaseRequest.clone"><code class="xref py py-meth docutils literal notranslate"><span class="pre">clone()</span></code></a> may be used for cloning <em>modified</em>
request copy with changed <em>path</em>, <em>method</em> etc.</p>
</div>
</dd></dl>
</div>
<div class="section" id="response-classes">
<span id="aiohttp-web-response"></span><h2>Response classes<a class="headerlink" href="#response-classes" title="Permalink to this headline">¶</a></h2>
<p>For now, <a class="reference internal" href="#module-aiohttp.web" title="aiohttp.web"><code class="xref py py-mod docutils literal notranslate"><span class="pre">aiohttp.web</span></code></a> has three classes for the <em>HTTP response</em>:
<a class="reference internal" href="#aiohttp.web.StreamResponse" title="aiohttp.web.StreamResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamResponse</span></code></a>, <a class="reference internal" href="#aiohttp.web.Response" title="aiohttp.web.Response"><code class="xref py py-class docutils literal notranslate"><span class="pre">Response</span></code></a> and <code class="xref py py-class docutils literal notranslate"><span class="pre">FileResponse</span></code>.</p>
<p>Usually you need to use the second one. <a class="reference internal" href="#aiohttp.web.StreamResponse" title="aiohttp.web.StreamResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamResponse</span></code></a> is
intended for streaming data, while <a class="reference internal" href="#aiohttp.web.Response" title="aiohttp.web.Response"><code class="xref py py-class docutils literal notranslate"><span class="pre">Response</span></code></a> contains <em>HTTP
BODY</em> as an attribute and sends own content as single piece with the
correct <em>Content-Length HTTP header</em>.</p>
<p>For sake of design decisions <a class="reference internal" href="#aiohttp.web.Response" title="aiohttp.web.Response"><code class="xref py py-class docutils literal notranslate"><span class="pre">Response</span></code></a> is derived from
<a class="reference internal" href="#aiohttp.web.StreamResponse" title="aiohttp.web.StreamResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamResponse</span></code></a> parent class.</p>
<p>The response supports <em>keep-alive</em> handling out-of-the-box if
<em>request</em> supports it.</p>
<p>You can disable <em>keep-alive</em> by <a class="reference internal" href="#aiohttp.web.StreamResponse.force_close" title="aiohttp.web.StreamResponse.force_close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">force_close()</span></code></a> though.</p>
<p>The common case for sending an answer from
<a class="reference internal" href="web_quickstart.html#aiohttp-web-handler"><span class="std std-ref">web-handler</span></a> is returning a
<a class="reference internal" href="#aiohttp.web.Response" title="aiohttp.web.Response"><code class="xref py py-class docutils literal notranslate"><span class="pre">Response</span></code></a> instance:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">handler</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">"All right!"</span><span class="p">)</span>
</pre></div>
</div>
<p>Response classes are <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a> like objects,
allowing them to be used for <a class="reference internal" href="web_advanced.html#aiohttp-web-data-sharing"><span class="std std-ref">sharing
data</span></a> among <a class="reference internal" href="web_advanced.html#aiohttp-web-middlewares"><span class="std std-ref">Middlewares</span></a>
and <a class="reference internal" href="web_advanced.html#aiohttp-web-signals"><span class="std std-ref">Signals</span></a> handlers:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">resp</span><span class="p">[</span><span class="s1">'key'</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.0: </span>Dict-like interface support.</p>
</div>
<div class="section" id="streamresponse">
<h3>StreamResponse<a class="headerlink" href="#streamresponse" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="aiohttp.web.StreamResponse"><a name="//apple_ref/cpp/Class/aiohttp.web.StreamResponse"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">StreamResponse</code><span class="sig-paren">(</span><em>*</em>, <em>status=200</em>, <em>reason=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.StreamResponse" title="Permalink to this definition">¶</a></dt>
<dd><p>The base class for the <em>HTTP response</em> handling.</p>
<p>Contains methods for setting <em>HTTP response headers</em>, <em>cookies</em>,
<em>response status code</em>, writing <em>HTTP response BODY</em> and so on.</p>
<p>The most important thing you should know about <em>response</em> — it
is <em>Finite State Machine</em>.</p>
<p>That means you can do any manipulations with <em>headers</em>, <em>cookies</em>
and <em>status code</em> only before <a class="reference internal" href="#aiohttp.web.StreamResponse.prepare" title="aiohttp.web.StreamResponse.prepare"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare()</span></code></a> coroutine is called.</p>
<p>Once you call <a class="reference internal" href="#aiohttp.web.StreamResponse.prepare" title="aiohttp.web.StreamResponse.prepare"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare()</span></code></a> any change of
the <em>HTTP header</em> part will raise <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.7)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">RuntimeError</span></code></a> exception.</p>
<p>Any <a class="reference internal" href="#aiohttp.web.StreamResponse.write" title="aiohttp.web.StreamResponse.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write()</span></code></a> call after <a class="reference internal" href="#aiohttp.web.StreamResponse.write_eof" title="aiohttp.web.StreamResponse.write_eof"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write_eof()</span></code></a> is also forbidden.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>status</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – HTTP status code, <code class="docutils literal notranslate"><span class="pre">200</span></code> by default.</li>
<li><strong>reason</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – HTTP reason. If param is <code class="docutils literal notranslate"><span class="pre">None</span></code> reason will be
calculated basing on <em>status</em>
parameter. Otherwise pass <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> with
arbitrary <em>status</em> explanation..</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="aiohttp.web.StreamResponse.prepared"><a name="//apple_ref/cpp/Attribute/aiohttp.web.StreamResponse.prepared"></a>
<code class="descname">prepared</code><a class="headerlink" href="#aiohttp.web.StreamResponse.prepared" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-only <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a> property, <code class="docutils literal notranslate"><span class="pre">True</span></code> if <a class="reference internal" href="#aiohttp.web.StreamResponse.prepare" title="aiohttp.web.StreamResponse.prepare"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare()</span></code></a> has
been called, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.StreamResponse.task"><a name="//apple_ref/cpp/Attribute/aiohttp.web.StreamResponse.task"></a>
<code class="descname">task</code><a class="headerlink" href="#aiohttp.web.StreamResponse.task" title="Permalink to this definition">¶</a></dt>
<dd><p>A task that serves HTTP request handling.</p>
<p>May be useful for graceful shutdown of long-running requests
(streaming, long polling or web-socket).</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.StreamResponse.status"><a name="//apple_ref/cpp/Attribute/aiohttp.web.StreamResponse.status"></a>
<code class="descname">status</code><a class="headerlink" href="#aiohttp.web.StreamResponse.status" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-only property for <em>HTTP response status code</em>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">200</span></code> (OK) by default.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.StreamResponse.reason"><a name="//apple_ref/cpp/Attribute/aiohttp.web.StreamResponse.reason"></a>
<code class="descname">reason</code><a class="headerlink" href="#aiohttp.web.StreamResponse.reason" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-only property for <em>HTTP response reason</em>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>.</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.StreamResponse.set_status"><a name="//apple_ref/cpp/Method/aiohttp.web.StreamResponse.set_status"></a>
<code class="descname">set_status</code><span class="sig-paren">(</span><em>status</em>, <em>reason=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.StreamResponse.set_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Set <a class="reference internal" href="#aiohttp.web.StreamResponse.status" title="aiohttp.web.StreamResponse.status"><code class="xref py py-attr docutils literal notranslate"><span class="pre">status</span></code></a> and <a class="reference internal" href="#aiohttp.web.StreamResponse.reason" title="aiohttp.web.StreamResponse.reason"><code class="xref py py-attr docutils literal notranslate"><span class="pre">reason</span></code></a>.</p>
<p><em>reason</em> value is auto calculated if not specified (<code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.StreamResponse.keep_alive"><a name="//apple_ref/cpp/Attribute/aiohttp.web.StreamResponse.keep_alive"></a>
<code class="descname">keep_alive</code><a class="headerlink" href="#aiohttp.web.StreamResponse.keep_alive" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-only property, copy of <code class="xref py py-attr docutils literal notranslate"><span class="pre">Request.keep_alive</span></code> by default.</p>
<p>Can be switched to <code class="docutils literal notranslate"><span class="pre">False</span></code> by <a class="reference internal" href="#aiohttp.web.StreamResponse.force_close" title="aiohttp.web.StreamResponse.force_close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">force_close()</span></code></a> call.</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.StreamResponse.force_close"><a name="//apple_ref/cpp/Method/aiohttp.web.StreamResponse.force_close"></a>
<code class="descname">force_close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.StreamResponse.force_close" title="Permalink to this definition">¶</a></dt>
<dd><p>Disable <a class="reference internal" href="#aiohttp.web.StreamResponse.keep_alive" title="aiohttp.web.StreamResponse.keep_alive"><code class="xref py py-attr docutils literal notranslate"><span class="pre">keep_alive</span></code></a> for connection. There are no ways to
enable it back.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.StreamResponse.compression"><a name="//apple_ref/cpp/Attribute/aiohttp.web.StreamResponse.compression"></a>
<code class="descname">compression</code><a class="headerlink" href="#aiohttp.web.StreamResponse.compression" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-only <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a> property, <code class="docutils literal notranslate"><span class="pre">True</span></code> if compression is enabled.</p>
<p><code class="docutils literal notranslate"><span class="pre">False</span></code> by default.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#aiohttp.web.StreamResponse.enable_compression" title="aiohttp.web.StreamResponse.enable_compression"><code class="xref py py-meth docutils literal notranslate"><span class="pre">enable_compression()</span></code></a></p>
</div>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.StreamResponse.enable_compression"><a name="//apple_ref/cpp/Method/aiohttp.web.StreamResponse.enable_compression"></a>
<code class="descname">enable_compression</code><span class="sig-paren">(</span><em>force=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.StreamResponse.enable_compression" title="Permalink to this definition">¶</a></dt>
<dd><p>Enable compression.</p>
<p>When <em>force</em> is unset compression encoding is selected based on
the request’s <em>Accept-Encoding</em> header.</p>
<p><em>Accept-Encoding</em> is not checked if <em>force</em> is set to a
<a class="reference internal" href="#aiohttp.web.ContentCoding" title="aiohttp.web.ContentCoding"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContentCoding</span></code></a>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#aiohttp.web.StreamResponse.compression" title="aiohttp.web.StreamResponse.compression"><code class="xref py py-attr docutils literal notranslate"><span class="pre">compression</span></code></a></p>
</div>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.StreamResponse.chunked"><a name="//apple_ref/cpp/Attribute/aiohttp.web.StreamResponse.chunked"></a>
<code class="descname">chunked</code><a class="headerlink" href="#aiohttp.web.StreamResponse.chunked" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-only property, indicates if chunked encoding is on.</p>
<p>Can be enabled by <a class="reference internal" href="#aiohttp.web.StreamResponse.enable_chunked_encoding" title="aiohttp.web.StreamResponse.enable_chunked_encoding"><code class="xref py py-meth docutils literal notranslate"><span class="pre">enable_chunked_encoding()</span></code></a> call.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#aiohttp.web.StreamResponse.enable_chunked_encoding" title="aiohttp.web.StreamResponse.enable_chunked_encoding"><code class="xref py py-attr docutils literal notranslate"><span class="pre">enable_chunked_encoding</span></code></a></p>
</div>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.StreamResponse.enable_chunked_encoding"><a name="//apple_ref/cpp/Method/aiohttp.web.StreamResponse.enable_chunked_encoding"></a>
<code class="descname">enable_chunked_encoding</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.StreamResponse.enable_chunked_encoding" title="Permalink to this definition">¶</a></dt>
<dd><p>Enables <a class="reference internal" href="#aiohttp.web.StreamResponse.chunked" title="aiohttp.web.StreamResponse.chunked"><code class="xref py py-attr docutils literal notranslate"><span class="pre">chunked</span></code></a> encoding for response. There are no ways to
disable it back. With enabled <a class="reference internal" href="#aiohttp.web.StreamResponse.chunked" title="aiohttp.web.StreamResponse.chunked"><code class="xref py py-attr docutils literal notranslate"><span class="pre">chunked</span></code></a> encoding each <a class="reference internal" href="#aiohttp.web.StreamResponse.write" title="aiohttp.web.StreamResponse.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write()</span></code></a>
operation encoded in separate chunk.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>chunked encoding can be enabled for <code class="docutils literal notranslate"><span class="pre">HTTP/1.1</span></code> only.</p>
<p class="last">Setting up both <a class="reference internal" href="#aiohttp.web.StreamResponse.content_length" title="aiohttp.web.StreamResponse.content_length"><code class="xref py py-attr docutils literal notranslate"><span class="pre">content_length</span></code></a> and chunked
encoding is mutually exclusive.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#aiohttp.web.StreamResponse.chunked" title="aiohttp.web.StreamResponse.chunked"><code class="xref py py-attr docutils literal notranslate"><span class="pre">chunked</span></code></a></p>
</div>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.StreamResponse.headers"><a name="//apple_ref/cpp/Attribute/aiohttp.web.StreamResponse.headers"></a>
<code class="descname">headers</code><a class="headerlink" href="#aiohttp.web.StreamResponse.headers" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://multidict.readthedocs.io/en/stable/multidict.html#multidict.CIMultiDict" title="(in multidict v4.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">CIMultiDict</span></code></a> instance
for <em>outgoing</em> <em>HTTP headers</em>.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.StreamResponse.cookies"><a name="//apple_ref/cpp/Attribute/aiohttp.web.StreamResponse.cookies"></a>
<code class="descname">cookies</code><a class="headerlink" href="#aiohttp.web.StreamResponse.cookies" title="Permalink to this definition">¶</a></dt>
<dd><p>An instance of <a class="reference external" href="https://docs.python.org/3/library/http.cookies.html#http.cookies.SimpleCookie" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">http.cookies.SimpleCookie</span></code></a> for <em>outgoing</em> cookies.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Direct setting up <em>Set-Cookie</em> header may be overwritten by
explicit calls to cookie manipulation.</p>
<p class="last">We are encourage using of <a class="reference internal" href="#aiohttp.web.StreamResponse.cookies" title="aiohttp.web.StreamResponse.cookies"><code class="xref py py-attr docutils literal notranslate"><span class="pre">cookies</span></code></a> and
<a class="reference internal" href="#aiohttp.web.StreamResponse.set_cookie" title="aiohttp.web.StreamResponse.set_cookie"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_cookie()</span></code></a>, <a class="reference internal" href="#aiohttp.web.StreamResponse.del_cookie" title="aiohttp.web.StreamResponse.del_cookie"><code class="xref py py-meth docutils literal notranslate"><span class="pre">del_cookie()</span></code></a> for cookie
manipulations.</p>
</div>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.StreamResponse.set_cookie"><a name="//apple_ref/cpp/Method/aiohttp.web.StreamResponse.set_cookie"></a>
<code class="descname">set_cookie</code><span class="sig-paren">(</span><em>name</em>, <em>value</em>, <em>*</em>, <em>path='/'</em>, <em>expires=None</em>, <em>domain=None</em>, <em>max_age=None</em>, <em>secure=None</em>, <em>httponly=None</em>, <em>version=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.StreamResponse.set_cookie" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenient way for setting <a class="reference internal" href="#aiohttp.web.StreamResponse.cookies" title="aiohttp.web.StreamResponse.cookies"><code class="xref py py-attr docutils literal notranslate"><span class="pre">cookies</span></code></a>, allows to specify
some additional properties like <em>max_age</em> in a single call.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – cookie name</li>
<li><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – cookie value (will be converted to
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> if value has another type).</li>
<li><strong>expires</strong> – expiration date (optional)</li>
<li><strong>domain</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – cookie domain (optional)</li>
<li><strong>max_age</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – defines the lifetime of the cookie, in
seconds.  The delta-seconds value is a
decimal non- negative integer.  After
delta-seconds seconds elapse, the client
should discard the cookie.  A value of zero
means the cookie should be discarded
immediately.  (optional)</li>
<li><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – specifies the subset of URLs to
which this cookie applies. (optional, <code class="docutils literal notranslate"><span class="pre">'/'</span></code> by default)</li>
<li><strong>secure</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – attribute (with no value) directs
the user agent to use only (unspecified)
secure means to contact the origin server
whenever it sends back this cookie.
The user agent (possibly under the user’s
control) may determine what level of
security it considers appropriate for
“secure” cookies.  The <em>secure</em> should be
considered security advice from the server
to the user agent, indicating that it is in
the session’s interest to protect the cookie
contents. (optional)</li>
<li><strong>httponly</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – <code class="docutils literal notranslate"><span class="pre">True</span></code> if the cookie HTTP only (optional)</li>
<li><strong>version</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – a decimal integer, identifies to which
version of the state management
specification the cookie
conforms. (Optional, <em>version=1</em> by default)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">In HTTP version 1.1, <code class="docutils literal notranslate"><span class="pre">expires</span></code> was deprecated and replaced with
the easier-to-use <code class="docutils literal notranslate"><span class="pre">max-age</span></code>, but Internet Explorer (IE6, IE7,
and IE8) <strong>does not</strong> support <code class="docutils literal notranslate"><span class="pre">max-age</span></code>.</p>
</div>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.StreamResponse.del_cookie"><a name="//apple_ref/cpp/Method/aiohttp.web.StreamResponse.del_cookie"></a>
<code class="descname">del_cookie</code><span class="sig-paren">(</span><em>name</em>, <em>*</em>, <em>path='/'</em>, <em>domain=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.StreamResponse.del_cookie" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes cookie.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – cookie name</li>
<li><strong>domain</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – optional cookie domain</li>
<li><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – optional cookie path, <code class="docutils literal notranslate"><span class="pre">'/'</span></code> by default</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.StreamResponse.content_length"><a name="//apple_ref/cpp/Attribute/aiohttp.web.StreamResponse.content_length"></a>
<code class="descname">content_length</code><a class="headerlink" href="#aiohttp.web.StreamResponse.content_length" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Content-Length</em> for outgoing response.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.StreamResponse.content_type"><a name="//apple_ref/cpp/Attribute/aiohttp.web.StreamResponse.content_type"></a>
<code class="descname">content_type</code><a class="headerlink" href="#aiohttp.web.StreamResponse.content_type" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Content</em> part of <em>Content-Type</em> for outgoing response.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.StreamResponse.charset"><a name="//apple_ref/cpp/Attribute/aiohttp.web.StreamResponse.charset"></a>
<code class="descname">charset</code><a class="headerlink" href="#aiohttp.web.StreamResponse.charset" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Charset</em> aka <em>encoding</em> part of <em>Content-Type</em> for outgoing response.</p>
<p>The value converted to lower-case on attribute assigning.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.StreamResponse.last_modified"><a name="//apple_ref/cpp/Attribute/aiohttp.web.StreamResponse.last_modified"></a>
<code class="descname">last_modified</code><a class="headerlink" href="#aiohttp.web.StreamResponse.last_modified" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Last-Modified</em> header for outgoing response.</p>
<p>This property accepts raw <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> values,
<a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.datetime</span></code></a> objects, Unix timestamps specified
as an <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> or a <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> object, and the
value <code class="docutils literal notranslate"><span class="pre">None</span></code> to unset the header.</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.StreamResponse.prepare"><a name="//apple_ref/cpp/Method/aiohttp.web.StreamResponse.prepare"></a>
<em class="property">coroutine </em><code class="descname">prepare</code><span class="sig-paren">(</span><em>request</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.StreamResponse.prepare" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>request</strong> (<a class="reference internal" href="#aiohttp.web.Request" title="aiohttp.web.Request"><em>aiohttp.web.Request</em></a>) – HTTP request object, that the
response answers.</td>
</tr>
</tbody>
</table>
<p>Send <em>HTTP header</em>. You should not change any header data after
calling this method.</p>
<p>The coroutine calls <a class="reference internal" href="#aiohttp.web.Application.on_response_prepare" title="aiohttp.web.Application.on_response_prepare"><code class="xref py py-attr docutils literal notranslate"><span class="pre">on_response_prepare</span></code></a>
signal handlers.</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.StreamResponse.write"><a name="//apple_ref/cpp/Method/aiohttp.web.StreamResponse.write"></a>
<em class="property">coroutine </em><code class="descname">write</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.StreamResponse.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Send byte-ish data as the part of <em>response BODY</em>:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">await</span> <span class="n">resp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference internal" href="#aiohttp.web.StreamResponse.prepare" title="aiohttp.web.StreamResponse.prepare"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare()</span></code></a> must be invoked before the call.</p>
<p>Raises <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.7)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">TypeError</span></code></a> if data is not <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a>,
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytearray" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytearray</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#memoryview" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">memoryview</span></code></a> instance.</p>
<p>Raises <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.7)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">RuntimeError</span></code></a> if <a class="reference internal" href="#aiohttp.web.StreamResponse.prepare" title="aiohttp.web.StreamResponse.prepare"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare()</span></code></a> has not been called.</p>
<p>Raises <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.7)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">RuntimeError</span></code></a> if <a class="reference internal" href="#aiohttp.web.StreamResponse.write_eof" title="aiohttp.web.StreamResponse.write_eof"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write_eof()</span></code></a> has been called.</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.StreamResponse.write_eof"><a name="//apple_ref/cpp/Method/aiohttp.web.StreamResponse.write_eof"></a>
<em class="property">coroutine </em><code class="descname">write_eof</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.StreamResponse.write_eof" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://docs.python.org/3/library/asyncio-task.html#coroutine" title="(in Python v3.7)"><span class="xref std std-ref">coroutine</span></a> <em>may</em> be called as a mark of the
<em>HTTP response</em> processing finish.</p>
<p><em>Internal machinery</em> will call this method at the end of
the request processing if needed.</p>
<p>After <a class="reference internal" href="#aiohttp.web.StreamResponse.write_eof" title="aiohttp.web.StreamResponse.write_eof"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write_eof()</span></code></a> call any manipulations with the <em>response</em>
object are forbidden.</p>
</dd></dl>
</dd></dl>
</div>
<div class="section" id="response">
<h3>Response<a class="headerlink" href="#response" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="aiohttp.web.Response"><a name="//apple_ref/cpp/Class/aiohttp.web.Response"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">Response</code><span class="sig-paren">(</span><em>*</em>, <em>body=None</em>, <em>status=200</em>, <em>reason=None</em>, <em>text=None</em>, <em>headers=None</em>, <em>content_type=None</em>, <em>charset=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.Response" title="Permalink to this definition">¶</a></dt>
<dd><p>The most usable response class, inherited from <a class="reference internal" href="#aiohttp.web.StreamResponse" title="aiohttp.web.StreamResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamResponse</span></code></a>.</p>
<p>Accepts <em>body</em> argument for setting the <em>HTTP response BODY</em>.</p>
<p>The actual <a class="reference internal" href="#aiohttp.web.Response.body" title="aiohttp.web.Response.body"><code class="xref py py-attr docutils literal notranslate"><span class="pre">body</span></code></a> sending happens in overridden
<a class="reference internal" href="#aiohttp.web.StreamResponse.write_eof" title="aiohttp.web.StreamResponse.write_eof"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write_eof()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>body</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.7)"><em>bytes</em></a>) – response’s BODY</li>
<li><strong>status</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – HTTP status code, 200 OK by default.</li>
<li><strong>headers</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.7)"><em>collections.abc.Mapping</em></a>) – HTTP headers that should be added to
response’s ones.</li>
<li><strong>text</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – response’s BODY</li>
<li><strong>content_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – response’s content type. <code class="docutils literal notranslate"><span class="pre">'text/plain'</span></code>
if <em>text</em> is passed also,
<code class="docutils literal notranslate"><span class="pre">'application/octet-stream'</span></code> otherwise.</li>
<li><strong>charset</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – response’s charset. <code class="docutils literal notranslate"><span class="pre">'utf-8'</span></code> if <em>text</em> is
passed also, <code class="docutils literal notranslate"><span class="pre">None</span></code> otherwise.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="aiohttp.web.Response.body"><a name="//apple_ref/cpp/Attribute/aiohttp.web.Response.body"></a>
<code class="descname">body</code><a class="headerlink" href="#aiohttp.web.Response.body" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-write attribute for storing response’s content aka BODY,
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a>.</p>
<p>Setting <a class="reference internal" href="#aiohttp.web.Response.body" title="aiohttp.web.Response.body"><code class="xref py py-attr docutils literal notranslate"><span class="pre">body</span></code></a> also recalculates
<a class="reference internal" href="#aiohttp.web.StreamResponse.content_length" title="aiohttp.web.StreamResponse.content_length"><code class="xref py py-attr docutils literal notranslate"><span class="pre">content_length</span></code></a> value.</p>
<p>Assigning <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> to <a class="reference internal" href="#aiohttp.web.Response.body" title="aiohttp.web.Response.body"><code class="xref py py-attr docutils literal notranslate"><span class="pre">body</span></code></a> will make the <a class="reference internal" href="#aiohttp.web.Response.body" title="aiohttp.web.Response.body"><code class="xref py py-attr docutils literal notranslate"><span class="pre">body</span></code></a>
type of <code class="xref py py-class docutils literal notranslate"><span class="pre">aiohttp.payload.StringPayload</span></code>, which tries to encode
the given data based on <em>Content-Type</em> HTTP header, while defaulting
to <code class="docutils literal notranslate"><span class="pre">UTF-8</span></code>.</p>
<p>Resetting <a class="reference internal" href="#aiohttp.web.Response.body" title="aiohttp.web.Response.body"><code class="xref py py-attr docutils literal notranslate"><span class="pre">body</span></code></a> (assigning <code class="docutils literal notranslate"><span class="pre">None</span></code>) sets
<a class="reference internal" href="#aiohttp.web.StreamResponse.content_length" title="aiohttp.web.StreamResponse.content_length"><code class="xref py py-attr docutils literal notranslate"><span class="pre">content_length</span></code></a> to <code class="docutils literal notranslate"><span class="pre">None</span></code> too, dropping
<em>Content-Length</em> HTTP header.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.Response.text"><a name="//apple_ref/cpp/Attribute/aiohttp.web.Response.text"></a>
<code class="descname">text</code><a class="headerlink" href="#aiohttp.web.Response.text" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-write attribute for storing response’s content, represented as
string, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>.</p>
<p>Setting <a class="reference internal" href="#aiohttp.web.Response.text" title="aiohttp.web.Response.text"><code class="xref py py-attr docutils literal notranslate"><span class="pre">text</span></code></a> also recalculates
<a class="reference internal" href="#aiohttp.web.StreamResponse.content_length" title="aiohttp.web.StreamResponse.content_length"><code class="xref py py-attr docutils literal notranslate"><span class="pre">content_length</span></code></a> value and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">body</span></code> value</p>
<p>Resetting <a class="reference internal" href="#aiohttp.web.Response.text" title="aiohttp.web.Response.text"><code class="xref py py-attr docutils literal notranslate"><span class="pre">text</span></code></a> (assigning <code class="docutils literal notranslate"><span class="pre">None</span></code>) sets
<a class="reference internal" href="#aiohttp.web.StreamResponse.content_length" title="aiohttp.web.StreamResponse.content_length"><code class="xref py py-attr docutils literal notranslate"><span class="pre">content_length</span></code></a> to <code class="docutils literal notranslate"><span class="pre">None</span></code> too, dropping
<em>Content-Length</em> HTTP header.</p>
</dd></dl>
</dd></dl>
</div>
<div class="section" id="websocketresponse">
<h3>WebSocketResponse<a class="headerlink" href="#websocketresponse" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="aiohttp.web.WebSocketResponse"><a name="//apple_ref/cpp/Class/aiohttp.web.WebSocketResponse"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">WebSocketResponse</code><span class="sig-paren">(</span><em>*</em>, <em>timeout=10.0</em>, <em>receive_timeout=None</em>, <em>autoclose=True</em>, <em>autoping=True</em>, <em>heartbeat=None</em>, <em>protocols=()</em>, <em>compress=True</em>, <em>max_msg_size=4194304</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.WebSocketResponse" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for handling server-side websockets, inherited from
<a class="reference internal" href="#aiohttp.web.StreamResponse" title="aiohttp.web.StreamResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamResponse</span></code></a>.</p>
<p>After starting (by <a class="reference internal" href="#aiohttp.web.WebSocketResponse.prepare" title="aiohttp.web.WebSocketResponse.prepare"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare()</span></code></a> call) the response you
cannot use <a class="reference internal" href="#aiohttp.web.StreamResponse.write" title="aiohttp.web.StreamResponse.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write()</span></code></a> method but should to
communicate with websocket client by <a class="reference internal" href="#aiohttp.web.WebSocketResponse.send_str" title="aiohttp.web.WebSocketResponse.send_str"><code class="xref py py-meth docutils literal notranslate"><span class="pre">send_str()</span></code></a>,
<a class="reference internal" href="#aiohttp.web.WebSocketResponse.receive" title="aiohttp.web.WebSocketResponse.receive"><code class="xref py py-meth docutils literal notranslate"><span class="pre">receive()</span></code></a> and others.</p>
<p>To enable back-pressure from slow websocket clients treat methods
<a class="reference internal" href="#aiohttp.web.WebSocketResponse.ping" title="aiohttp.web.WebSocketResponse.ping"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ping()</span></code></a>, <a class="reference internal" href="#aiohttp.web.WebSocketResponse.pong" title="aiohttp.web.WebSocketResponse.pong"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pong()</span></code></a>, <a class="reference internal" href="#aiohttp.web.WebSocketResponse.send_str" title="aiohttp.web.WebSocketResponse.send_str"><code class="xref py py-meth docutils literal notranslate"><span class="pre">send_str()</span></code></a>,
<a class="reference internal" href="#aiohttp.web.WebSocketResponse.send_bytes" title="aiohttp.web.WebSocketResponse.send_bytes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">send_bytes()</span></code></a>, <a class="reference internal" href="#aiohttp.web.WebSocketResponse.send_json" title="aiohttp.web.WebSocketResponse.send_json"><code class="xref py py-meth docutils literal notranslate"><span class="pre">send_json()</span></code></a> as coroutines.  By
default write buffer size is set to 64k.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>autoping</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Automatically send
<a class="reference internal" href="websocket_utilities.html#aiohttp.WSMsgType.PONG" title="aiohttp.WSMsgType.PONG"><code class="xref py py-const docutils literal notranslate"><span class="pre">PONG</span></code></a> on
<a class="reference internal" href="websocket_utilities.html#aiohttp.WSMsgType.PING" title="aiohttp.WSMsgType.PING"><code class="xref py py-const docutils literal notranslate"><span class="pre">PING</span></code></a>
message from client, and handle
<a class="reference internal" href="websocket_utilities.html#aiohttp.WSMsgType.PONG" title="aiohttp.WSMsgType.PONG"><code class="xref py py-const docutils literal notranslate"><span class="pre">PONG</span></code></a>
responses from client.
Note that server does not send
<a class="reference internal" href="websocket_utilities.html#aiohttp.WSMsgType.PING" title="aiohttp.WSMsgType.PING"><code class="xref py py-const docutils literal notranslate"><span class="pre">PING</span></code></a>
requests, you need to do this explicitly
using <a class="reference internal" href="#aiohttp.web.WebSocketResponse.ping" title="aiohttp.web.WebSocketResponse.ping"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ping()</span></code></a> method.</li>
<li><strong>heartbeat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Send <cite>ping</cite> message every <cite>heartbeat</cite>
seconds and wait <cite>pong</cite> response, close
connection if <cite>pong</cite> response is not
received. The timer is reset on any data reception.</li>
<li><strong>receive_timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Timeout value for <cite>receive</cite>
operations.  Default value is None
(no timeout for receive operation)</li>
<li><strong>compress</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Enable per-message deflate extension support.
False for disabled, default value is True.</li>
<li><strong>max_msg_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – <dl class="docutils">
<dt>maximum size of read websocket message, 4</dt>
<dd>MB by default. To disable the size limit use <code class="docutils literal notranslate"><span class="pre">0</span></code>.</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.3.</span></p>
</div>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The class supports <code class="docutils literal notranslate"><span class="pre">async</span> <span class="pre">for</span></code> statement for iterating over
incoming messages:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">WebSocketResponse</span><span class="p">()</span>
<span class="k">await</span> <span class="n">ws</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">ws</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="aiohttp.web.WebSocketResponse.prepare"><a name="//apple_ref/cpp/Method/aiohttp.web.WebSocketResponse.prepare"></a>
<em class="property">coroutine </em><code class="descname">prepare</code><span class="sig-paren">(</span><em>request</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.WebSocketResponse.prepare" title="Permalink to this definition">¶</a></dt>
<dd><p>Starts websocket. After the call you can use websocket methods.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>request</strong> (<a class="reference internal" href="#aiohttp.web.Request" title="aiohttp.web.Request"><em>aiohttp.web.Request</em></a>) – HTTP request object, that the
response answers.</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><strong>HTTPException</strong> – if websocket handshake has failed.</td>
</tr>
</tbody>
</table>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.WebSocketResponse.can_prepare"><a name="//apple_ref/cpp/Method/aiohttp.web.WebSocketResponse.can_prepare"></a>
<code class="descname">can_prepare</code><span class="sig-paren">(</span><em>request</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.WebSocketResponse.can_prepare" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs checks for <em>request</em> data to figure out if websocket
can be started on the request.</p>
<p>If <a class="reference internal" href="#aiohttp.web.WebSocketResponse.can_prepare" title="aiohttp.web.WebSocketResponse.can_prepare"><code class="xref py py-meth docutils literal notranslate"><span class="pre">can_prepare()</span></code></a> call is success then <a class="reference internal" href="#aiohttp.web.WebSocketResponse.prepare" title="aiohttp.web.WebSocketResponse.prepare"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare()</span></code></a> will
success too.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>request</strong> (<a class="reference internal" href="#aiohttp.web.Request" title="aiohttp.web.Request"><em>aiohttp.web.Request</em></a>) – HTTP request object, that the
response answers.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference internal" href="#aiohttp.web.WebSocketReady" title="aiohttp.web.WebSocketReady"><code class="xref py py-class docutils literal notranslate"><span class="pre">WebSocketReady</span></code></a> instance.<p><a class="reference internal" href="#aiohttp.web.WebSocketReady.ok" title="aiohttp.web.WebSocketReady.ok"><code class="xref py py-attr docutils literal notranslate"><span class="pre">WebSocketReady.ok</span></code></a> is
<code class="docutils literal notranslate"><span class="pre">True</span></code> on success, <a class="reference internal" href="#aiohttp.web.WebSocketReady.protocol" title="aiohttp.web.WebSocketReady.protocol"><code class="xref py py-attr docutils literal notranslate"><span class="pre">WebSocketReady.protocol</span></code></a> is
websocket subprotocol which is passed by client and
accepted by server (one of <em>protocols</em> sequence from
<a class="reference internal" href="#aiohttp.web.WebSocketResponse" title="aiohttp.web.WebSocketResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">WebSocketResponse</span></code></a> ctor).
<a class="reference internal" href="#aiohttp.web.WebSocketReady.protocol" title="aiohttp.web.WebSocketReady.protocol"><code class="xref py py-attr docutils literal notranslate"><span class="pre">WebSocketReady.protocol</span></code></a> may be <code class="docutils literal notranslate"><span class="pre">None</span></code> if
client and server subprotocols are not overlapping.</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The method never raises exception.</p>
</div>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.WebSocketResponse.closed"><a name="//apple_ref/cpp/Attribute/aiohttp.web.WebSocketResponse.closed"></a>
<code class="descname">closed</code><a class="headerlink" href="#aiohttp.web.WebSocketResponse.closed" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-only property, <code class="docutils literal notranslate"><span class="pre">True</span></code> if connection has been closed or in process
of closing.
<a class="reference internal" href="websocket_utilities.html#aiohttp.WSMsgType.CLOSE" title="aiohttp.WSMsgType.CLOSE"><code class="xref py py-const docutils literal notranslate"><span class="pre">CLOSE</span></code></a> message has been received from peer.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.WebSocketResponse.close_code"><a name="//apple_ref/cpp/Attribute/aiohttp.web.WebSocketResponse.close_code"></a>
<code class="descname">close_code</code><a class="headerlink" href="#aiohttp.web.WebSocketResponse.close_code" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-only property, close code from peer. It is set to <code class="docutils literal notranslate"><span class="pre">None</span></code> on
opened connection.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.WebSocketResponse.ws_protocol"><a name="//apple_ref/cpp/Attribute/aiohttp.web.WebSocketResponse.ws_protocol"></a>
<code class="descname">ws_protocol</code><a class="headerlink" href="#aiohttp.web.WebSocketResponse.ws_protocol" title="Permalink to this definition">¶</a></dt>
<dd><p>Websocket <em>subprotocol</em> chosen after <code class="xref py py-meth docutils literal notranslate"><span class="pre">start()</span></code> call.</p>
<p>May be <code class="docutils literal notranslate"><span class="pre">None</span></code> if server and client protocols are
not overlapping.</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.WebSocketResponse.exception"><a name="//apple_ref/cpp/Method/aiohttp.web.WebSocketResponse.exception"></a>
<code class="descname">exception</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.WebSocketResponse.exception" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns last occurred exception or None.</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.WebSocketResponse.ping"><a name="//apple_ref/cpp/Method/aiohttp.web.WebSocketResponse.ping"></a>
<em class="property">coroutine </em><code class="descname">ping</code><span class="sig-paren">(</span><em>message=b''</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.WebSocketResponse.ping" title="Permalink to this definition">¶</a></dt>
<dd><p>Send <a class="reference internal" href="websocket_utilities.html#aiohttp.WSMsgType.PING" title="aiohttp.WSMsgType.PING"><code class="xref py py-const docutils literal notranslate"><span class="pre">PING</span></code></a> to peer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>message</strong> – optional payload of <em>ping</em> message,
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> (converted to <em>UTF-8</em> encoded bytes)
or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.7)"><strong>RuntimeError</strong></a> – if connections is not started or closing.</td>
</tr>
</tbody>
</table>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.0: </span>The method is converted into <a class="reference external" href="https://docs.python.org/3/glossary.html#term-coroutine" title="(in Python v3.7)"><span class="xref std std-term">coroutine</span></a></p>
</div>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.WebSocketResponse.pong"><a name="//apple_ref/cpp/Method/aiohttp.web.WebSocketResponse.pong"></a>
<em class="property">coroutine </em><code class="descname">pong</code><span class="sig-paren">(</span><em>message=b''</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.WebSocketResponse.pong" title="Permalink to this definition">¶</a></dt>
<dd><p>Send <em>unsolicited</em> <a class="reference internal" href="websocket_utilities.html#aiohttp.WSMsgType.PONG" title="aiohttp.WSMsgType.PONG"><code class="xref py py-const docutils literal notranslate"><span class="pre">PONG</span></code></a> to peer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>message</strong> – optional payload of <em>pong</em> message,
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> (converted to <em>UTF-8</em> encoded bytes)
or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.7)"><strong>RuntimeError</strong></a> – if connections is not started or closing.</td>
</tr>
</tbody>
</table>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.0: </span>The method is converted into <a class="reference external" href="https://docs.python.org/3/glossary.html#term-coroutine" title="(in Python v3.7)"><span class="xref std std-term">coroutine</span></a></p>
</div>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.WebSocketResponse.send_str"><a name="//apple_ref/cpp/Method/aiohttp.web.WebSocketResponse.send_str"></a>
<em class="property">coroutine </em><code class="descname">send_str</code><span class="sig-paren">(</span><em>data</em>, <em>compress=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.WebSocketResponse.send_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Send <em>data</em> to peer as <a class="reference internal" href="websocket_utilities.html#aiohttp.WSMsgType.TEXT" title="aiohttp.WSMsgType.TEXT"><code class="xref py py-const docutils literal notranslate"><span class="pre">TEXT</span></code></a> message.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – data to send.</li>
<li><strong>compress</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – sets specific level of compression for
single message,
<code class="docutils literal notranslate"><span class="pre">None</span></code> for not overriding per-socket setting.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.7)"><strong>RuntimeError</strong></a> – if connection is not started or closing</li>
<li><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.7)"><strong>TypeError</strong></a> – if data is not <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.0: </span>The method is converted into <a class="reference external" href="https://docs.python.org/3/glossary.html#term-coroutine" title="(in Python v3.7)"><span class="xref std std-term">coroutine</span></a>,
<em>compress</em> parameter added.</p>
</div>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.WebSocketResponse.send_bytes"><a name="//apple_ref/cpp/Method/aiohttp.web.WebSocketResponse.send_bytes"></a>
<em class="property">coroutine </em><code class="descname">send_bytes</code><span class="sig-paren">(</span><em>data</em>, <em>compress=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.WebSocketResponse.send_bytes" title="Permalink to this definition">¶</a></dt>
<dd><p>Send <em>data</em> to peer as <a class="reference internal" href="websocket_utilities.html#aiohttp.WSMsgType.BINARY" title="aiohttp.WSMsgType.BINARY"><code class="xref py py-const docutils literal notranslate"><span class="pre">BINARY</span></code></a> message.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> – data to send.</li>
<li><strong>compress</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – sets specific level of compression for
single message,
<code class="docutils literal notranslate"><span class="pre">None</span></code> for not overriding per-socket setting.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.7)"><strong>RuntimeError</strong></a> – if connection is not started or closing</li>
<li><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.7)"><strong>TypeError</strong></a> – if data is not <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a>,
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytearray" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytearray</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#memoryview" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">memoryview</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.0: </span>The method is converted into <a class="reference external" href="https://docs.python.org/3/glossary.html#term-coroutine" title="(in Python v3.7)"><span class="xref std std-term">coroutine</span></a>,
<em>compress</em> parameter added.</p>
</div>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.WebSocketResponse.send_json"><a name="//apple_ref/cpp/Method/aiohttp.web.WebSocketResponse.send_json"></a>
<em class="property">coroutine </em><code class="descname">send_json</code><span class="sig-paren">(</span><em>data</em>, <em>compress=None</em>, <em>*</em>, <em>dumps=json.dumps</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.WebSocketResponse.send_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Send <em>data</em> to peer as JSON string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> – data to send.</li>
<li><strong>compress</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – sets specific level of compression for
single message,
<code class="docutils literal notranslate"><span class="pre">None</span></code> for not overriding per-socket setting.</li>
<li><strong>dumps</strong> (<em>callable</em>) – any <a class="reference internal" href="glossary.html#term-callable"><span class="xref std std-term">callable</span></a> that accepts an object and
returns a JSON string
(<a class="reference external" href="https://docs.python.org/3/library/json.html#json.dumps" title="(in Python v3.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">json.dumps()</span></code></a> by default).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.7)"><strong>RuntimeError</strong></a> – if connection is not started or closing</li>
<li><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.7)"><strong>ValueError</strong></a> – if data is not serializable object</li>
<li><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.7)"><strong>TypeError</strong></a> – if value returned by <code class="docutils literal notranslate"><span class="pre">dumps</span></code> param is not <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.0: </span>The method is converted into <a class="reference external" href="https://docs.python.org/3/glossary.html#term-coroutine" title="(in Python v3.7)"><span class="xref std std-term">coroutine</span></a>,
<em>compress</em> parameter added.</p>
</div>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.WebSocketResponse.close"><a name="//apple_ref/cpp/Method/aiohttp.web.WebSocketResponse.close"></a>
<em class="property">coroutine </em><code class="descname">close</code><span class="sig-paren">(</span><em>*</em>, <em>code=1000</em>, <em>message=b''</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.WebSocketResponse.close" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://docs.python.org/3/library/asyncio-task.html#coroutine" title="(in Python v3.7)"><span class="xref std std-ref">coroutine</span></a> that initiates closing
handshake by sending <a class="reference internal" href="websocket_utilities.html#aiohttp.WSMsgType.CLOSE" title="aiohttp.WSMsgType.CLOSE"><code class="xref py py-const docutils literal notranslate"><span class="pre">CLOSE</span></code></a> message.</p>
<p>It is safe to call <cite>close()</cite> from different task.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>code</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – closing code</li>
<li><strong>message</strong> – optional payload of <em>pong</em> message,
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> (converted to <em>UTF-8</em> encoded bytes)
or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.7)"><strong>RuntimeError</strong></a> – if connection is not started</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.WebSocketResponse.receive"><a name="//apple_ref/cpp/Method/aiohttp.web.WebSocketResponse.receive"></a>
<em class="property">coroutine </em><code class="descname">receive</code><span class="sig-paren">(</span><em>timeout=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.WebSocketResponse.receive" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://docs.python.org/3/library/asyncio-task.html#coroutine" title="(in Python v3.7)"><span class="xref std std-ref">coroutine</span></a> that waits upcoming <em>data</em>
message from peer and returns it.</p>
<p>The coroutine implicitly handles
<a class="reference internal" href="websocket_utilities.html#aiohttp.WSMsgType.PING" title="aiohttp.WSMsgType.PING"><code class="xref py py-const docutils literal notranslate"><span class="pre">PING</span></code></a>,
<a class="reference internal" href="websocket_utilities.html#aiohttp.WSMsgType.PONG" title="aiohttp.WSMsgType.PONG"><code class="xref py py-const docutils literal notranslate"><span class="pre">PONG</span></code></a> and
<a class="reference internal" href="websocket_utilities.html#aiohttp.WSMsgType.CLOSE" title="aiohttp.WSMsgType.CLOSE"><code class="xref py py-const docutils literal notranslate"><span class="pre">CLOSE</span></code></a> without returning the
message.</p>
<p>It process <em>ping-pong game</em> and performs <em>closing handshake</em> internally.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Can only be called by the request handling task.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>timeout</strong> – <p>timeout for <cite>receive</cite> operation.</p>
<p>timeout value overrides response`s receive_timeout attribute.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference internal" href="websocket_utilities.html#aiohttp.WSMessage" title="aiohttp.WSMessage"><code class="xref py py-class docutils literal notranslate"><span class="pre">WSMessage</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.7)"><strong>RuntimeError</strong></a> – if connection is not started</td>
</tr>
</tbody>
</table>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.WebSocketResponse.receive_str"><a name="//apple_ref/cpp/Method/aiohttp.web.WebSocketResponse.receive_str"></a>
<em class="property">coroutine </em><code class="descname">receive_str</code><span class="sig-paren">(</span><em>*</em>, <em>timeout=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.WebSocketResponse.receive_str" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://docs.python.org/3/library/asyncio-task.html#coroutine" title="(in Python v3.7)"><span class="xref std std-ref">coroutine</span></a> that calls <a class="reference internal" href="#aiohttp.web.WebSocketResponse.receive" title="aiohttp.web.WebSocketResponse.receive"><code class="xref py py-meth docutils literal notranslate"><span class="pre">receive()</span></code></a> but
also asserts the message type is <a class="reference internal" href="websocket_utilities.html#aiohttp.WSMsgType.TEXT" title="aiohttp.WSMsgType.TEXT"><code class="xref py py-const docutils literal notranslate"><span class="pre">TEXT</span></code></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Can only be called by the request handling task.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>timeout</strong> – <p>timeout for <cite>receive</cite> operation.</p>
<p>timeout value overrides response`s receive_timeout attribute.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return str:</th><td class="field-body">peer’s message content.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.7)"><strong>TypeError</strong></a> – if message is <a class="reference internal" href="websocket_utilities.html#aiohttp.WSMsgType.BINARY" title="aiohttp.WSMsgType.BINARY"><code class="xref py py-const docutils literal notranslate"><span class="pre">BINARY</span></code></a>.</td>
</tr>
</tbody>
</table>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.WebSocketResponse.receive_bytes"><a name="//apple_ref/cpp/Method/aiohttp.web.WebSocketResponse.receive_bytes"></a>
<em class="property">coroutine </em><code class="descname">receive_bytes</code><span class="sig-paren">(</span><em>*</em>, <em>timeout=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.WebSocketResponse.receive_bytes" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://docs.python.org/3/library/asyncio-task.html#coroutine" title="(in Python v3.7)"><span class="xref std std-ref">coroutine</span></a> that calls <a class="reference internal" href="#aiohttp.web.WebSocketResponse.receive" title="aiohttp.web.WebSocketResponse.receive"><code class="xref py py-meth docutils literal notranslate"><span class="pre">receive()</span></code></a> but
also asserts the message type is
<a class="reference internal" href="websocket_utilities.html#aiohttp.WSMsgType.BINARY" title="aiohttp.WSMsgType.BINARY"><code class="xref py py-const docutils literal notranslate"><span class="pre">BINARY</span></code></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Can only be called by the request handling task.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>timeout</strong> – <p>timeout for <cite>receive</cite> operation.</p>
<p>timeout value overrides response`s receive_timeout attribute.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return bytes:</th><td class="field-body">peer’s message content.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.7)"><strong>TypeError</strong></a> – if message is <a class="reference internal" href="websocket_utilities.html#aiohttp.WSMsgType.TEXT" title="aiohttp.WSMsgType.TEXT"><code class="xref py py-const docutils literal notranslate"><span class="pre">TEXT</span></code></a>.</td>
</tr>
</tbody>
</table>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.WebSocketResponse.receive_json"><a name="//apple_ref/cpp/Method/aiohttp.web.WebSocketResponse.receive_json"></a>
<em class="property">coroutine </em><code class="descname">receive_json</code><span class="sig-paren">(</span><em>*</em>, <em>loads=json.loads</em>, <em>timeout=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.WebSocketResponse.receive_json" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://docs.python.org/3/library/asyncio-task.html#coroutine" title="(in Python v3.7)"><span class="xref std std-ref">coroutine</span></a> that calls <a class="reference internal" href="#aiohttp.web.WebSocketResponse.receive_str" title="aiohttp.web.WebSocketResponse.receive_str"><code class="xref py py-meth docutils literal notranslate"><span class="pre">receive_str()</span></code></a> and loads the
JSON string to a Python dict.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Can only be called by the request handling task.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>loads</strong> (<em>callable</em>) – any <a class="reference internal" href="glossary.html#term-callable"><span class="xref std std-term">callable</span></a> that accepts
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> and returns <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>
with parsed JSON (<a class="reference external" href="https://docs.python.org/3/library/json.html#json.loads" title="(in Python v3.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">json.loads()</span></code></a> by
default).</li>
<li><strong>timeout</strong> – <p>timeout for <cite>receive</cite> operation.</p>
<p>timeout value overrides response`s receive_timeout attribute.</p>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return dict:</th><td class="field-body"><p class="first">loaded JSON content</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.7)"><strong>TypeError</strong></a> – if message is <a class="reference internal" href="websocket_utilities.html#aiohttp.WSMsgType.BINARY" title="aiohttp.WSMsgType.BINARY"><code class="xref py py-const docutils literal notranslate"><span class="pre">BINARY</span></code></a>.</li>
<li><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.7)"><strong>ValueError</strong></a> – if message is not valid JSON.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>
</dd></dl>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="web_quickstart.html#aiohttp-web-websockets"><span class="std std-ref">WebSockets handling</span></a></p>
</div>
</div>
<div class="section" id="websocketready">
<h3>WebSocketReady<a class="headerlink" href="#websocketready" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="aiohttp.web.WebSocketReady"><a name="//apple_ref/cpp/Class/aiohttp.web.WebSocketReady"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">WebSocketReady</code><a class="headerlink" href="#aiohttp.web.WebSocketReady" title="Permalink to this definition">¶</a></dt>
<dd><p>A named tuple for returning result from
<a class="reference internal" href="#aiohttp.web.WebSocketResponse.can_prepare" title="aiohttp.web.WebSocketResponse.can_prepare"><code class="xref py py-meth docutils literal notranslate"><span class="pre">WebSocketResponse.can_prepare()</span></code></a>.</p>
<p>Has <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a> check implemented, e.g.:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="ow">not</span> <span class="k">await</span> <span class="n">ws</span><span class="o">.</span><span class="n">can_prepare</span><span class="p">(</span><span class="o">...</span><span class="p">):</span>
    <span class="n">cannot_start_websocket</span><span class="p">()</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="aiohttp.web.WebSocketReady.ok"><a name="//apple_ref/cpp/Attribute/aiohttp.web.WebSocketReady.ok"></a>
<code class="descname">ok</code><a class="headerlink" href="#aiohttp.web.WebSocketReady.ok" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if websocket connection can be established, <code class="docutils literal notranslate"><span class="pre">False</span></code>
otherwise.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.WebSocketReady.protocol"><a name="//apple_ref/cpp/Attribute/aiohttp.web.WebSocketReady.protocol"></a>
<code class="descname">protocol</code><a class="headerlink" href="#aiohttp.web.WebSocketReady.protocol" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> represented selected websocket sub-protocol.</p>
</dd></dl>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#aiohttp.web.WebSocketResponse.can_prepare" title="aiohttp.web.WebSocketResponse.can_prepare"><code class="xref py py-meth docutils literal notranslate"><span class="pre">WebSocketResponse.can_prepare()</span></code></a></p>
</div>
</dd></dl>
</div>
</div>
<div class="section" id="json-response">
<h2>json_response<a class="headerlink" href="#json-response" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="aiohttp.web.json_response"><a name="//apple_ref/cpp/Function/aiohttp.web.json_response"></a>
<code class="descclassname">aiohttp.web.</code><code class="descname">json_response</code><span class="sig-paren">(</span><span class="optional">[</span><em>data</em>, <span class="optional">]</span><em>*</em>, <em>text=None</em>, <em>body=None</em>, <em>status=200</em>, <em>reason=None</em>, <em>headers=None</em>, <em>content_type='application/json'</em>, <em>dumps=json.dumps</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.json_response" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<p>Return <a class="reference internal" href="#aiohttp.web.Response" title="aiohttp.web.Response"><code class="xref py py-class docutils literal notranslate"><span class="pre">Response</span></code></a> with predefined <code class="docutils literal notranslate"><span class="pre">'application/json'</span></code>
content type and <em>data</em> encoded by <code class="docutils literal notranslate"><span class="pre">dumps</span></code> parameter
(<a class="reference external" href="https://docs.python.org/3/library/json.html#json.dumps" title="(in Python v3.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">json.dumps()</span></code></a> by default).</p>
</div>
<div class="section" id="application-and-router">
<span id="aiohttp-web-app-and-router"></span><h2>Application and Router<a class="headerlink" href="#application-and-router" title="Permalink to this headline">¶</a></h2>
<div class="section" id="application">
<h3>Application<a class="headerlink" href="#application" title="Permalink to this headline">¶</a></h3>
<p>Application is a synonym for web-server.</p>
<p>To get fully working example, you have to make <em>application</em>, register
supported urls in <em>router</em> and pass it to <a class="reference internal" href="#aiohttp.web.run_app" title="aiohttp.web.run_app"><code class="xref py py-func docutils literal notranslate"><span class="pre">aiohttp.web.run_app()</span></code></a>
or <a class="reference internal" href="#aiohttp.web.AppRunner" title="aiohttp.web.AppRunner"><code class="xref py py-class docutils literal notranslate"><span class="pre">aiohttp.web.AppRunner</span></code></a>.</p>
<p><em>Application</em> contains a <em>router</em> instance and a list of callbacks that
will be called during application finishing.</p>
<p><a class="reference internal" href="#aiohttp.web.Application" title="aiohttp.web.Application"><code class="xref py py-class docutils literal notranslate"><span class="pre">Application</span></code></a> is a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>-like object, so you can use it for
<a class="reference internal" href="web_advanced.html#aiohttp-web-data-sharing"><span class="std std-ref">sharing data</span></a> globally by storing arbitrary
properties for later access from a <a class="reference internal" href="web_quickstart.html#aiohttp-web-handler"><span class="std std-ref">handler</span></a> via the
<a class="reference internal" href="#aiohttp.web.Request.app" title="aiohttp.web.Request.app"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Request.app</span></code></a> property:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">app</span> <span class="o">=</span> <span class="n">Application</span><span class="p">()</span>
<span class="n">app</span><span class="p">[</span><span class="s1">'database'</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="n">aiopg</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="o">**</span><span class="n">db_config</span><span class="p">)</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">handler</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">with</span> <span class="p">(</span><span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s1">'database'</span><span class="p">])</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
        <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"DELETE * FROM table"</span><span class="p">)</span>
</pre></div>
</div>
<p>Although <a class="reference internal" href="#aiohttp.web.Application" title="aiohttp.web.Application"><code class="xref py py-class docutils literal notranslate"><span class="pre">Application</span></code></a> is a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>-like object, it can’t be
duplicated like one using <code class="xref py py-meth docutils literal notranslate"><span class="pre">Application.copy()</span></code>.</p>
<dl class="class">
<dt id="aiohttp.web.Application"><a name="//apple_ref/cpp/Class/aiohttp.web.Application"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">Application</code><span class="sig-paren">(</span><em>*</em>, <em>logger=&lt;default&gt;</em>, <em>router=None</em>, <em>middlewares=()</em>, <em>handler_args=None</em>, <em>client_max_size=1024**2</em>, <em>loop=None</em>, <em>debug=...</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.Application" title="Permalink to this definition">¶</a></dt>
<dd><p>The class inherits <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>logger</strong> – <p><a class="reference external" href="https://docs.python.org/3/library/logging.html#logging.Logger" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">logging.Logger</span></code></a> instance for storing application logs.</p>
<p>By default the value is <code class="docutils literal notranslate"><span class="pre">logging.getLogger("aiohttp.web")</span></code></p>
</li>
<li><strong>router</strong> – <dl class="docutils">
<dt><code class="xref py py-class docutils literal notranslate"><span class="pre">aiohttp.abc.AbstractRouter</span></code> instance, the system</dt>
<dd>creates <a class="reference internal" href="#aiohttp.web.UrlDispatcher" title="aiohttp.web.UrlDispatcher"><code class="xref py py-class docutils literal notranslate"><span class="pre">UrlDispatcher</span></code></a> by default if
<em>router</em> is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</dd>
</dl>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 3.3: </span>The custom routers support is deprecated, the parameter will
be removed in 4.0.</p>
</div>
</li>
<li><strong>middlewares</strong> – <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of middleware factories, see
<a class="reference internal" href="web_advanced.html#aiohttp-web-middlewares"><span class="std std-ref">Middlewares</span></a> for details.</li>
<li><strong>handler_args</strong> – dict-like object that overrides keyword arguments of
<a class="reference internal" href="#aiohttp.web.Application.make_handler" title="aiohttp.web.Application.make_handler"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Application.make_handler()</span></code></a></li>
<li><strong>client_max_size</strong> – client’s maximum size in a request, in
bytes.  If a POST request exceeds this
value, it raises an
<cite>HTTPRequestEntityTooLarge</cite> exception.</li>
<li><strong>loop</strong> – <p>event loop</p>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 2.0: </span>The parameter is deprecated. Loop is get set during freeze
stage.</p>
</div>
</li>
<li><strong>debug</strong> – Switches debug mode.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="aiohttp.web.Application.router"><a name="//apple_ref/cpp/Attribute/aiohttp.web.Application.router"></a>
<code class="descname">router</code><a class="headerlink" href="#aiohttp.web.Application.router" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-only property that returns <em>router instance</em>.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.Application.logger"><a name="//apple_ref/cpp/Attribute/aiohttp.web.Application.logger"></a>
<code class="descname">logger</code><a class="headerlink" href="#aiohttp.web.Application.logger" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/3/library/logging.html#logging.Logger" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">logging.Logger</span></code></a> instance for storing application logs.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.Application.loop"><a name="//apple_ref/cpp/Attribute/aiohttp.web.Application.loop"></a>
<code class="descname">loop</code><a class="headerlink" href="#aiohttp.web.Application.loop" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/3/library/asyncio-eventloop.html#asyncio-event-loop" title="(in Python v3.7)"><span class="xref std std-ref">event loop</span></a> used for processing HTTP requests.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.Application.debug"><a name="//apple_ref/cpp/Attribute/aiohttp.web.Application.debug"></a>
<code class="descname">debug</code><a class="headerlink" href="#aiohttp.web.Application.debug" title="Permalink to this definition">¶</a></dt>
<dd><p>Boolean value indicating whether the debug mode is turned on or off.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.Application.on_response_prepare"><a name="//apple_ref/cpp/Attribute/aiohttp.web.Application.on_response_prepare"></a>
<code class="descname">on_response_prepare</code><a class="headerlink" href="#aiohttp.web.Application.on_response_prepare" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="signals.html#aiohttp.Signal" title="aiohttp.Signal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal</span></code></a> that is fired at the beginning
of <a class="reference internal" href="#aiohttp.web.StreamResponse.prepare" title="aiohttp.web.StreamResponse.prepare"><code class="xref py py-meth docutils literal notranslate"><span class="pre">StreamResponse.prepare()</span></code></a> with parameters <em>request</em> and
<em>response</em>. It can be used, for example, to add custom headers to each
response before sending.</p>
<p>Signal handlers should have the following signature:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">on_prepare</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.Application.on_startup"><a name="//apple_ref/cpp/Attribute/aiohttp.web.Application.on_startup"></a>
<code class="descname">on_startup</code><a class="headerlink" href="#aiohttp.web.Application.on_startup" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="signals.html#aiohttp.Signal" title="aiohttp.Signal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal</span></code></a> that is fired on application start-up.</p>
<p>Subscribers may use the signal to run background tasks in the event
loop along with the application’s request handler just after the
application start-up.</p>
<p>Signal handlers should have the following signature:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">on_startup</span><span class="p">(</span><span class="n">app</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="web_advanced.html#aiohttp-web-signals"><span class="std std-ref">Signals</span></a>.</p>
</div>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.Application.on_shutdown"><a name="//apple_ref/cpp/Attribute/aiohttp.web.Application.on_shutdown"></a>
<code class="descname">on_shutdown</code><a class="headerlink" href="#aiohttp.web.Application.on_shutdown" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="signals.html#aiohttp.Signal" title="aiohttp.Signal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal</span></code></a> that is fired on application shutdown.</p>
<p>Subscribers may use the signal for gracefully closing long running
connections, e.g. websockets and data streaming.</p>
<p>Signal handlers should have the following signature:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">on_shutdown</span><span class="p">(</span><span class="n">app</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>It’s up to end user to figure out which <a class="reference internal" href="glossary.html#term-web-handler"><span class="xref std std-term">web-handler</span></a>s
are still alive and how to finish them properly.</p>
<p>We suggest keeping a list of long running handlers in
<a class="reference internal" href="#aiohttp.web.Application" title="aiohttp.web.Application"><code class="xref py py-class docutils literal notranslate"><span class="pre">Application</span></code></a> dictionary.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="web_advanced.html#aiohttp-web-graceful-shutdown"><span class="std std-ref">Graceful shutdown</span></a> and <a class="reference internal" href="#aiohttp.web.Application.on_cleanup" title="aiohttp.web.Application.on_cleanup"><code class="xref py py-attr docutils literal notranslate"><span class="pre">on_cleanup</span></code></a>.</p>
</div>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.Application.on_cleanup"><a name="//apple_ref/cpp/Attribute/aiohttp.web.Application.on_cleanup"></a>
<code class="descname">on_cleanup</code><a class="headerlink" href="#aiohttp.web.Application.on_cleanup" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="signals.html#aiohttp.Signal" title="aiohttp.Signal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal</span></code></a> that is fired on application cleanup.</p>
<p>Subscribers may use the signal for gracefully closing
connections to database server etc.</p>
<p>Signal handlers should have the following signature:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">on_cleanup</span><span class="p">(</span><span class="n">app</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="web_advanced.html#aiohttp-web-signals"><span class="std std-ref">Signals</span></a> and <a class="reference internal" href="#aiohttp.web.Application.on_shutdown" title="aiohttp.web.Application.on_shutdown"><code class="xref py py-attr docutils literal notranslate"><span class="pre">on_shutdown</span></code></a>.</p>
</div>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.Application.cleanup_ctx"><a name="//apple_ref/cpp/Attribute/aiohttp.web.Application.cleanup_ctx"></a>
<code class="descname">cleanup_ctx</code><a class="headerlink" href="#aiohttp.web.Application.cleanup_ctx" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of <em>context generators</em> for <em>startup</em>/<em>cleanup</em> handling.</p>
<p>Signal handlers should have the following signature:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">context</span><span class="p">(</span><span class="n">app</span><span class="p">):</span>
    <span class="c1"># do startup stuff</span>
    <span class="k">yield</span>
    <span class="c1"># do cleanup</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="web_advanced.html#aiohttp-web-cleanup-ctx"><span class="std std-ref">Cleanup Context</span></a>.</p>
</div>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.Application.add_subapp"><a name="//apple_ref/cpp/Method/aiohttp.web.Application.add_subapp"></a>
<code class="descname">add_subapp</code><span class="sig-paren">(</span><em>prefix</em>, <em>subapp</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.Application.add_subapp" title="Permalink to this definition">¶</a></dt>
<dd><p>Register nested sub-application under given path <em>prefix</em>.</p>
<p>In resolving process if request’s path starts with <em>prefix</em> then
further resolving is passed to <em>subapp</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – path’s prefix for the resource.</li>
<li><strong>subapp</strong> (<a class="reference internal" href="#aiohttp.web.Application" title="aiohttp.web.Application"><em>Application</em></a>) – nested application attached under <em>prefix</em>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a <a class="reference internal" href="#aiohttp.web.PrefixedSubAppResource" title="aiohttp.web.PrefixedSubAppResource"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrefixedSubAppResource</span></code></a> instance.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.Application.add_routes"><a name="//apple_ref/cpp/Method/aiohttp.web.Application.add_routes"></a>
<code class="descname">add_routes</code><span class="sig-paren">(</span><em>routes_table</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.Application.add_routes" title="Permalink to this definition">¶</a></dt>
<dd><p>Register route definitions from <em>routes_table</em>.</p>
<p>The table is a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference internal" href="#aiohttp.web.RouteDef" title="aiohttp.web.RouteDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">RouteDef</span></code></a> items or
<a class="reference internal" href="#aiohttp.web.RouteTableDef" title="aiohttp.web.RouteTableDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">RouteTableDef</span></code></a>.</p>
<p>The method is a shortcut for
<code class="docutils literal notranslate"><span class="pre">app.router.add_routes(routes_table)</span></code>, see also
<a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_routes" title="aiohttp.web.UrlDispatcher.add_routes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">UrlDispatcher.add_routes()</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.Application.make_handler"><a name="//apple_ref/cpp/Method/aiohttp.web.Application.make_handler"></a>
<code class="descname">make_handler</code><span class="sig-paren">(</span><em>loop=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.Application.make_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates HTTP protocol factory for handling requests.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>loop</strong> – <dl class="docutils">
<dt><a class="reference external" href="https://docs.python.org/3/library/asyncio-eventloop.html#asyncio-event-loop" title="(in Python v3.7)"><span class="xref std std-ref">event loop</span></a> used</dt>
<dd>for processing HTTP requests.<p class="last">If param is <code class="docutils literal notranslate"><span class="pre">None</span></code> <a class="reference external" href="https://docs.python.org/3/library/asyncio-eventloop.html#asyncio.get_event_loop" title="(in Python v3.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.get_event_loop()</span></code></a>
used for getting default event loop.</p>
</dd>
</dl>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 2.0.</span></p>
</div>
</li>
<li><strong>tcp_keepalive</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Enable TCP Keep-Alive. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code>.</li>
<li><strong>keepalive_timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of seconds before closing Keep-Alive
connection. Default: <code class="docutils literal notranslate"><span class="pre">75</span></code> seconds (NGINX’s default value).</li>
<li><strong>logger</strong> – Custom logger object. Default:
<code class="xref py py-data docutils literal notranslate"><span class="pre">aiohttp.log.server_logger</span></code>.</li>
<li><strong>access_log</strong> – Custom logging object. Default:
<code class="xref py py-data docutils literal notranslate"><span class="pre">aiohttp.log.access_logger</span></code>.</li>
<li><strong>access_log_class</strong> – class for <cite>access_logger</cite>. Default:
<code class="xref py py-data docutils literal notranslate"><span class="pre">aiohttp.helpers.AccessLogger</span></code>.
Must to be a subclass of <code class="xref py py-class docutils literal notranslate"><span class="pre">aiohttp.abc.AbstractAccessLogger</span></code>.</li>
<li><strong>access_log_format</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Access log format string. Default:
<code class="xref py py-attr docutils literal notranslate"><span class="pre">helpers.AccessLogger.LOG_FORMAT</span></code>.</li>
<li><strong>max_line_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Optional maximum header line size. Default:
<code class="docutils literal notranslate"><span class="pre">8190</span></code>.</li>
<li><strong>max_headers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Optional maximum header size. Default: <code class="docutils literal notranslate"><span class="pre">32768</span></code>.</li>
<li><strong>max_field_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Optional maximum header field size. Default:
<code class="docutils literal notranslate"><span class="pre">8190</span></code>.</li>
<li><strong>lingering_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – maximum time during which the server
reads and ignore additional data coming from the client when
lingering close is on.  Use <code class="docutils literal notranslate"><span class="pre">0</span></code> for disabling lingering on
server channel closing.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>You should pass result of the method as <em>protocol_factory</em> to
<code class="xref py py-meth docutils literal notranslate"><span class="pre">create_server()</span></code>, e.g.:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Application</span><span class="p">()</span>

<span class="c1"># setup route table</span>
<span class="c1"># app.router.add_route(...)</span>

<span class="k">await</span> <span class="n">loop</span><span class="o">.</span><span class="n">create_server</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">make_handler</span><span class="p">(),</span>
                         <span class="s1">'0.0.0.0'</span><span class="p">,</span> <span class="mi">8080</span><span class="p">)</span>
</pre></div>
</div>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 3.2: </span>The method is deprecated and will be removed in future
aiohttp versions.  Please use <a class="reference internal" href="web_advanced.html#aiohttp-web-app-runners"><span class="std std-ref">Application runners</span></a> instead.</p>
</div>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.Application.startup"><a name="//apple_ref/cpp/Method/aiohttp.web.Application.startup"></a>
<em class="property">coroutine </em><code class="descname">startup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.Application.startup" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://docs.python.org/3/library/asyncio-task.html#coroutine" title="(in Python v3.7)"><span class="xref std std-ref">coroutine</span></a> that will be called along with the
application’s request handler.</p>
<p>The purpose of the method is calling <a class="reference internal" href="#aiohttp.web.Application.on_startup" title="aiohttp.web.Application.on_startup"><code class="xref py py-attr docutils literal notranslate"><span class="pre">on_startup</span></code></a> signal
handlers.</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.Application.shutdown"><a name="//apple_ref/cpp/Method/aiohttp.web.Application.shutdown"></a>
<em class="property">coroutine </em><code class="descname">shutdown</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.Application.shutdown" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://docs.python.org/3/library/asyncio-task.html#coroutine" title="(in Python v3.7)"><span class="xref std std-ref">coroutine</span></a> that should be called on
server stopping but before <a class="reference internal" href="#aiohttp.web.Application.cleanup" title="aiohttp.web.Application.cleanup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cleanup()</span></code></a>.</p>
<p>The purpose of the method is calling <a class="reference internal" href="#aiohttp.web.Application.on_shutdown" title="aiohttp.web.Application.on_shutdown"><code class="xref py py-attr docutils literal notranslate"><span class="pre">on_shutdown</span></code></a> signal
handlers.</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.Application.cleanup"><a name="//apple_ref/cpp/Method/aiohttp.web.Application.cleanup"></a>
<em class="property">coroutine </em><code class="descname">cleanup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.Application.cleanup" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://docs.python.org/3/library/asyncio-task.html#coroutine" title="(in Python v3.7)"><span class="xref std std-ref">coroutine</span></a> that should be called on
server stopping but after <a class="reference internal" href="#aiohttp.web.Application.shutdown" title="aiohttp.web.Application.shutdown"><code class="xref py py-meth docutils literal notranslate"><span class="pre">shutdown()</span></code></a>.</p>
<p>The purpose of the method is calling <a class="reference internal" href="#aiohttp.web.Application.on_cleanup" title="aiohttp.web.Application.on_cleanup"><code class="xref py py-attr docutils literal notranslate"><span class="pre">on_cleanup</span></code></a> signal
handlers.</p>
</dd></dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Application object has <a class="reference internal" href="#aiohttp.web.Application.router" title="aiohttp.web.Application.router"><code class="xref py py-attr docutils literal notranslate"><span class="pre">router</span></code></a> attribute but has no
<code class="docutils literal notranslate"><span class="pre">add_route()</span></code> method. The reason is: we want to support
different router implementations (even maybe not url-matching
based but traversal ones).</p>
<p>For sake of that fact we have very trivial ABC for
<code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractRouter</span></code>: it should have only
<code class="xref py py-meth docutils literal notranslate"><span class="pre">AbstractRouter.resolve()</span></code> coroutine.</p>
<p class="last">No methods for adding routes or route reversing (getting URL by
route name). All those are router implementation details (but,
sure, you need to deal with that methods after choosing the
router for your application).</p>
</div>
</dd></dl>
</div>
<div class="section" id="server">
<h3>Server<a class="headerlink" href="#server" title="Permalink to this headline">¶</a></h3>
<p>A protocol factory compatible with
<code class="xref py py-meth docutils literal notranslate"><span class="pre">create_server()</span></code>.</p>
<blockquote>
<div><blockquote>
<div><dl class="class">
<dt id="aiohttp.web.Server"><a name="//apple_ref/cpp/Class/aiohttp.web.Server"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">Server</code><a class="headerlink" href="#aiohttp.web.Server" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
</div></blockquote>
<p>The class is responsible for creating HTTP protocol
objects that can handle HTTP connections.</p>
<dl class="attribute">
<dt id="aiohttp.web.Server.connections"><a name="//apple_ref/cpp/Attribute/aiohttp.web.Server.connections"></a>
<code class="descclassname">Server.</code><code class="descname">connections</code><a class="headerlink" href="#aiohttp.web.Server.connections" title="Permalink to this definition">¶</a></dt>
<dd><p>List of all currently opened connections.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.requests_count"><a name="//apple_ref/cpp/Attribute/aiohttp.web.requests_count"></a>
<code class="descclassname">aiohttp.web.</code><code class="descname">requests_count</code><a class="headerlink" href="#aiohttp.web.requests_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Amount of processed requests.</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.Server.shutdown"><a name="//apple_ref/cpp/Method/aiohttp.web.Server.shutdown"></a>
<em class="property">coroutine </em><code class="descclassname">Server.</code><code class="descname">shutdown</code><span class="sig-paren">(</span><em>timeout</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.Server.shutdown" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://docs.python.org/3/library/asyncio-task.html#coroutine" title="(in Python v3.7)"><span class="xref std std-ref">coroutine</span></a> that should be called to close all opened
connections.</p>
</dd></dl>
</div></blockquote>
</div>
<div class="section" id="router">
<h3>Router<a class="headerlink" href="#router" title="Permalink to this headline">¶</a></h3>
<p>For dispatching URLs to <a class="reference internal" href="web_quickstart.html#aiohttp-web-handler"><span class="std std-ref">handlers</span></a>
<a class="reference internal" href="#module-aiohttp.web" title="aiohttp.web"><code class="xref py py-mod docutils literal notranslate"><span class="pre">aiohttp.web</span></code></a> uses <em>routers</em>.</p>
<p>Router is any object that implements <code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractRouter</span></code> interface.</p>
<p><a class="reference internal" href="#module-aiohttp.web" title="aiohttp.web"><code class="xref py py-mod docutils literal notranslate"><span class="pre">aiohttp.web</span></code></a> provides an implementation called <a class="reference internal" href="#aiohttp.web.UrlDispatcher" title="aiohttp.web.UrlDispatcher"><code class="xref py py-class docutils literal notranslate"><span class="pre">UrlDispatcher</span></code></a>.</p>
<p><a class="reference internal" href="#aiohttp.web.Application" title="aiohttp.web.Application"><code class="xref py py-class docutils literal notranslate"><span class="pre">Application</span></code></a> uses <a class="reference internal" href="#aiohttp.web.UrlDispatcher" title="aiohttp.web.UrlDispatcher"><code class="xref py py-class docutils literal notranslate"><span class="pre">UrlDispatcher</span></code></a> as <code class="xref py py-meth docutils literal notranslate"><span class="pre">router()</span></code> by default.</p>
<dl class="class">
<dt id="aiohttp.web.UrlDispatcher"><a name="//apple_ref/cpp/Class/aiohttp.web.UrlDispatcher"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">UrlDispatcher</code><a class="headerlink" href="#aiohttp.web.UrlDispatcher" title="Permalink to this definition">¶</a></dt>
<dd><p>Straightforward url-matching router, implements
<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Mapping</span></code></a> for access to <em>named routes</em>.</p>
<p>Before running <a class="reference internal" href="#aiohttp.web.Application" title="aiohttp.web.Application"><code class="xref py py-class docutils literal notranslate"><span class="pre">Application</span></code></a> you should fill <em>route
table</em> first by calling <a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_route" title="aiohttp.web.UrlDispatcher.add_route"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_route()</span></code></a> and <a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_static" title="aiohttp.web.UrlDispatcher.add_static"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_static()</span></code></a>.</p>
<p><a class="reference internal" href="web_quickstart.html#aiohttp-web-handler"><span class="std std-ref">Handler</span></a> lookup is performed by iterating on
added <em>routes</em> in FIFO order. The first matching <em>route</em> will be used
to call corresponding <em>handler</em>.</p>
<p>If on route creation you specify <em>name</em> parameter the result is
<em>named route</em>.</p>
<p><em>Named route</em> can be retrieved by <code class="docutils literal notranslate"><span class="pre">app.router[name]</span></code> call, checked for
existence by <code class="docutils literal notranslate"><span class="pre">name</span> <span class="pre">in</span> <span class="pre">app.router</span></code> etc.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#aiohttp-web-route"><span class="std std-ref">Route classes</span></a></p>
</div>
<dl class="method">
<dt id="aiohttp.web.UrlDispatcher.add_resource"><a name="//apple_ref/cpp/Method/aiohttp.web.UrlDispatcher.add_resource"></a>
<code class="descname">add_resource</code><span class="sig-paren">(</span><em>path</em>, <em>*</em>, <em>name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.UrlDispatcher.add_resource" title="Permalink to this definition">¶</a></dt>
<dd><p>Append a <a class="reference internal" href="glossary.html#term-resource"><span class="xref std std-term">resource</span></a> to the end of route table.</p>
<p><em>path</em> may be either <em>constant</em> string like <code class="docutils literal notranslate"><span class="pre">'/a/b/c'</span></code> or
<em>variable rule</em> like <code class="docutils literal notranslate"><span class="pre">'/a/{var}'</span></code> (see
<a class="reference internal" href="web_quickstart.html#aiohttp-web-variable-handler"><span class="std std-ref">handling variable paths</span></a>)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – resource path spec.</li>
<li><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – optional resource name.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">created resource instance (<a class="reference internal" href="#aiohttp.web.PlainResource" title="aiohttp.web.PlainResource"><code class="xref py py-class docutils literal notranslate"><span class="pre">PlainResource</span></code></a> or
<a class="reference internal" href="#aiohttp.web.DynamicResource" title="aiohttp.web.DynamicResource"><code class="xref py py-class docutils literal notranslate"><span class="pre">DynamicResource</span></code></a>).</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.UrlDispatcher.add_route"><a name="//apple_ref/cpp/Method/aiohttp.web.UrlDispatcher.add_route"></a>
<code class="descname">add_route</code><span class="sig-paren">(</span><em>method</em>, <em>path</em>, <em>handler</em>, <em>*</em>, <em>name=None</em>, <em>expect_handler=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.UrlDispatcher.add_route" title="Permalink to this definition">¶</a></dt>
<dd><p>Append <a class="reference internal" href="web_quickstart.html#aiohttp-web-handler"><span class="std std-ref">handler</span></a> to the end of route table.</p>
<dl class="docutils">
<dt><em>path</em> may be either <em>constant</em> string like <code class="docutils literal notranslate"><span class="pre">'/a/b/c'</span></code> or</dt>
<dd><em>variable rule</em> like <code class="docutils literal notranslate"><span class="pre">'/a/{var}'</span></code> (see
<a class="reference internal" href="web_quickstart.html#aiohttp-web-variable-handler"><span class="std std-ref">handling variable paths</span></a>)</dd>
</dl>
<p>Pay attention please: <em>handler</em> is converted to coroutine internally when
it is a regular function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – <p>HTTP method for route. Should be one of
<code class="docutils literal notranslate"><span class="pre">'GET'</span></code>, <code class="docutils literal notranslate"><span class="pre">'POST'</span></code>, <code class="docutils literal notranslate"><span class="pre">'PUT'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'DELETE'</span></code>, <code class="docutils literal notranslate"><span class="pre">'PATCH'</span></code>, <code class="docutils literal notranslate"><span class="pre">'HEAD'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'OPTIONS'</span></code> or <code class="docutils literal notranslate"><span class="pre">'*'</span></code> for any method.</p>
<p>The parameter is case-insensitive, e.g. you
can push <code class="docutils literal notranslate"><span class="pre">'get'</span></code> as well as <code class="docutils literal notranslate"><span class="pre">'GET'</span></code>.</p>
</li>
<li><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – route path. Should be started with slash (<code class="docutils literal notranslate"><span class="pre">'/'</span></code>).</li>
<li><strong>handler</strong> (<em>callable</em>) – route handler.</li>
<li><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – optional route name.</li>
<li><strong>expect_handler</strong> (<em>coroutine</em>) – optional <em>expect</em> header handler.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">new <code class="xref py py-class docutils literal notranslate"><span class="pre">PlainRoute</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">DynamicRoute</span></code> instance.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.UrlDispatcher.add_routes"><a name="//apple_ref/cpp/Method/aiohttp.web.UrlDispatcher.add_routes"></a>
<code class="descname">add_routes</code><span class="sig-paren">(</span><em>routes_table</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.UrlDispatcher.add_routes" title="Permalink to this definition">¶</a></dt>
<dd><p>Register route definitions from <em>routes_table</em>.</p>
<p>The table is a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference internal" href="#aiohttp.web.RouteDef" title="aiohttp.web.RouteDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">RouteDef</span></code></a> items or
<a class="reference internal" href="#aiohttp.web.RouteTableDef" title="aiohttp.web.RouteTableDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">RouteTableDef</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.3.</span></p>
</div>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.UrlDispatcher.add_get"><a name="//apple_ref/cpp/Method/aiohttp.web.UrlDispatcher.add_get"></a>
<code class="descname">add_get</code><span class="sig-paren">(</span><em>path</em>, <em>handler</em>, <em>*</em>, <em>name=None</em>, <em>allow_head=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.UrlDispatcher.add_get" title="Permalink to this definition">¶</a></dt>
<dd><p>Shortcut for adding a GET handler. Calls the <a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_route" title="aiohttp.web.UrlDispatcher.add_route"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_route()</span></code></a> with <code class="docutils literal notranslate"><span class="pre">method</span></code> equals to <code class="docutils literal notranslate"><span class="pre">'GET'</span></code>.</p>
<p>If <em>allow_head</em> is <code class="docutils literal notranslate"><span class="pre">True</span></code> (default) the route for method HEAD
is added with the same handler as for GET.</p>
<p>If <em>name</em> is provided the name for HEAD route is suffixed with
<code class="docutils literal notranslate"><span class="pre">'-head'</span></code>. For example <code class="docutils literal notranslate"><span class="pre">router.add_get(path,</span> <span class="pre">handler,</span>
<span class="pre">name='route')</span></code> call adds two routes: first for GET with name
<code class="docutils literal notranslate"><span class="pre">'route'</span></code> and second for HEAD with name <code class="docutils literal notranslate"><span class="pre">'route-head'</span></code>.</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.UrlDispatcher.add_post"><a name="//apple_ref/cpp/Method/aiohttp.web.UrlDispatcher.add_post"></a>
<code class="descname">add_post</code><span class="sig-paren">(</span><em>path</em>, <em>handler</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.UrlDispatcher.add_post" title="Permalink to this definition">¶</a></dt>
<dd><p>Shortcut for adding a POST handler. Calls the <a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_route" title="aiohttp.web.UrlDispatcher.add_route"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_route()</span></code></a> with </p>
<p><code class="docutils literal notranslate"><span class="pre">method</span></code> equals to <code class="docutils literal notranslate"><span class="pre">'POST'</span></code>.</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.UrlDispatcher.add_head"><a name="//apple_ref/cpp/Method/aiohttp.web.UrlDispatcher.add_head"></a>
<code class="descname">add_head</code><span class="sig-paren">(</span><em>path</em>, <em>handler</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.UrlDispatcher.add_head" title="Permalink to this definition">¶</a></dt>
<dd><p>Shortcut for adding a HEAD handler. Calls the <a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_route" title="aiohttp.web.UrlDispatcher.add_route"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_route()</span></code></a> with <code class="docutils literal notranslate"><span class="pre">method</span></code> equals to <code class="docutils literal notranslate"><span class="pre">'HEAD'</span></code>.</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.UrlDispatcher.add_put"><a name="//apple_ref/cpp/Method/aiohttp.web.UrlDispatcher.add_put"></a>
<code class="descname">add_put</code><span class="sig-paren">(</span><em>path</em>, <em>handler</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.UrlDispatcher.add_put" title="Permalink to this definition">¶</a></dt>
<dd><p>Shortcut for adding a PUT handler. Calls the <a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_route" title="aiohttp.web.UrlDispatcher.add_route"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_route()</span></code></a> with <code class="docutils literal notranslate"><span class="pre">method</span></code> equals to <code class="docutils literal notranslate"><span class="pre">'PUT'</span></code>.</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.UrlDispatcher.add_patch"><a name="//apple_ref/cpp/Method/aiohttp.web.UrlDispatcher.add_patch"></a>
<code class="descname">add_patch</code><span class="sig-paren">(</span><em>path</em>, <em>handler</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.UrlDispatcher.add_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>Shortcut for adding a PATCH handler. Calls the <a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_route" title="aiohttp.web.UrlDispatcher.add_route"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_route()</span></code></a> with <code class="docutils literal notranslate"><span class="pre">method</span></code> equals to <code class="docutils literal notranslate"><span class="pre">'PATCH'</span></code>.</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.UrlDispatcher.add_delete"><a name="//apple_ref/cpp/Method/aiohttp.web.UrlDispatcher.add_delete"></a>
<code class="descname">add_delete</code><span class="sig-paren">(</span><em>path</em>, <em>handler</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.UrlDispatcher.add_delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Shortcut for adding a DELETE handler. Calls the <a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_route" title="aiohttp.web.UrlDispatcher.add_route"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_route()</span></code></a> with <code class="docutils literal notranslate"><span class="pre">method</span></code> equals to <code class="docutils literal notranslate"><span class="pre">'DELETE'</span></code>.</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.UrlDispatcher.add_view"><a name="//apple_ref/cpp/Method/aiohttp.web.UrlDispatcher.add_view"></a>
<code class="descname">add_view</code><span class="sig-paren">(</span><em>path</em>, <em>handler</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.UrlDispatcher.add_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Shortcut for adding a class-based view handler. Calls the <a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_route" title="aiohttp.web.UrlDispatcher.add_route"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_route()</span></code></a> with <code class="docutils literal notranslate"><span class="pre">method</span></code> equals to <code class="docutils literal notranslate"><span class="pre">'*'</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.0.</span></p>
</div>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.UrlDispatcher.add_static"><a name="//apple_ref/cpp/Method/aiohttp.web.UrlDispatcher.add_static"></a>
<code class="descname">add_static</code><span class="sig-paren">(</span><em>prefix</em>, <em>path</em>, <em>*</em>, <em>name=None</em>, <em>expect_handler=None</em>, <em>chunk_size=256*1024</em>, <em>response_factory=StreamResponse</em>, <em>show_index=False</em>, <em>follow_symlinks=False</em>, <em>append_version=False</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.UrlDispatcher.add_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a router and a handler for returning static files.</p>
<p>Useful for serving static content like images, javascript and css files.</p>
<p>On platforms that support it, the handler will transfer files more
efficiently using the <code class="docutils literal notranslate"><span class="pre">sendfile</span></code> system call.</p>
<p>In some situations it might be necessary to avoid using the <code class="docutils literal notranslate"><span class="pre">sendfile</span></code>
system call even if the platform supports it. This can be accomplished by
by setting environment variable <code class="docutils literal notranslate"><span class="pre">AIOHTTP_NOSENDFILE=1</span></code>.</p>
<p>If a gzip version of the static content exists at file path + <code class="docutils literal notranslate"><span class="pre">.gz</span></code>, it
will be used for the response.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Use <a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_static" title="aiohttp.web.UrlDispatcher.add_static"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_static()</span></code></a> for development only. In production,
static content should be processed by web servers like <em>nginx</em>
or <em>apache</em>.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – URL path prefix for handled static files</li>
<li><strong>path</strong> – path to the folder in file system that contains
handled static files, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pathlib.Path</span></code></a>.</li>
<li><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – optional route name.</li>
<li><strong>expect_handler</strong> (<em>coroutine</em>) – optional <em>expect</em> header handler.</li>
<li><strong>chunk_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – <p>size of single chunk for file
downloading, 256Kb by default.</p>
<p>Increasing <em>chunk_size</em> parameter to,
say, 1Mb may increase file downloading
speed but consumes more memory.</p>
</li>
<li><strong>show_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – flag for allowing to show indexes of a directory,
by default it’s not allowed and HTTP/403 will
be returned on directory access.</li>
<li><strong>follow_symlinks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – flag for allowing to follow symlinks from
a directory, by default it’s not allowed and
HTTP/404 will be returned on access.</li>
<li><strong>append_version</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – flag for adding file version (hash)
to the url query string, this value will
be used as default when you call to
<code class="xref py py-meth docutils literal notranslate"><span class="pre">StaticRoute.url()</span></code> and
<code class="xref py py-meth docutils literal notranslate"><span class="pre">StaticRoute.url_for()</span></code> methods.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">new <code class="xref py py-class docutils literal notranslate"><span class="pre">StaticRoute</span></code> instance.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.UrlDispatcher.resolve"><a name="//apple_ref/cpp/Method/aiohttp.web.UrlDispatcher.resolve"></a>
<em class="property">coroutine </em><code class="descname">resolve</code><span class="sig-paren">(</span><em>request</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.UrlDispatcher.resolve" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://docs.python.org/3/library/asyncio-task.html#coroutine" title="(in Python v3.7)"><span class="xref std std-ref">coroutine</span></a> that returns
<code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractMatchInfo</span></code> for <em>request</em>.</p>
<p>The method never raises exception, but returns
<code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractMatchInfo</span></code> instance with:</p>
<ol class="arabic">
<li><p class="first"><code class="xref py py-attr docutils literal notranslate"><span class="pre">http_exception</span></code> assigned to
<code class="xref py py-exc docutils literal notranslate"><span class="pre">HTTPException</span></code> instance.</p>
</li>
<li><p class="first"><code class="xref py py-attr docutils literal notranslate"><span class="pre">handler</span></code> which raises
<code class="xref py py-exc docutils literal notranslate"><span class="pre">HTTPNotFound</span></code> or <code class="xref py py-exc docutils literal notranslate"><span class="pre">HTTPMethodNotAllowed</span></code> on handler’s
execution if there is no registered route for <em>request</em>.</p>
<p><em>Middlewares</em> can process that exceptions to render
pretty-looking error page for example.</p>
</li>
</ol>
<p>Used by internal machinery, end user unlikely need to call the method.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The method uses <code class="xref py py-attr docutils literal notranslate"><span class="pre">Request.raw_path</span></code> for pattern
matching against registered routes.</p>
</div>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.UrlDispatcher.resources"><a name="//apple_ref/cpp/Method/aiohttp.web.UrlDispatcher.resources"></a>
<code class="descname">resources</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.UrlDispatcher.resources" title="Permalink to this definition">¶</a></dt>
<dd><p>The method returns a <em>view</em> for <em>all</em> registered resources.</p>
<p>The view is an object that allows to:</p>
<ol class="arabic">
<li><p class="first">Get size of the router table:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">router</span><span class="o">.</span><span class="n">resources</span><span class="p">())</span>
</pre></div>
</div>
</li>
<li><p class="first">Iterate over registered resources:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">resource</span> <span class="ow">in</span> <span class="n">app</span><span class="o">.</span><span class="n">router</span><span class="o">.</span><span class="n">resources</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">Make a check if the resources is registered in the router table:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">route</span> <span class="ow">in</span> <span class="n">app</span><span class="o">.</span><span class="n">router</span><span class="o">.</span><span class="n">resources</span><span class="p">()</span>
</pre></div>
</div>
</li>
</ol>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.UrlDispatcher.routes"><a name="//apple_ref/cpp/Method/aiohttp.web.UrlDispatcher.routes"></a>
<code class="descname">routes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.UrlDispatcher.routes" title="Permalink to this definition">¶</a></dt>
<dd><p>The method returns a <em>view</em> for <em>all</em> registered routes.</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.UrlDispatcher.named_resources"><a name="//apple_ref/cpp/Method/aiohttp.web.UrlDispatcher.named_resources"></a>
<code class="descname">named_resources</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.UrlDispatcher.named_resources" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>-like <a class="reference external" href="https://docs.python.org/3/library/types.html#types.MappingProxyType" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">types.MappingProxyType</span></code></a> <em>view</em> over
<em>all</em> named <strong>resources</strong>.</p>
<p>The view maps every named resource’s <strong>name</strong> to the
<code class="xref py py-class docutils literal notranslate"><span class="pre">BaseResource</span></code> instance. It supports the usual
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>-like operations, except for any mutable operations
(i.e. it’s <strong>read-only</strong>):</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">router</span><span class="o">.</span><span class="n">named_resources</span><span class="p">())</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">resource</span> <span class="ow">in</span> <span class="n">app</span><span class="o">.</span><span class="n">router</span><span class="o">.</span><span class="n">named_resources</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">resource</span><span class="p">)</span>

<span class="s2">"name"</span> <span class="ow">in</span> <span class="n">app</span><span class="o">.</span><span class="n">router</span><span class="o">.</span><span class="n">named_resources</span><span class="p">()</span>

<span class="n">app</span><span class="o">.</span><span class="n">router</span><span class="o">.</span><span class="n">named_resources</span><span class="p">()[</span><span class="s2">"name"</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>
</dd></dl>
</div>
<div class="section" id="resource">
<span id="aiohttp-web-resource"></span><h3>Resource<a class="headerlink" href="#resource" title="Permalink to this headline">¶</a></h3>
<p>Default router <a class="reference internal" href="#aiohttp.web.UrlDispatcher" title="aiohttp.web.UrlDispatcher"><code class="xref py py-class docutils literal notranslate"><span class="pre">UrlDispatcher</span></code></a> operates with <a class="reference internal" href="glossary.html#term-resource"><span class="xref std std-term">resource</span></a>s.</p>
<p>Resource is an item in <em>routing table</em> which has a <em>path</em>, an optional
unique <em>name</em> and at least one <a class="reference internal" href="glossary.html#term-route"><span class="xref std std-term">route</span></a>.</p>
<p><a class="reference internal" href="glossary.html#term-web-handler"><span class="xref std std-term">web-handler</span></a> lookup is performed in the following way:</p>
<ol class="arabic simple">
<li>Router iterates over <em>resources</em> one-by-one.</li>
<li>If <em>resource</em> matches to requested URL the resource iterates over
own <em>routes</em>.</li>
<li>If route matches to requested HTTP method (or <code class="docutils literal notranslate"><span class="pre">'*'</span></code> wildcard) the
route’s handler is used as found <a class="reference internal" href="glossary.html#term-web-handler"><span class="xref std std-term">web-handler</span></a>. The lookup is
finished.</li>
<li>Otherwise router tries next resource from the <em>routing table</em>.</li>
<li>If the end of <em>routing table</em> is reached and no <em>resource</em> /
<em>route</em> pair found the <em>router</em> returns special <code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractMatchInfo</span></code>
instance with <code class="xref py py-attr docutils literal notranslate"><span class="pre">AbstractMatchInfo.http_exception</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>
but <code class="xref py py-exc docutils literal notranslate"><span class="pre">HTTPException</span></code> with  either <em>HTTP 404 Not Found</em> or
<em>HTTP 405 Method Not Allowed</em> status code.
Registered <code class="xref py py-attr docutils literal notranslate"><span class="pre">AbstractMatchInfo.handler</span></code> raises this exception on call.</li>
</ol>
<p>User should never instantiate resource classes but give it by
<a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_resource" title="aiohttp.web.UrlDispatcher.add_resource"><code class="xref py py-meth docutils literal notranslate"><span class="pre">UrlDispatcher.add_resource()</span></code></a> call.</p>
<p>After that he may add a <a class="reference internal" href="glossary.html#term-route"><span class="xref std std-term">route</span></a> by calling <a class="reference internal" href="#aiohttp.web.Resource.add_route" title="aiohttp.web.Resource.add_route"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Resource.add_route()</span></code></a>.</p>
<p><a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_route" title="aiohttp.web.UrlDispatcher.add_route"><code class="xref py py-meth docutils literal notranslate"><span class="pre">UrlDispatcher.add_route()</span></code></a> is just shortcut for:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">router</span><span class="o">.</span><span class="n">add_resource</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">add_route</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">handler</span><span class="p">)</span>
</pre></div>
</div>
<p>Resource with a <em>name</em> is called <em>named resource</em>.
The main purpose of <em>named resource</em> is constructing URL by route name for
passing it into <em>template engine</em> for example:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">router</span><span class="p">[</span><span class="s1">'resource_name'</span><span class="p">]</span><span class="o">.</span><span class="n">url_for</span><span class="p">()</span><span class="o">.</span><span class="n">with_query</span><span class="p">({</span><span class="s1">'a'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
</pre></div>
</div>
<p>Resource classes hierarchy:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">AbstractResource</span>
  <span class="n">Resource</span>
    <span class="n">PlainResource</span>
    <span class="n">DynamicResource</span>
    <span class="n">StaticResource</span>
</pre></div>
</div>
<dl class="class">
<dt id="aiohttp.web.AbstractResource"><a name="//apple_ref/cpp/Class/aiohttp.web.AbstractResource"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">AbstractResource</code><a class="headerlink" href="#aiohttp.web.AbstractResource" title="Permalink to this definition">¶</a></dt>
<dd><p>A base class for all resources.</p>
<p>Inherited from <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sized" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Sized</span></code></a> and
<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Iterable</span></code></a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">len(resource)</span></code> returns amount of <a class="reference internal" href="glossary.html#term-route"><span class="xref std std-term">route</span></a>s belongs to the resource,
<code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">route</span> <span class="pre">in</span> <span class="pre">resource</span></code> allows to iterate over these routes.</p>
<dl class="attribute">
<dt id="aiohttp.web.AbstractResource.name"><a name="//apple_ref/cpp/Attribute/aiohttp.web.AbstractResource.name"></a>
<code class="descname">name</code><a class="headerlink" href="#aiohttp.web.AbstractResource.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-only <em>name</em> of resource or <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.AbstractResource.canonical"><a name="//apple_ref/cpp/Attribute/aiohttp.web.AbstractResource.canonical"></a>
<code class="descname">canonical</code><a class="headerlink" href="#aiohttp.web.AbstractResource.canonical" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-only <em>canonical path</em> associate with the resource. For example
<code class="docutils literal notranslate"><span class="pre">/path/to</span></code> or <code class="docutils literal notranslate"><span class="pre">/path/{to}</span></code></p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.3.</span></p>
</div>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.AbstractResource.resolve"><a name="//apple_ref/cpp/Method/aiohttp.web.AbstractResource.resolve"></a>
<em class="property">coroutine </em><code class="descname">resolve</code><span class="sig-paren">(</span><em>request</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.AbstractResource.resolve" title="Permalink to this definition">¶</a></dt>
<dd><p>Resolve resource by finding appropriate <a class="reference internal" href="glossary.html#term-web-handler"><span class="xref std std-term">web-handler</span></a> for
<code class="docutils literal notranslate"><span class="pre">(method,</span> <span class="pre">path)</span></code> combination.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(<em>match_info</em>, <em>allowed_methods</em>) pair.<p><em>allowed_methods</em> is a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code></a> or HTTP methods accepted by
resource.</p>
<p><em>match_info</em> is either <a class="reference internal" href="#aiohttp.web.UrlMappingMatchInfo" title="aiohttp.web.UrlMappingMatchInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">UrlMappingMatchInfo</span></code></a> if
request is resolved or <code class="docutils literal notranslate"><span class="pre">None</span></code> if no <a class="reference internal" href="glossary.html#term-route"><span class="xref std std-term">route</span></a> is
found.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.AbstractResource.get_info"><a name="//apple_ref/cpp/Method/aiohttp.web.AbstractResource.get_info"></a>
<code class="descname">get_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.AbstractResource.get_info" title="Permalink to this definition">¶</a></dt>
<dd><p>A resource description, e.g. <code class="docutils literal notranslate"><span class="pre">{'path':</span> <span class="pre">'/path/to'}</span></code> or
<code class="docutils literal notranslate"><span class="pre">{'formatter':</span> <span class="pre">'/path/{to}',</span> <span class="pre">'pattern':</span>
<span class="pre">re.compile(r'^/path/(?P&lt;to&gt;[a-zA-Z][_a-zA-Z0-9]+)$</span></code></p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.AbstractResource.url_for"><a name="//apple_ref/cpp/Method/aiohttp.web.AbstractResource.url_for"></a>
<code class="descname">url_for</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.AbstractResource.url_for" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an URL for route with additional params.</p>
<p><em>args</em> and <strong>kwargs</strong> depend on a parameters list accepted by
inherited resource class.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="https://yarl.readthedocs.io/en/stable/api.html#yarl.URL" title="(in yarl v1.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">URL</span></code></a> – resulting URL instance.</td>
</tr>
</tbody>
</table>
</dd></dl>
</dd></dl>
<dl class="class">
<dt id="aiohttp.web.Resource"><a name="//apple_ref/cpp/Class/aiohttp.web.Resource"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">Resource</code><a class="headerlink" href="#aiohttp.web.Resource" title="Permalink to this definition">¶</a></dt>
<dd><p>A base class for new-style resources, inherits <a class="reference internal" href="#aiohttp.web.AbstractResource" title="aiohttp.web.AbstractResource"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractResource</span></code></a>.</p>
<dl class="method">
<dt id="aiohttp.web.Resource.add_route"><a name="//apple_ref/cpp/Method/aiohttp.web.Resource.add_route"></a>
<code class="descname">add_route</code><span class="sig-paren">(</span><em>method</em>, <em>handler</em>, <em>*</em>, <em>expect_handler=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.Resource.add_route" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a <a class="reference internal" href="glossary.html#term-web-handler"><span class="xref std std-term">web-handler</span></a> to resource.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – <p>HTTP method for route. Should be one of
<code class="docutils literal notranslate"><span class="pre">'GET'</span></code>, <code class="docutils literal notranslate"><span class="pre">'POST'</span></code>, <code class="docutils literal notranslate"><span class="pre">'PUT'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'DELETE'</span></code>, <code class="docutils literal notranslate"><span class="pre">'PATCH'</span></code>, <code class="docutils literal notranslate"><span class="pre">'HEAD'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'OPTIONS'</span></code> or <code class="docutils literal notranslate"><span class="pre">'*'</span></code> for any method.</p>
<p>The parameter is case-insensitive, e.g. you
can push <code class="docutils literal notranslate"><span class="pre">'get'</span></code> as well as <code class="docutils literal notranslate"><span class="pre">'GET'</span></code>.</p>
<p>The method should be unique for resource.</p>
</li>
<li><strong>handler</strong> (<em>callable</em>) – route handler.</li>
<li><strong>expect_handler</strong> (<em>coroutine</em>) – optional <em>expect</em> header handler.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">new <a class="reference internal" href="#aiohttp.web.ResourceRoute" title="aiohttp.web.ResourceRoute"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceRoute</span></code></a> instance.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>
</dd></dl>
<dl class="class">
<dt id="aiohttp.web.PlainResource"><a name="//apple_ref/cpp/Class/aiohttp.web.PlainResource"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">PlainResource</code><a class="headerlink" href="#aiohttp.web.PlainResource" title="Permalink to this definition">¶</a></dt>
<dd><p>A resource, inherited from <a class="reference internal" href="#aiohttp.web.Resource" title="aiohttp.web.Resource"><code class="xref py py-class docutils literal notranslate"><span class="pre">Resource</span></code></a>.</p>
<p>The class corresponds to resources with plain-text matching,
<code class="docutils literal notranslate"><span class="pre">'/path/to'</span></code> for example.</p>
<dl class="attribute">
<dt id="aiohttp.web.PlainResource.canonical"><a name="//apple_ref/cpp/Attribute/aiohttp.web.PlainResource.canonical"></a>
<code class="descname">canonical</code><a class="headerlink" href="#aiohttp.web.PlainResource.canonical" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-only <em>canonical path</em> associate with the resource. Returns the path
used to create the PlainResource. For example <code class="docutils literal notranslate"><span class="pre">/path/to</span></code></p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.3.</span></p>
</div>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.PlainResource.url_for"><a name="//apple_ref/cpp/Method/aiohttp.web.PlainResource.url_for"></a>
<code class="descname">url_for</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.PlainResource.url_for" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <a class="reference external" href="https://yarl.readthedocs.io/en/stable/api.html#yarl.URL" title="(in yarl v1.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">URL</span></code></a> for the resource.</p>
</dd></dl>
</dd></dl>
<dl class="class">
<dt id="aiohttp.web.DynamicResource"><a name="//apple_ref/cpp/Class/aiohttp.web.DynamicResource"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">DynamicResource</code><a class="headerlink" href="#aiohttp.web.DynamicResource" title="Permalink to this definition">¶</a></dt>
<dd><p>A resource, inherited from <a class="reference internal" href="#aiohttp.web.Resource" title="aiohttp.web.Resource"><code class="xref py py-class docutils literal notranslate"><span class="pre">Resource</span></code></a>.</p>
<p>The class corresponds to resources with
<a class="reference internal" href="web_quickstart.html#aiohttp-web-variable-handler"><span class="std std-ref">variable</span></a> matching,
e.g. <code class="docutils literal notranslate"><span class="pre">'/path/{to}/{param}'</span></code> etc.</p>
<dl class="attribute">
<dt id="aiohttp.web.DynamicResource.canonical"><a name="//apple_ref/cpp/Attribute/aiohttp.web.DynamicResource.canonical"></a>
<code class="descname">canonical</code><a class="headerlink" href="#aiohttp.web.DynamicResource.canonical" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-only <em>canonical path</em> associate with the resource. Returns the
formatter obtained from the path used to create the DynamicResource.
For example, from a path <code class="docutils literal notranslate"><span class="pre">/get/{num:^\d+}</span></code>, it returns <code class="docutils literal notranslate"><span class="pre">/get/{num}</span></code></p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.3.</span></p>
</div>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.DynamicResource.url_for"><a name="//apple_ref/cpp/Method/aiohttp.web.DynamicResource.url_for"></a>
<code class="descname">url_for</code><span class="sig-paren">(</span><em>**params</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.DynamicResource.url_for" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <a class="reference external" href="https://yarl.readthedocs.io/en/stable/api.html#yarl.URL" title="(in yarl v1.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">URL</span></code></a> for the resource.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>params</strong> – <p>– a variable substitutions for dynamic resource.</p>
<p>E.g. for <code class="docutils literal notranslate"><span class="pre">'/path/{to}/{param}'</span></code> pattern the method should
be called as <code class="docutils literal notranslate"><span class="pre">resource.url_for(to='val1',</span> <span class="pre">param='val2')</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>
</dd></dl>
<dl class="class">
<dt id="aiohttp.web.StaticResource"><a name="//apple_ref/cpp/Class/aiohttp.web.StaticResource"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">StaticResource</code><a class="headerlink" href="#aiohttp.web.StaticResource" title="Permalink to this definition">¶</a></dt>
<dd><p>A resource, inherited from <a class="reference internal" href="#aiohttp.web.Resource" title="aiohttp.web.Resource"><code class="xref py py-class docutils literal notranslate"><span class="pre">Resource</span></code></a>.</p>
<p>The class corresponds to resources for <a class="reference internal" href="web_advanced.html#aiohttp-web-static-file-handling"><span class="std std-ref">static file serving</span></a>.</p>
<dl class="attribute">
<dt id="aiohttp.web.StaticResource.canonical"><a name="//apple_ref/cpp/Attribute/aiohttp.web.StaticResource.canonical"></a>
<code class="descname">canonical</code><a class="headerlink" href="#aiohttp.web.StaticResource.canonical" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-only <em>canonical path</em> associate with the resource. Returns the prefix
used to create the StaticResource. For example <code class="docutils literal notranslate"><span class="pre">/prefix</span></code></p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.3.</span></p>
</div>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.StaticResource.url_for"><a name="//apple_ref/cpp/Method/aiohttp.web.StaticResource.url_for"></a>
<code class="descname">url_for</code><span class="sig-paren">(</span><em>filename</em>, <em>append_version=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.StaticResource.url_for" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <a class="reference external" href="https://yarl.readthedocs.io/en/stable/api.html#yarl.URL" title="(in yarl v1.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">URL</span></code></a> for file path under resource prefix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> – <p>– a file name substitution for static file handler.</p>
<p>Accepts both <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> and <a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pathlib.Path</span></code></a>.</p>
<p>E.g. an URL for <code class="docutils literal notranslate"><span class="pre">'/prefix/dir/file.txt'</span></code> should
be generated as <code class="docutils literal notranslate"><span class="pre">resource.url_for(filename='dir/file.txt')</span></code></p>
</li>
<li><strong>append_version</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – <dl class="docutils">
<dt>– a flag for adding file version</dt>
<dd>(hash) to the url query string for
cache boosting</dd>
</dl>
<p>By default has value from an constructor (<code class="docutils literal notranslate"><span class="pre">False</span></code> by default)
When set to <code class="docutils literal notranslate"><span class="pre">True</span></code> - <code class="docutils literal notranslate"><span class="pre">v=FILE_HASH</span></code> query string param will be added
When set to <code class="docutils literal notranslate"><span class="pre">False</span></code> has no impact</p>
<p>if file not found has no impact</p>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>
</dd></dl>
<dl class="class">
<dt id="aiohttp.web.PrefixedSubAppResource"><a name="//apple_ref/cpp/Class/aiohttp.web.PrefixedSubAppResource"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">PrefixedSubAppResource</code><a class="headerlink" href="#aiohttp.web.PrefixedSubAppResource" title="Permalink to this definition">¶</a></dt>
<dd><p>A resource for serving nested applications. The class instance is
returned by <a class="reference internal" href="#aiohttp.web.Application.add_subapp" title="aiohttp.web.Application.add_subapp"><code class="xref py py-class docutils literal notranslate"><span class="pre">add_subapp</span></code></a> call.</p>
<dl class="attribute">
<dt id="aiohttp.web.PrefixedSubAppResource.canonical"><a name="//apple_ref/cpp/Attribute/aiohttp.web.PrefixedSubAppResource.canonical"></a>
<code class="descname">canonical</code><a class="headerlink" href="#aiohttp.web.PrefixedSubAppResource.canonical" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-only <em>canonical path</em> associate with the resource. Returns the
prefix used to create the PrefixedSubAppResource.
For example <code class="docutils literal notranslate"><span class="pre">/prefix</span></code></p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.3.</span></p>
</div>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.PrefixedSubAppResource.url_for"><a name="//apple_ref/cpp/Method/aiohttp.web.PrefixedSubAppResource.url_for"></a>
<code class="descname">url_for</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.PrefixedSubAppResource.url_for" title="Permalink to this definition">¶</a></dt>
<dd><p>The call is not allowed, it raises <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.7)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">RuntimeError</span></code></a>.</p>
</dd></dl>
</dd></dl>
</div>
<div class="section" id="route">
<span id="aiohttp-web-route"></span><h3>Route<a class="headerlink" href="#route" title="Permalink to this headline">¶</a></h3>
<p>Route has <em>HTTP method</em> (wildcard <code class="docutils literal notranslate"><span class="pre">'*'</span></code> is an option),
<a class="reference internal" href="glossary.html#term-web-handler"><span class="xref std std-term">web-handler</span></a> and optional <em>expect handler</em>.</p>
<p>Every route belong to some resource.</p>
<p>Route classes hierarchy:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">AbstractRoute</span>
  <span class="n">ResourceRoute</span>
  <span class="n">SystemRoute</span>
</pre></div>
</div>
<p><a class="reference internal" href="#aiohttp.web.ResourceRoute" title="aiohttp.web.ResourceRoute"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceRoute</span></code></a> is the route used for resources,
<a class="reference internal" href="#aiohttp.web.SystemRoute" title="aiohttp.web.SystemRoute"><code class="xref py py-class docutils literal notranslate"><span class="pre">SystemRoute</span></code></a> serves URL resolving errors like <em>404 Not Found</em>
and <em>405 Method Not Allowed</em>.</p>
<dl class="class">
<dt id="aiohttp.web.AbstractRoute"><a name="//apple_ref/cpp/Class/aiohttp.web.AbstractRoute"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">AbstractRoute</code><a class="headerlink" href="#aiohttp.web.AbstractRoute" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for routes served by <a class="reference internal" href="#aiohttp.web.UrlDispatcher" title="aiohttp.web.UrlDispatcher"><code class="xref py py-class docutils literal notranslate"><span class="pre">UrlDispatcher</span></code></a>.</p>
<dl class="attribute">
<dt id="aiohttp.web.AbstractRoute.method"><a name="//apple_ref/cpp/Attribute/aiohttp.web.AbstractRoute.method"></a>
<code class="descname">method</code><a class="headerlink" href="#aiohttp.web.AbstractRoute.method" title="Permalink to this definition">¶</a></dt>
<dd><p>HTTP method handled by the route, e.g. <em>GET</em>, <em>POST</em> etc.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.AbstractRoute.handler"><a name="//apple_ref/cpp/Attribute/aiohttp.web.AbstractRoute.handler"></a>
<code class="descname">handler</code><a class="headerlink" href="#aiohttp.web.AbstractRoute.handler" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="web_quickstart.html#aiohttp-web-handler"><span class="std std-ref">handler</span></a> that processes the route.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.AbstractRoute.name"><a name="//apple_ref/cpp/Attribute/aiohttp.web.AbstractRoute.name"></a>
<code class="descname">name</code><a class="headerlink" href="#aiohttp.web.AbstractRoute.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the route, always equals to name of resource which owns the route.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.AbstractRoute.resource"><a name="//apple_ref/cpp/Attribute/aiohttp.web.AbstractRoute.resource"></a>
<code class="descname">resource</code><a class="headerlink" href="#aiohttp.web.AbstractRoute.resource" title="Permalink to this definition">¶</a></dt>
<dd><p>Resource instance which holds the route, <code class="docutils literal notranslate"><span class="pre">None</span></code> for
<a class="reference internal" href="#aiohttp.web.SystemRoute" title="aiohttp.web.SystemRoute"><code class="xref py py-class docutils literal notranslate"><span class="pre">SystemRoute</span></code></a>.</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.AbstractRoute.url_for"><a name="//apple_ref/cpp/Method/aiohttp.web.AbstractRoute.url_for"></a>
<code class="descname">url_for</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.AbstractRoute.url_for" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract method for constructing url handled by the route.</p>
<p>Actually it’s a shortcut for <code class="docutils literal notranslate"><span class="pre">route.resource.url_for(...)</span></code>.</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.AbstractRoute.handle_expect_header"><a name="//apple_ref/cpp/Method/aiohttp.web.AbstractRoute.handle_expect_header"></a>
<em class="property">coroutine </em><code class="descname">handle_expect_header</code><span class="sig-paren">(</span><em>request</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.AbstractRoute.handle_expect_header" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">100-continue</span></code> handler.</p>
</dd></dl>
</dd></dl>
<dl class="class">
<dt id="aiohttp.web.ResourceRoute"><a name="//apple_ref/cpp/Class/aiohttp.web.ResourceRoute"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">ResourceRoute</code><a class="headerlink" href="#aiohttp.web.ResourceRoute" title="Permalink to this definition">¶</a></dt>
<dd><p>The route class for handling different HTTP methods for <a class="reference internal" href="#aiohttp.web.Resource" title="aiohttp.web.Resource"><code class="xref py py-class docutils literal notranslate"><span class="pre">Resource</span></code></a>.</p>
</dd></dl>
<dl class="class">
<dt id="aiohttp.web.SystemRoute"><a name="//apple_ref/cpp/Class/aiohttp.web.SystemRoute"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">SystemRoute</code><a class="headerlink" href="#aiohttp.web.SystemRoute" title="Permalink to this definition">¶</a></dt>
<dd><p>The route class for handling URL resolution errors like like <em>404 Not Found</em>
and <em>405 Method Not Allowed</em>.</p>
<dl class="attribute">
<dt id="aiohttp.web.SystemRoute.status"><a name="//apple_ref/cpp/Attribute/aiohttp.web.SystemRoute.status"></a>
<code class="descname">status</code><a class="headerlink" href="#aiohttp.web.SystemRoute.status" title="Permalink to this definition">¶</a></dt>
<dd><p>HTTP status code</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.SystemRoute.reason"><a name="//apple_ref/cpp/Attribute/aiohttp.web.SystemRoute.reason"></a>
<code class="descname">reason</code><a class="headerlink" href="#aiohttp.web.SystemRoute.reason" title="Permalink to this definition">¶</a></dt>
<dd><p>HTTP status reason</p>
</dd></dl>
</dd></dl>
</div>
<div class="section" id="routedef-and-staticdef">
<span id="aiohttp-web-route-def"></span><h3>RouteDef and StaticDef<a class="headerlink" href="#routedef-and-staticdef" title="Permalink to this headline">¶</a></h3>
<p>Route definition, a description for not registered yet route.</p>
<p>Could be used for filing route table by providing a list of route
definitions (Django style).</p>
<p>The definition is created by functions like <a class="reference internal" href="#aiohttp.web.get" title="aiohttp.web.get"><code class="xref py py-func docutils literal notranslate"><span class="pre">get()</span></code></a> or
<a class="reference internal" href="#aiohttp.web.post" title="aiohttp.web.post"><code class="xref py py-func docutils literal notranslate"><span class="pre">post()</span></code></a>, list of definitions could be added to router by
<a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_routes" title="aiohttp.web.UrlDispatcher.add_routes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">UrlDispatcher.add_routes()</span></code></a> call:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">aiohttp</span> <span class="k">import</span> <span class="n">web</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">handle_get</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="o">...</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">handle_post</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="o">...</span>

<span class="n">app</span><span class="o">.</span><span class="n">router</span><span class="o">.</span><span class="n">add_routes</span><span class="p">([</span><span class="n">web</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'/get'</span><span class="p">,</span> <span class="n">handle_get</span><span class="p">),</span>
                       <span class="n">web</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s1">'/post'</span><span class="p">,</span> <span class="n">handle_post</span><span class="p">),</span>
</pre></div>
</div>
<dl class="class">
<dt id="aiohttp.web.AbstractRouteDef"><a name="//apple_ref/cpp/Class/aiohttp.web.AbstractRouteDef"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">AbstractRouteDef</code><a class="headerlink" href="#aiohttp.web.AbstractRouteDef" title="Permalink to this definition">¶</a></dt>
<dd><p>A base class for route definitions.</p>
<p>Inherited from <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
<dl class="method">
<dt id="aiohttp.web.AbstractRouteDef.register"><a name="//apple_ref/cpp/Method/aiohttp.web.AbstractRouteDef.register"></a>
<code class="descname">register</code><span class="sig-paren">(</span><em>router</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.AbstractRouteDef.register" title="Permalink to this definition">¶</a></dt>
<dd><p>Register itself into <a class="reference internal" href="#aiohttp.web.UrlDispatcher" title="aiohttp.web.UrlDispatcher"><code class="xref py py-class docutils literal notranslate"><span class="pre">UrlDispatcher</span></code></a>.</p>
<p>Abstract method, should be overridden by subclasses.</p>
</dd></dl>
</dd></dl>
<dl class="class">
<dt id="aiohttp.web.RouteDef"><a name="//apple_ref/cpp/Class/aiohttp.web.RouteDef"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">RouteDef</code><a class="headerlink" href="#aiohttp.web.RouteDef" title="Permalink to this definition">¶</a></dt>
<dd><p>A definition of not registered yet route.</p>
<p>Implements <a class="reference internal" href="#aiohttp.web.AbstractRouteDef" title="aiohttp.web.AbstractRouteDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractRouteDef</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.3.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.1: </span>The class implements <a class="reference internal" href="#aiohttp.web.AbstractRouteDef" title="aiohttp.web.AbstractRouteDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractRouteDef</span></code></a> interface.</p>
</div>
<dl class="attribute">
<dt id="aiohttp.web.RouteDef.method"><a name="//apple_ref/cpp/Attribute/aiohttp.web.RouteDef.method"></a>
<code class="descname">method</code><a class="headerlink" href="#aiohttp.web.RouteDef.method" title="Permalink to this definition">¶</a></dt>
<dd><p>HTTP method (<code class="docutils literal notranslate"><span class="pre">GET</span></code>, <code class="docutils literal notranslate"><span class="pre">POST</span></code> etc.)  (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>).</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.RouteDef.path"><a name="//apple_ref/cpp/Attribute/aiohttp.web.RouteDef.path"></a>
<code class="descname">path</code><a class="headerlink" href="#aiohttp.web.RouteDef.path" title="Permalink to this definition">¶</a></dt>
<dd><p>Path to resource, e.g. <code class="docutils literal notranslate"><span class="pre">/path/to</span></code>. Could contain <code class="docutils literal notranslate"><span class="pre">{}</span></code>
brackets for <a class="reference internal" href="web_quickstart.html#aiohttp-web-variable-handler"><span class="std std-ref">variable resources</span></a> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>).</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.RouteDef.handler"><a name="//apple_ref/cpp/Attribute/aiohttp.web.RouteDef.handler"></a>
<code class="descname">handler</code><a class="headerlink" href="#aiohttp.web.RouteDef.handler" title="Permalink to this definition">¶</a></dt>
<dd><p>An async function to handle HTTP request.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.RouteDef.kwargs"><a name="//apple_ref/cpp/Attribute/aiohttp.web.RouteDef.kwargs"></a>
<code class="descname">kwargs</code><a class="headerlink" href="#aiohttp.web.RouteDef.kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> of additional arguments.</p>
</dd></dl>
</dd></dl>
<dl class="class">
<dt id="aiohttp.web.StaticDef"><a name="//apple_ref/cpp/Class/aiohttp.web.StaticDef"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">StaticDef</code><a class="headerlink" href="#aiohttp.web.StaticDef" title="Permalink to this definition">¶</a></dt>
<dd><p>A definition of static file resource.</p>
<p>Implements <a class="reference internal" href="#aiohttp.web.AbstractRouteDef" title="aiohttp.web.AbstractRouteDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractRouteDef</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
<dl class="attribute">
<dt id="aiohttp.web.StaticDef.prefix"><a name="//apple_ref/cpp/Attribute/aiohttp.web.StaticDef.prefix"></a>
<code class="descname">prefix</code><a class="headerlink" href="#aiohttp.web.StaticDef.prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>A prefix used for static file handling, e.g. <code class="docutils literal notranslate"><span class="pre">/static</span></code>.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.StaticDef.path"><a name="//apple_ref/cpp/Attribute/aiohttp.web.StaticDef.path"></a>
<code class="descname">path</code><a class="headerlink" href="#aiohttp.web.StaticDef.path" title="Permalink to this definition">¶</a></dt>
<dd><p>File system directory to serve, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> or
<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pathlib.Path</span></code></a>
(e.g. <code class="docutils literal notranslate"><span class="pre">'/home/web-service/path/to/static'</span></code>.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.StaticDef.kwargs"><a name="//apple_ref/cpp/Attribute/aiohttp.web.StaticDef.kwargs"></a>
<code class="descname">kwargs</code><a class="headerlink" href="#aiohttp.web.StaticDef.kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> of additional arguments, see
<a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_static" title="aiohttp.web.UrlDispatcher.add_static"><code class="xref py py-meth docutils literal notranslate"><span class="pre">UrlDispatcher.add_static()</span></code></a> for a list of supported
options.</p>
</dd></dl>
</dd></dl>
<dl class="function">
<dt id="aiohttp.web.get"><a name="//apple_ref/cpp/Function/aiohttp.web.get"></a>
<code class="descclassname">aiohttp.web.</code><code class="descname">get</code><span class="sig-paren">(</span><em>path</em>, <em>handler</em>, <em>*</em>, <em>name=None</em>, <em>allow_head=True</em>, <em>expect_handler=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <a class="reference internal" href="#aiohttp.web.RouteDef" title="aiohttp.web.RouteDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">RouteDef</span></code></a> for processing <code class="docutils literal notranslate"><span class="pre">GET</span></code> requests. See
<a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_get" title="aiohttp.web.UrlDispatcher.add_get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">UrlDispatcher.add_get()</span></code></a> for information about parameters.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.3.</span></p>
</div>
</dd></dl>
<dl class="function">
<dt id="aiohttp.web.post"><a name="//apple_ref/cpp/Function/aiohttp.web.post"></a>
<code class="descclassname">aiohttp.web.</code><code class="descname">post</code><span class="sig-paren">(</span><em>path</em>, <em>handler</em>, <em>*</em>, <em>name=None</em>, <em>expect_handler=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.post" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <a class="reference internal" href="#aiohttp.web.RouteDef" title="aiohttp.web.RouteDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">RouteDef</span></code></a> for processing <code class="docutils literal notranslate"><span class="pre">POST</span></code> requests. See
<a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_post" title="aiohttp.web.UrlDispatcher.add_post"><code class="xref py py-meth docutils literal notranslate"><span class="pre">UrlDispatcher.add_post()</span></code></a> for information about parameters.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.3.</span></p>
</div>
</dd></dl>
<dl class="function">
<dt id="aiohttp.web.head"><a name="//apple_ref/cpp/Function/aiohttp.web.head"></a>
<code class="descclassname">aiohttp.web.</code><code class="descname">head</code><span class="sig-paren">(</span><em>path</em>, <em>handler</em>, <em>*</em>, <em>name=None</em>, <em>expect_handler=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.head" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <a class="reference internal" href="#aiohttp.web.RouteDef" title="aiohttp.web.RouteDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">RouteDef</span></code></a> for processing <code class="docutils literal notranslate"><span class="pre">HEAD</span></code> requests. See
<a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_head" title="aiohttp.web.UrlDispatcher.add_head"><code class="xref py py-meth docutils literal notranslate"><span class="pre">UrlDispatcher.add_head()</span></code></a> for information about parameters.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.3.</span></p>
</div>
</dd></dl>
<dl class="function">
<dt id="aiohttp.web.put"><a name="//apple_ref/cpp/Function/aiohttp.web.put"></a>
<code class="descclassname">aiohttp.web.</code><code class="descname">put</code><span class="sig-paren">(</span><em>path</em>, <em>handler</em>, <em>*</em>, <em>name=None</em>, <em>expect_handler=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.put" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <a class="reference internal" href="#aiohttp.web.RouteDef" title="aiohttp.web.RouteDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">RouteDef</span></code></a> for processing <code class="docutils literal notranslate"><span class="pre">PUT</span></code> requests. See
<a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_put" title="aiohttp.web.UrlDispatcher.add_put"><code class="xref py py-meth docutils literal notranslate"><span class="pre">UrlDispatcher.add_put()</span></code></a> for information about parameters.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.3.</span></p>
</div>
</dd></dl>
<dl class="function">
<dt id="aiohttp.web.patch"><a name="//apple_ref/cpp/Function/aiohttp.web.patch"></a>
<code class="descclassname">aiohttp.web.</code><code class="descname">patch</code><span class="sig-paren">(</span><em>path</em>, <em>handler</em>, <em>*</em>, <em>name=None</em>, <em>expect_handler=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.patch" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <a class="reference internal" href="#aiohttp.web.RouteDef" title="aiohttp.web.RouteDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">RouteDef</span></code></a> for processing <code class="docutils literal notranslate"><span class="pre">PATCH</span></code> requests. See
<a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_patch" title="aiohttp.web.UrlDispatcher.add_patch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">UrlDispatcher.add_patch()</span></code></a> for information about parameters.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.3.</span></p>
</div>
</dd></dl>
<dl class="function">
<dt id="aiohttp.web.delete"><a name="//apple_ref/cpp/Function/aiohttp.web.delete"></a>
<code class="descclassname">aiohttp.web.</code><code class="descname">delete</code><span class="sig-paren">(</span><em>path</em>, <em>handler</em>, <em>*</em>, <em>name=None</em>, <em>expect_handler=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <a class="reference internal" href="#aiohttp.web.RouteDef" title="aiohttp.web.RouteDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">RouteDef</span></code></a> for processing <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> requests. See
<a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_delete" title="aiohttp.web.UrlDispatcher.add_delete"><code class="xref py py-meth docutils literal notranslate"><span class="pre">UrlDispatcher.add_delete()</span></code></a> for information about parameters.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.3.</span></p>
</div>
</dd></dl>
<dl class="function">
<dt id="aiohttp.web.view"><a name="//apple_ref/cpp/Function/aiohttp.web.view"></a>
<code class="descclassname">aiohttp.web.</code><code class="descname">view</code><span class="sig-paren">(</span><em>path</em>, <em>handler</em>, <em>*</em>, <em>name=None</em>, <em>expect_handler=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.view" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <a class="reference internal" href="#aiohttp.web.RouteDef" title="aiohttp.web.RouteDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">RouteDef</span></code></a> for processing <code class="docutils literal notranslate"><span class="pre">ANY</span></code> requests. See
<a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_view" title="aiohttp.web.UrlDispatcher.add_view"><code class="xref py py-meth docutils literal notranslate"><span class="pre">UrlDispatcher.add_view()</span></code></a> for information about parameters.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.0.</span></p>
</div>
</dd></dl>
<dl class="function">
<dt id="aiohttp.web.static"><a name="//apple_ref/cpp/Function/aiohttp.web.static"></a>
<code class="descclassname">aiohttp.web.</code><code class="descname">static</code><span class="sig-paren">(</span><em>prefix</em>, <em>path</em>, <em>*</em>, <em>name=None</em>, <em>expect_handler=None</em>, <em>chunk_size=256*1024</em>, <em>show_index=False</em>, <em>follow_symlinks=False</em>, <em>append_version=False</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.static" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <a class="reference internal" href="#aiohttp.web.StaticDef" title="aiohttp.web.StaticDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">StaticDef</span></code></a> for processing static files.</p>
<p>See <a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_static" title="aiohttp.web.UrlDispatcher.add_static"><code class="xref py py-meth docutils literal notranslate"><span class="pre">UrlDispatcher.add_static()</span></code></a> for information
about supported parameters.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
</dd></dl>
<dl class="function">
<dt id="aiohttp.web.route"><a name="//apple_ref/cpp/Function/aiohttp.web.route"></a>
<code class="descclassname">aiohttp.web.</code><code class="descname">route</code><span class="sig-paren">(</span><em>method</em>, <em>path</em>, <em>handler</em>, <em>*</em>, <em>name=None</em>, <em>expect_handler=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.route" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <a class="reference internal" href="#aiohttp.web.RouteDef" title="aiohttp.web.RouteDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">RouteDef</span></code></a> for processing requests that decided by
<code class="docutils literal notranslate"><span class="pre">method</span></code>. See <a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_route" title="aiohttp.web.UrlDispatcher.add_route"><code class="xref py py-meth docutils literal notranslate"><span class="pre">UrlDispatcher.add_route()</span></code></a> for information
about parameters.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.3.</span></p>
</div>
</dd></dl>
</div>
<div class="section" id="routetabledef">
<span id="aiohttp-web-route-table-def"></span><h3>RouteTableDef<a class="headerlink" href="#routetabledef" title="Permalink to this headline">¶</a></h3>
<p>A routes table definition used for describing routes by decorators
(Flask style):</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">aiohttp</span> <span class="k">import</span> <span class="n">web</span>

<span class="n">routes</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">RouteTableDef</span><span class="p">()</span>

<span class="nd">@routes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'/get'</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">handle_get</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="o">...</span>


<span class="nd">@routes</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s1">'/post'</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">handle_post</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="o">...</span>

<span class="n">app</span><span class="o">.</span><span class="n">router</span><span class="o">.</span><span class="n">add_routes</span><span class="p">(</span><span class="n">routes</span><span class="p">)</span>


<span class="nd">@routes</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="s2">"/view"</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">MyView</span><span class="p">(</span><span class="n">web</span><span class="o">.</span><span class="n">View</span><span class="p">):</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="o">...</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="o">...</span>
</pre></div>
</div>
<dl class="class">
<dt id="aiohttp.web.RouteTableDef"><a name="//apple_ref/cpp/Class/aiohttp.web.RouteTableDef"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">RouteTableDef</code><a class="headerlink" href="#aiohttp.web.RouteTableDef" title="Permalink to this definition">¶</a></dt>
<dd><p>A sequence of <a class="reference internal" href="#aiohttp.web.RouteDef" title="aiohttp.web.RouteDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">RouteDef</span></code></a> instances (implements
<code class="xref py py-class docutils literal notranslate"><span class="pre">abc.collections.Sequence</span></code> protocol).</p>
<p>In addition to all standard <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> methods the class
provides also methods like <code class="docutils literal notranslate"><span class="pre">get()</span></code> and <code class="docutils literal notranslate"><span class="pre">post()</span></code> for adding new
route definition.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.3.</span></p>
</div>
<dl class="method">
<dt id="aiohttp.web.RouteTableDef.get"><a name="//apple_ref/cpp/Method/aiohttp.web.RouteTableDef.get"></a>
<code class="descclassname">@</code><code class="descname">get</code><span class="sig-paren">(</span><em>path</em>, <em>*</em>, <em>allow_head=True</em>, <em>name=None</em>, <em>expect_handler=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.RouteTableDef.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new <a class="reference internal" href="#aiohttp.web.RouteDef" title="aiohttp.web.RouteDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">RouteDef</span></code></a> item for registering <code class="docutils literal notranslate"><span class="pre">GET</span></code> web-handler.</p>
<p>See <a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_get" title="aiohttp.web.UrlDispatcher.add_get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">UrlDispatcher.add_get()</span></code></a> for information about parameters.</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.RouteTableDef.post"><a name="//apple_ref/cpp/Method/aiohttp.web.RouteTableDef.post"></a>
<code class="descclassname">@</code><code class="descname">post</code><span class="sig-paren">(</span><em>path</em>, <em>*</em>, <em>name=None</em>, <em>expect_handler=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.RouteTableDef.post" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new <a class="reference internal" href="#aiohttp.web.RouteDef" title="aiohttp.web.RouteDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">RouteDef</span></code></a> item for registering <code class="docutils literal notranslate"><span class="pre">POST</span></code> web-handler.</p>
<p>See <a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_post" title="aiohttp.web.UrlDispatcher.add_post"><code class="xref py py-meth docutils literal notranslate"><span class="pre">UrlDispatcher.add_post()</span></code></a> for information about parameters.</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.RouteTableDef.head"><a name="//apple_ref/cpp/Method/aiohttp.web.RouteTableDef.head"></a>
<code class="descclassname">@</code><code class="descname">head</code><span class="sig-paren">(</span><em>path</em>, <em>*</em>, <em>name=None</em>, <em>expect_handler=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.RouteTableDef.head" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new <a class="reference internal" href="#aiohttp.web.RouteDef" title="aiohttp.web.RouteDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">RouteDef</span></code></a> item for registering <code class="docutils literal notranslate"><span class="pre">HEAD</span></code> web-handler.</p>
<p>See <a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_head" title="aiohttp.web.UrlDispatcher.add_head"><code class="xref py py-meth docutils literal notranslate"><span class="pre">UrlDispatcher.add_head()</span></code></a> for information about parameters.</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.RouteTableDef.put"><a name="//apple_ref/cpp/Method/aiohttp.web.RouteTableDef.put"></a>
<code class="descclassname">@</code><code class="descname">put</code><span class="sig-paren">(</span><em>path</em>, <em>*</em>, <em>name=None</em>, <em>expect_handler=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.RouteTableDef.put" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new <a class="reference internal" href="#aiohttp.web.RouteDef" title="aiohttp.web.RouteDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">RouteDef</span></code></a> item for registering <code class="docutils literal notranslate"><span class="pre">PUT</span></code> web-handler.</p>
<p>See <a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_put" title="aiohttp.web.UrlDispatcher.add_put"><code class="xref py py-meth docutils literal notranslate"><span class="pre">UrlDispatcher.add_put()</span></code></a> for information about parameters.</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.RouteTableDef.patch"><a name="//apple_ref/cpp/Method/aiohttp.web.RouteTableDef.patch"></a>
<code class="descclassname">@</code><code class="descname">patch</code><span class="sig-paren">(</span><em>path</em>, <em>*</em>, <em>name=None</em>, <em>expect_handler=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.RouteTableDef.patch" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new <a class="reference internal" href="#aiohttp.web.RouteDef" title="aiohttp.web.RouteDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">RouteDef</span></code></a> item for registering <code class="docutils literal notranslate"><span class="pre">PATCH</span></code> web-handler.</p>
<p>See <a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_patch" title="aiohttp.web.UrlDispatcher.add_patch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">UrlDispatcher.add_patch()</span></code></a> for information about parameters.</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.RouteTableDef.delete"><a name="//apple_ref/cpp/Method/aiohttp.web.RouteTableDef.delete"></a>
<code class="descclassname">@</code><code class="descname">delete</code><span class="sig-paren">(</span><em>path</em>, <em>*</em>, <em>name=None</em>, <em>expect_handler=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.RouteTableDef.delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new <a class="reference internal" href="#aiohttp.web.RouteDef" title="aiohttp.web.RouteDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">RouteDef</span></code></a> item for registering <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> web-handler.</p>
<p>See <a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_delete" title="aiohttp.web.UrlDispatcher.add_delete"><code class="xref py py-meth docutils literal notranslate"><span class="pre">UrlDispatcher.add_delete()</span></code></a> for information about parameters.</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.RouteTableDef.view"><a name="//apple_ref/cpp/Method/aiohttp.web.RouteTableDef.view"></a>
<code class="descclassname">@</code><code class="descname">view</code><span class="sig-paren">(</span><em>path</em>, <em>*</em>, <em>name=None</em>, <em>expect_handler=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.RouteTableDef.view" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new <a class="reference internal" href="#aiohttp.web.RouteDef" title="aiohttp.web.RouteDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">RouteDef</span></code></a> item for registering <code class="docutils literal notranslate"><span class="pre">ANY</span></code> methods
against a class-based view.</p>
<p>See <a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_view" title="aiohttp.web.UrlDispatcher.add_view"><code class="xref py py-meth docutils literal notranslate"><span class="pre">UrlDispatcher.add_view()</span></code></a> for information about parameters.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.0.</span></p>
</div>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.RouteTableDef.static"><a name="//apple_ref/cpp/Method/aiohttp.web.RouteTableDef.static"></a>
<code class="descname">static</code><span class="sig-paren">(</span><em>prefix</em>, <em>path</em>, <em>*</em>, <em>name=None</em>, <em>expect_handler=None</em>, <em>chunk_size=256*1024</em>, <em>show_index=False</em>, <em>follow_symlinks=False</em>, <em>append_version=False</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.RouteTableDef.static" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new <a class="reference internal" href="#aiohttp.web.StaticDef" title="aiohttp.web.StaticDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">StaticDef</span></code></a> item for registering static files processor.</p>
<p>See <a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_static" title="aiohttp.web.UrlDispatcher.add_static"><code class="xref py py-meth docutils literal notranslate"><span class="pre">UrlDispatcher.add_static()</span></code></a> for information about
supported parameters.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.RouteTableDef.route"><a name="//apple_ref/cpp/Method/aiohttp.web.RouteTableDef.route"></a>
<code class="descclassname">@</code><code class="descname">route</code><span class="sig-paren">(</span><em>method</em>, <em>path</em>, <em>*</em>, <em>name=None</em>, <em>expect_handler=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.RouteTableDef.route" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new <a class="reference internal" href="#aiohttp.web.RouteDef" title="aiohttp.web.RouteDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">RouteDef</span></code></a> item for registering a web-handler
for arbitrary HTTP method.</p>
<p>See <a class="reference internal" href="#aiohttp.web.UrlDispatcher.add_route" title="aiohttp.web.UrlDispatcher.add_route"><code class="xref py py-meth docutils literal notranslate"><span class="pre">UrlDispatcher.add_route()</span></code></a> for information about parameters.</p>
</dd></dl>
</dd></dl>
</div>
<div class="section" id="matchinfo">
<h3>MatchInfo<a class="headerlink" href="#matchinfo" title="Permalink to this headline">¶</a></h3>
<p>After route matching web application calls found handler if any.</p>
<p>Matching result can be accessible from handler as
<a class="reference internal" href="#aiohttp.web.Request.match_info" title="aiohttp.web.Request.match_info"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Request.match_info</span></code></a> attribute.</p>
<p>In general the result may be any object derived from
<code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractMatchInfo</span></code> (<a class="reference internal" href="#aiohttp.web.UrlMappingMatchInfo" title="aiohttp.web.UrlMappingMatchInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">UrlMappingMatchInfo</span></code></a> for default
<a class="reference internal" href="#aiohttp.web.UrlDispatcher" title="aiohttp.web.UrlDispatcher"><code class="xref py py-class docutils literal notranslate"><span class="pre">UrlDispatcher</span></code></a> router).</p>
<dl class="class">
<dt id="aiohttp.web.UrlMappingMatchInfo"><a name="//apple_ref/cpp/Class/aiohttp.web.UrlMappingMatchInfo"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">UrlMappingMatchInfo</code><a class="headerlink" href="#aiohttp.web.UrlMappingMatchInfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Inherited from <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> and <code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractMatchInfo</span></code>. Dict
items are filled by matching info and is <a class="reference internal" href="glossary.html#term-resource"><span class="xref std std-term">resource</span></a>-specific.</p>
<dl class="attribute">
<dt id="aiohttp.web.UrlMappingMatchInfo.expect_handler"><a name="//apple_ref/cpp/Attribute/aiohttp.web.UrlMappingMatchInfo.expect_handler"></a>
<code class="descname">expect_handler</code><a class="headerlink" href="#aiohttp.web.UrlMappingMatchInfo.expect_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>A coroutine for handling <code class="docutils literal notranslate"><span class="pre">100-continue</span></code>.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.UrlMappingMatchInfo.handler"><a name="//apple_ref/cpp/Attribute/aiohttp.web.UrlMappingMatchInfo.handler"></a>
<code class="descname">handler</code><a class="headerlink" href="#aiohttp.web.UrlMappingMatchInfo.handler" title="Permalink to this definition">¶</a></dt>
<dd><p>A coroutine for handling request.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.UrlMappingMatchInfo.route"><a name="//apple_ref/cpp/Attribute/aiohttp.web.UrlMappingMatchInfo.route"></a>
<code class="descname">route</code><a class="headerlink" href="#aiohttp.web.UrlMappingMatchInfo.route" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Route</span></code> instance for url matching.</p>
</dd></dl>
</dd></dl>
</div>
<div class="section" id="view">
<h3>View<a class="headerlink" href="#view" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="aiohttp.web.View"><a name="//apple_ref/cpp/Class/aiohttp.web.View"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">View</code><span class="sig-paren">(</span><em>request</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.View" title="Permalink to this definition">¶</a></dt>
<dd><p>Inherited from <code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractView</span></code>.</p>
<p>Base class for class based views. Implementations should derive from
<a class="reference internal" href="#aiohttp.web.View" title="aiohttp.web.View"><code class="xref py py-class docutils literal notranslate"><span class="pre">View</span></code></a> and override methods for handling HTTP verbs like
<code class="docutils literal notranslate"><span class="pre">get()</span></code> or <code class="docutils literal notranslate"><span class="pre">post()</span></code>:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyView</span><span class="p">(</span><span class="n">View</span><span class="p">):</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="k">await</span> <span class="n">get_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">resp</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="k">await</span> <span class="n">post_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">resp</span>

<span class="n">app</span><span class="o">.</span><span class="n">router</span><span class="o">.</span><span class="n">add_view</span><span class="p">(</span><span class="s1">'/view'</span><span class="p">,</span> <span class="n">MyView</span><span class="p">)</span>
</pre></div>
</div>
<p>The view raises <em>405 Method Not allowed</em>
(<code class="xref py py-class docutils literal notranslate"><span class="pre">HTTPMethodNotAllowed</span></code>) if requested web verb is not
supported.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>request</strong> – instance of <a class="reference internal" href="#aiohttp.web.Request" title="aiohttp.web.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">Request</span></code></a> that has initiated a view
processing.</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="aiohttp.web.View.request"><a name="//apple_ref/cpp/Attribute/aiohttp.web.View.request"></a>
<code class="descname">request</code><a class="headerlink" href="#aiohttp.web.View.request" title="Permalink to this definition">¶</a></dt>
<dd><p>Request sent to view’s constructor, read-only property.</p>
</dd></dl>
<p>Overridable coroutine methods: <code class="docutils literal notranslate"><span class="pre">connect()</span></code>, <code class="docutils literal notranslate"><span class="pre">delete()</span></code>,
<code class="docutils literal notranslate"><span class="pre">get()</span></code>, <code class="docutils literal notranslate"><span class="pre">head()</span></code>, <code class="docutils literal notranslate"><span class="pre">options()</span></code>, <code class="docutils literal notranslate"><span class="pre">patch()</span></code>, <code class="docutils literal notranslate"><span class="pre">post()</span></code>,
<code class="docutils literal notranslate"><span class="pre">put()</span></code>, <code class="docutils literal notranslate"><span class="pre">trace()</span></code>.</p>
</dd></dl>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="web_quickstart.html#aiohttp-web-class-based-views"><span class="std std-ref">Class Based Views</span></a></p>
</div>
</div>
</div>
<div class="section" id="running-applications">
<span id="aiohttp-web-app-runners-reference"></span><h2>Running Applications<a class="headerlink" href="#running-applications" title="Permalink to this headline">¶</a></h2>
<p>To start web application there is <code class="docutils literal notranslate"><span class="pre">AppRunner</span></code> and site classes.</p>
<p>Runner is a storage for running application, sites are for running
application on specific TCP or Unix socket, e.g.:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">runner</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">AppRunner</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
<span class="k">await</span> <span class="n">runner</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>
<span class="n">site</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">TCPSite</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span> <span class="s1">'localhost'</span><span class="p">,</span> <span class="mi">8080</span><span class="p">)</span>
<span class="k">await</span> <span class="n">site</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="c1"># wait for finish signal</span>
<span class="k">await</span> <span class="n">runner</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.0: </span><a class="reference internal" href="#aiohttp.web.AppRunner" title="aiohttp.web.AppRunner"><code class="xref py py-class docutils literal notranslate"><span class="pre">AppRunner</span></code></a> and <a class="reference internal" href="#aiohttp.web.TCPSite" title="aiohttp.web.TCPSite"><code class="xref py py-class docutils literal notranslate"><span class="pre">TCPSite</span></code></a> / <a class="reference internal" href="#aiohttp.web.UnixSite" title="aiohttp.web.UnixSite"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnixSite</span></code></a> /
<a class="reference internal" href="#aiohttp.web.SockSite" title="aiohttp.web.SockSite"><code class="xref py py-class docutils literal notranslate"><span class="pre">SockSite</span></code></a> are added in aiohttp 3.0</p>
</div>
<dl class="class">
<dt id="aiohttp.web.AppRunner"><a name="//apple_ref/cpp/Class/aiohttp.web.AppRunner"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">AppRunner</code><span class="sig-paren">(</span><em>app</em>, <em>*</em>, <em>handle_signals=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.AppRunner" title="Permalink to this definition">¶</a></dt>
<dd><p>A runner for <a class="reference internal" href="#aiohttp.web.Application" title="aiohttp.web.Application"><code class="xref py py-class docutils literal notranslate"><span class="pre">Application</span></code></a>. Used with conjunction with sites
to serve on specific port.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>app</strong> (<a class="reference internal" href="#aiohttp.web.Application" title="aiohttp.web.Application"><em>Application</em></a>) – web application instance to serve.</li>
<li><strong>handle_signals</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – add signal handlers for
<code class="xref py py-data docutils literal notranslate"><span class="pre">signal.SIGINT</span></code> and
<code class="xref py py-data docutils literal notranslate"><span class="pre">signal.SIGTERM</span></code> (<code class="docutils literal notranslate"><span class="pre">False</span></code> by
default).</li>
<li><strong>kwargs</strong> – named parameters to pass into
<a class="reference internal" href="#aiohttp.web.Application.make_handler" title="aiohttp.web.Application.make_handler"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Application.make_handler()</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="aiohttp.web.AppRunner.app"><a name="//apple_ref/cpp/Attribute/aiohttp.web.AppRunner.app"></a>
<code class="descname">app</code><a class="headerlink" href="#aiohttp.web.AppRunner.app" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-only attribute for accessing to <a class="reference internal" href="#aiohttp.web.Application" title="aiohttp.web.Application"><code class="xref py py-class docutils literal notranslate"><span class="pre">Application</span></code></a> served
instance.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.AppRunner.server"><a name="//apple_ref/cpp/Attribute/aiohttp.web.AppRunner.server"></a>
<code class="descname">server</code><a class="headerlink" href="#aiohttp.web.AppRunner.server" title="Permalink to this definition">¶</a></dt>
<dd><p>Low-level web <a class="reference internal" href="#aiohttp.web.Server" title="aiohttp.web.Server"><code class="xref py py-class docutils literal notranslate"><span class="pre">Server</span></code></a> for handling HTTP requests,
read-only attribute.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.AppRunner.addresses"><a name="//apple_ref/cpp/Attribute/aiohttp.web.AppRunner.addresses"></a>
<code class="descname">addresses</code><a class="headerlink" href="#aiohttp.web.AppRunner.addresses" title="Permalink to this definition">¶</a></dt>
<dd><p>A  <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of served sockets addresses.</p>
<p>See <code class="xref py py-meth docutils literal notranslate"><span class="pre">socket.getsockname()</span></code> for items type.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.3.</span></p>
</div>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.AppRunner.sites"><a name="//apple_ref/cpp/Attribute/aiohttp.web.AppRunner.sites"></a>
<code class="descname">sites</code><a class="headerlink" href="#aiohttp.web.AppRunner.sites" title="Permalink to this definition">¶</a></dt>
<dd><p>A read-only <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code></a> of served sites (<a class="reference internal" href="#aiohttp.web.TCPSite" title="aiohttp.web.TCPSite"><code class="xref py py-class docutils literal notranslate"><span class="pre">TCPSite</span></code></a> /
<a class="reference internal" href="#aiohttp.web.UnixSite" title="aiohttp.web.UnixSite"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnixSite</span></code></a> / <a class="reference internal" href="#aiohttp.web.SockSite" title="aiohttp.web.SockSite"><code class="xref py py-class docutils literal notranslate"><span class="pre">SockSite</span></code></a> instances).</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.AppRunner.setup"><a name="//apple_ref/cpp/Method/aiohttp.web.AppRunner.setup"></a>
<em class="property">coroutine </em><code class="descname">setup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.AppRunner.setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize application. Should be called before adding sites.</p>
<p>The method calls <a class="reference internal" href="#aiohttp.web.Application.on_startup" title="aiohttp.web.Application.on_startup"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Application.on_startup</span></code></a> registered signals.</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.AppRunner.cleanup"><a name="//apple_ref/cpp/Method/aiohttp.web.AppRunner.cleanup"></a>
<em class="property">coroutine </em><code class="descname">cleanup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.AppRunner.cleanup" title="Permalink to this definition">¶</a></dt>
<dd><p>Stop handling all registered sites and cleanup used resources.</p>
<p><a class="reference internal" href="#aiohttp.web.Application.on_shutdown" title="aiohttp.web.Application.on_shutdown"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Application.on_shutdown</span></code></a> and
<a class="reference internal" href="#aiohttp.web.Application.on_cleanup" title="aiohttp.web.Application.on_cleanup"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Application.on_cleanup</span></code></a> signals are called internally.</p>
</dd></dl>
</dd></dl>
<dl class="class">
<dt id="aiohttp.web.BaseSite"><a name="//apple_ref/cpp/Class/aiohttp.web.BaseSite"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">BaseSite</code><a class="headerlink" href="#aiohttp.web.BaseSite" title="Permalink to this definition">¶</a></dt>
<dd><p>An abstract class for handled sites.</p>
<dl class="attribute">
<dt id="aiohttp.web.BaseSite.name"><a name="//apple_ref/cpp/Attribute/aiohttp.web.BaseSite.name"></a>
<code class="descname">name</code><a class="headerlink" href="#aiohttp.web.BaseSite.name" title="Permalink to this definition">¶</a></dt>
<dd><p>An identifier for site, read-only <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> property. Could
be an handled URL or UNIX socket path.</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.BaseSite.start"><a name="//apple_ref/cpp/Method/aiohttp.web.BaseSite.start"></a>
<em class="property">coroutine </em><code class="descname">start</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.BaseSite.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Start handling a site.</p>
</dd></dl>
<dl class="method">
<dt id="aiohttp.web.BaseSite.stop"><a name="//apple_ref/cpp/Method/aiohttp.web.BaseSite.stop"></a>
<em class="property">coroutine </em><code class="descname">stop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.BaseSite.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Stop handling a site.</p>
</dd></dl>
</dd></dl>
<dl class="class">
<dt id="aiohttp.web.TCPSite"><a name="//apple_ref/cpp/Class/aiohttp.web.TCPSite"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">TCPSite</code><span class="sig-paren">(</span><em>runner</em>, <em>host=None</em>, <em>port=None</em>, <em>*</em>, <em>shutdown_timeout=60.0</em>, <em>ssl_context=None</em>, <em>backlog=128</em>, <em>reuse_address=None</em>, <em>reuse_port=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.TCPSite" title="Permalink to this definition">¶</a></dt>
<dd><p>Serve a runner on TCP socket.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>runner</strong> – a runner to serve.</li>
<li><strong>host</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – HOST to listen on, <code class="docutils literal notranslate"><span class="pre">'0.0.0.0'</span></code> if <code class="docutils literal notranslate"><span class="pre">None</span></code> (default).</li>
<li><strong>port</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – PORT to listed on, <code class="docutils literal notranslate"><span class="pre">8080</span></code> if <code class="docutils literal notranslate"><span class="pre">None</span></code> (default).</li>
<li><strong>shutdown_timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – a timeout for closing opened
connections on <a class="reference internal" href="#aiohttp.web.BaseSite.stop" title="aiohttp.web.BaseSite.stop"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BaseSite.stop()</span></code></a>
call.</li>
<li><strong>ssl_context</strong> – a <a class="reference external" href="https://docs.python.org/3/library/ssl.html#ssl.SSLContext" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ssl.SSLContext</span></code></a> instance for serving
SSL/TLS secure server, <code class="docutils literal notranslate"><span class="pre">None</span></code> for plain HTTP
server (default).</li>
<li><strong>backlog</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – <p>a number of unaccepted connections that the
system will allow before refusing new
connections, see <code class="xref py py-meth docutils literal notranslate"><span class="pre">socket.listen()</span></code> for details.</p>
<p><code class="docutils literal notranslate"><span class="pre">128</span></code> by default.</p>
</li>
<li><strong>reuse_address</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – tells the kernel to reuse a local socket in
TIME_WAIT state, without waiting for its
natural timeout to expire. If not specified
will automatically be set to True on UNIX.</li>
<li><strong>reuse_port</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – tells the kernel to allow this endpoint to be
bound to the same port as other existing
endpoints are bound to, so long as they all set
this flag when being created. This option is not
supported on Windows.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>
<dl class="class">
<dt id="aiohttp.web.UnixSite"><a name="//apple_ref/cpp/Class/aiohttp.web.UnixSite"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">UnixSite</code><span class="sig-paren">(</span><em>runner</em>, <em>path</em>, <em>*</em>, <em>shutdown_timeout=60.0</em>, <em>ssl_context=None</em>, <em>backlog=128</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.UnixSite" title="Permalink to this definition">¶</a></dt>
<dd><p>Serve a runner on UNIX socket.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>runner</strong> – a runner to serve.</li>
<li><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – PATH to UNIX socket to listen.</li>
<li><strong>shutdown_timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – a timeout for closing opened
connections on <a class="reference internal" href="#aiohttp.web.BaseSite.stop" title="aiohttp.web.BaseSite.stop"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BaseSite.stop()</span></code></a>
call.</li>
<li><strong>ssl_context</strong> – a <a class="reference external" href="https://docs.python.org/3/library/ssl.html#ssl.SSLContext" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ssl.SSLContext</span></code></a> instance for serving
SSL/TLS secure server, <code class="docutils literal notranslate"><span class="pre">None</span></code> for plain HTTP
server (default).</li>
<li><strong>backlog</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – <p>a number of unaccepted connections that the
system will allow before refusing new
connections, see <code class="xref py py-meth docutils literal notranslate"><span class="pre">socket.listen()</span></code> for details.</p>
<p><code class="docutils literal notranslate"><span class="pre">128</span></code> by default.</p>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>
<dl class="class">
<dt id="aiohttp.web.SockSite"><a name="//apple_ref/cpp/Class/aiohttp.web.SockSite"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">SockSite</code><span class="sig-paren">(</span><em>runner</em>, <em>sock</em>, <em>*</em>, <em>shutdown_timeout=60.0</em>, <em>ssl_context=None</em>, <em>backlog=128</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.SockSite" title="Permalink to this definition">¶</a></dt>
<dd><p>Serve a runner on UNIX socket.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>runner</strong> – a runner to serve.</li>
<li><strong>sock</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">socket.socket</span></code> to listen.</li>
<li><strong>shutdown_timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – a timeout for closing opened
connections on <a class="reference internal" href="#aiohttp.web.BaseSite.stop" title="aiohttp.web.BaseSite.stop"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BaseSite.stop()</span></code></a>
call.</li>
<li><strong>ssl_context</strong> – a <a class="reference external" href="https://docs.python.org/3/library/ssl.html#ssl.SSLContext" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ssl.SSLContext</span></code></a> instance for serving
SSL/TLS secure server, <code class="docutils literal notranslate"><span class="pre">None</span></code> for plain HTTP
server (default).</li>
<li><strong>backlog</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – <p>a number of unaccepted connections that the
system will allow before refusing new
connections, see <code class="xref py py-meth docutils literal notranslate"><span class="pre">socket.listen()</span></code> for details.</p>
<p><code class="docutils literal notranslate"><span class="pre">128</span></code> by default.</p>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>
</div>
<div class="section" id="utilities">
<h2>Utilities<a class="headerlink" href="#utilities" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="aiohttp.web.FileField"><a name="//apple_ref/cpp/Class/aiohttp.web.FileField"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">FileField</code><a class="headerlink" href="#aiohttp.web.FileField" title="Permalink to this definition">¶</a></dt>
<dd><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">namedtuple</span></code> instance that is returned as
multidict value by <code class="xref py py-meth docutils literal notranslate"><span class="pre">Request.POST()</span></code> if field is uploaded file.</p>
<dl class="attribute">
<dt id="aiohttp.web.FileField.name"><a name="//apple_ref/cpp/Attribute/aiohttp.web.FileField.name"></a>
<code class="descname">name</code><a class="headerlink" href="#aiohttp.web.FileField.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Field name</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.FileField.filename"><a name="//apple_ref/cpp/Attribute/aiohttp.web.FileField.filename"></a>
<code class="descname">filename</code><a class="headerlink" href="#aiohttp.web.FileField.filename" title="Permalink to this definition">¶</a></dt>
<dd><p>File name as specified by uploading (client) side.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.FileField.file"><a name="//apple_ref/cpp/Attribute/aiohttp.web.FileField.file"></a>
<code class="descname">file</code><a class="headerlink" href="#aiohttp.web.FileField.file" title="Permalink to this definition">¶</a></dt>
<dd><p>An <a class="reference external" href="https://docs.python.org/3/library/io.html#io.IOBase" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">io.IOBase</span></code></a> instance with content of uploaded file.</p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.FileField.content_type"><a name="//apple_ref/cpp/Attribute/aiohttp.web.FileField.content_type"></a>
<code class="descname">content_type</code><a class="headerlink" href="#aiohttp.web.FileField.content_type" title="Permalink to this definition">¶</a></dt>
<dd><p><em>MIME type</em> of uploaded file, <code class="docutils literal notranslate"><span class="pre">'text/plain'</span></code> by default.</p>
</dd></dl>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="web_quickstart.html#aiohttp-web-file-upload"><span class="std std-ref">File Uploads</span></a></p>
</div>
</dd></dl>
<dl class="function">
<dt id="aiohttp.web.run_app"><a name="//apple_ref/cpp/Function/aiohttp.web.run_app"></a>
<code class="descclassname">aiohttp.web.</code><code class="descname">run_app</code><span class="sig-paren">(</span><em>app</em>, <em>*</em>, <em>host=None</em>, <em>port=None</em>, <em>path=None</em>, <em>sock=None</em>, <em>shutdown_timeout=60.0</em>, <em>ssl_context=None</em>, <em>print=print</em>, <em>backlog=128</em>, <em>access_log_class=aiohttp.helpers.AccessLogger</em>, <em>access_log_format=aiohttp.helpers.AccessLogger.LOG_FORMAT</em>, <em>access_log=aiohttp.log.access_logger</em>, <em>handle_signals=True</em>, <em>reuse_address=None</em>, <em>reuse_port=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.run_app" title="Permalink to this definition">¶</a></dt>
<dd><p>A utility function for running an application, serving it until
keyboard interrupt and performing a
<a class="reference internal" href="web_advanced.html#aiohttp-web-graceful-shutdown"><span class="std std-ref">Graceful shutdown</span></a>.</p>
<p>Suitable as handy tool for scaffolding aiohttp based projects.
Perhaps production config will use more sophisticated runner but it
good enough at least at very beginning stage.</p>
<p>The server will listen on any host or Unix domain socket path you supply.
If no hosts or paths are supplied, or only a port is supplied, a TCP server
listening on 0.0.0.0 (all hosts) will be launched.</p>
<p>Distributing HTTP traffic to multiple hosts or paths on the same
application process provides no performance benefit as the requests are
handled on the same event loop. See <a class="reference internal" href="deployment.html"><span class="doc">Server Deployment</span></a> for ways of
distributing work for increased performance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"/>
<col class="field-body"/>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>app</strong> – <a class="reference internal" href="#aiohttp.web.Application" title="aiohttp.web.Application"><code class="xref py py-class docutils literal notranslate"><span class="pre">Application</span></code></a> instance to run or a <em>coroutine</em>
that returns an application.</li>
<li><strong>host</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – TCP/IP host or a sequence of hosts for HTTP server.
Default is <code class="docutils literal notranslate"><span class="pre">'0.0.0.0'</span></code> if <em>port</em> has been specified
or if <em>path</em> is not supplied.</li>
<li><strong>port</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – TCP/IP port for HTTP server. Default is <code class="docutils literal notranslate"><span class="pre">8080</span></code> for plain
text HTTP and <code class="docutils literal notranslate"><span class="pre">8443</span></code> for HTTP via SSL (when
<em>ssl_context</em> parameter is specified).</li>
<li><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – file system path for HTTP server Unix domain socket.
A sequence of file system paths can be used to bind
multiple domain sockets. Listening on Unix domain
sockets is not supported by all operating systems.</li>
<li><strong>sock</strong> (<em>socket</em>) – a preexisting socket object to accept connections on.
A sequence of socket objects can be passed.</li>
<li><strong>shutdown_timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – <p>a delay to wait for graceful server
shutdown before disconnecting all
open client sockets hard way.</p>
<p>A system with properly
<a class="reference internal" href="web_advanced.html#aiohttp-web-graceful-shutdown"><span class="std std-ref">Graceful shutdown</span></a>
implemented never waits for this
timeout but closes a server in a few
milliseconds.</p>
</li>
<li><strong>ssl_context</strong> – <a class="reference external" href="https://docs.python.org/3/library/ssl.html#ssl.SSLContext" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ssl.SSLContext</span></code></a> for HTTPS server,
<code class="docutils literal notranslate"><span class="pre">None</span></code> for HTTP connection.</li>
<li><strong>print</strong> – a callable compatible with <a class="reference external" href="https://docs.python.org/3/library/functions.html#print" title="(in Python v3.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">print()</span></code></a>. May be used
to override STDOUT output or suppress it. Passing <cite>None</cite>
disables output.</li>
<li><strong>backlog</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – the number of unaccepted connections that the
system will allow before refusing new
connections (<code class="docutils literal notranslate"><span class="pre">128</span></code> by default).</li>
<li><strong>access_log_class</strong> – class for <cite>access_logger</cite>. Default:
<code class="xref py py-data docutils literal notranslate"><span class="pre">aiohttp.helpers.AccessLogger</span></code>.
Must to be a subclass of <code class="xref py py-class docutils literal notranslate"><span class="pre">aiohttp.abc.AbstractAccessLogger</span></code>.</li>
<li><strong>access_log</strong> – <a class="reference external" href="https://docs.python.org/3/library/logging.html#logging.Logger" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">logging.Logger</span></code></a> instance used for saving
access logs. Use <code class="docutils literal notranslate"><span class="pre">None</span></code> for disabling logs for
sake of speedup.</li>
<li><strong>access_log_format</strong> – access log format, see
<a class="reference internal" href="logging.html#aiohttp-logging-access-log-format-spec"><span class="std std-ref">Format specification</span></a>
for details.</li>
<li><strong>handle_signals</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – override signal TERM handling to gracefully
exit the application.</li>
<li><strong>reuse_address</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – tells the kernel to reuse a local socket in
TIME_WAIT state, without waiting for its
natural timeout to expire. If not specified
will automatically be set to True on UNIX.</li>
<li><strong>reuse_port</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – tells the kernel to allow this endpoint to be
bound to the same port as other existing
endpoints are bound to, so long as they all set
this flag when being created. This option is not
supported on Windows.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.0: </span>Support <em>access_log_class</em> parameter.</p>
<p>Support <em>reuse_address</em>, <em>reuse_port</em> parameter.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1: </span>Accept a coroutine as <em>app</em> parameter.</p>
</div>
</dd></dl>
</div>
<div class="section" id="constants">
<h2>Constants<a class="headerlink" href="#constants" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="aiohttp.web.ContentCoding"><a name="//apple_ref/cpp/Class/aiohttp.web.ContentCoding"></a>
<em class="property">class </em><code class="descclassname">aiohttp.web.</code><code class="descname">ContentCoding</code><a class="headerlink" href="#aiohttp.web.ContentCoding" title="Permalink to this definition">¶</a></dt>
<dd><p>An <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></a> class of available Content Codings.</p>
<dl class="attribute">
<dt id="aiohttp.web.ContentCoding.deflate"><a name="//apple_ref/cpp/Attribute/aiohttp.web.ContentCoding.deflate"></a>
<code class="descname">deflate</code><a class="headerlink" href="#aiohttp.web.ContentCoding.deflate" title="Permalink to this definition">¶</a></dt>
<dd><p><em>DEFLATE compression</em></p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.ContentCoding.gzip"><a name="//apple_ref/cpp/Attribute/aiohttp.web.ContentCoding.gzip"></a>
<code class="descname">gzip</code><a class="headerlink" href="#aiohttp.web.ContentCoding.gzip" title="Permalink to this definition">¶</a></dt>
<dd><p><em>GZIP compression</em></p>
</dd></dl>
<dl class="attribute">
<dt id="aiohttp.web.ContentCoding.identity"><a name="//apple_ref/cpp/Attribute/aiohttp.web.ContentCoding.identity"></a>
<code class="descname">identity</code><a class="headerlink" href="#aiohttp.web.ContentCoding.identity" title="Permalink to this definition">¶</a></dt>
<dd><p><em>no compression</em></p>
</dd></dl>
</dd></dl>
</div>
<div class="section" id="middlewares">
<h2>Middlewares<a class="headerlink" href="#middlewares" title="Permalink to this headline">¶</a></h2>
<div class="section" id="normalize-path-middleware">
<h3>Normalize path middleware<a class="headerlink" href="#normalize-path-middleware" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="aiohttp.web.normalize_path_middleware"><a name="//apple_ref/cpp/Function/aiohttp.web.normalize_path_middleware"></a>
<code class="descclassname">aiohttp.web.</code><code class="descname">normalize_path_middleware</code><span class="sig-paren">(</span><em>*</em>, <em>append_slash=True</em>, <em>remove_slash=False</em>, <em>merge_slashes=True</em>, <em>redirect_class=HTTPMovedPermanently</em><span class="sig-paren">)</span><a class="headerlink" href="#aiohttp.web.normalize_path_middleware" title="Permalink to this definition">¶</a></dt>
<dd><p>Middleware factory which produces a middleware that normalizes
the path of a request. By normalizing it means:</p>
<blockquote>
<div><ul class="simple">
<li>Add or remove a trailing slash to the path.</li>
<li>Double slashes are replaced by one.</li>
</ul>
</div></blockquote>
<p>The middleware returns as soon as it finds a path that resolves
correctly. The order if both merge and append/remove are enabled is:</p>
<blockquote>
<div><ol class="arabic simple">
<li><em>merge_slashes</em></li>
<li><em>append_slash</em> or <em>remove_slash</em></li>
<li>both <em>merge_slashes</em> and <em>append_slash</em> or <em>remove_slash</em></li>
</ol>
</div></blockquote>
<p>If the path resolves with at least one of those conditions, it will
redirect to the new path.</p>
<p>Only one of <em>append_slash</em> and <em>remove_slash</em> can be enabled. If both are
<code class="docutils literal notranslate"><span class="pre">True</span></code> the factory will raise an <code class="docutils literal notranslate"><span class="pre">AssertionError</span></code></p>
<p>If <em>append_slash</em> is <code class="docutils literal notranslate"><span class="pre">True</span></code> the middleware will append a slash when
needed. If a resource is defined with trailing slash and the request
comes without it, it will append it automatically.</p>
<p>If <em>remove_slash</em> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, <em>append_slash</em> must be <code class="docutils literal notranslate"><span class="pre">False</span></code>. When enabled
the middleware will remove trailing slashes and redirect if the resource is
defined.</p>
<p>If <em>merge_slashes</em> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, merge multiple consecutive slashes in the
path into one.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.4: </span>Support for <em>remove_slash</em></p>
</div>
</dd></dl>
</div>
</div>
</div>
</div>
</div>
<div class="clearer"></div>
</div>
<div class="footer">
      ©2013-2018, Aiohttp contributors.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.7</a>
      
      |
      <a href="_sources/web_reference.rst.txt" rel="nofollow">Page source</a>
</div>
</body>
</html>